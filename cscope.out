cscope 15 $HOME/Workspace/libmdadm -q 0000003143 0000210395
	@FilesystemManager.cpp

1 
	~"Fesy¡emMªag”.h
"

3 #ifdeà
NUUO


4 
	~"commÚ/fe.h
"

5 
	~"commÚ/nusy¦og.h
"

6 
	~"commÚ/¡ršg.h
"

7 
	~"commÚ/sy¡em.h
"

9 
	~"‹¡_uts.h
"

12 
	~<®gÜ™hm
>

13 
	~<sys/mouÁ.h
>

14 
	~<sys/¡©.h
>

15 
	~<”ºo.h
>

17 
	#LOG_LABEL
 "FSMªag”"

	)

19 
	gFesy¡emMªag”
::
	$Fesy¡emMªag”
(cÚ¡ 
¡ršg
& 
dev
)

20 : 
	`m_¡rMouÁPošt
("")

21 , 
	`m_¡rDevNode
(
dev
)

22 , 
	`m_¡rUUID
("")

23 , 
	`m_¡rFSTy³
("")

24 , 
	`m_iVŞumeNum
(-1)

25 , 
	`m_iFÜm©šgS‹
(
WRITE_INODE_TABLES_UNKNOWN
)

26 , 
	`m_iFÜm©Prog»ss
(0)

27 , 
	`m_bFÜm©
(
çl£
)

28 , 
	$m_bMouÁ
(
çl£
)

30 
	`In™Ÿlize
();

31 
	}
}

33 
	gFesy¡emMªag”
::
	$Fesy¡emMªag”
()

34 : 
	`m_¡rMouÁPošt
("")

35 , 
	`m_¡rDevNode
("")

36 , 
	`m_¡rUUID
("")

37 , 
	`m_¡rFSTy³
("")

38 , 
	`m_iVŞumeNum
(-1)

39 , 
	`m_iFÜm©šgS‹
(
WRITE_INODE_TABLES_UNKNOWN
)

40 , 
	`m_iFÜm©Prog»ss
(0)

41 , 
	`m_bFÜm©
(
çl£
)

42 , 
	$m_bMouÁ
(
çl£
)

44 
	}
}

46 
	gFesy¡emMªag”
::~
	$Fesy¡emMªag”
()

49 
	}
}

51 
boŞ
 
Fesy¡emMªag”
::
	$S‘DeviûNode
(cÚ¡ 
¡ršg
 &
dev
)

53 
m_¡rDevNode
 = 
dev
;

54  
	`In™Ÿlize
();

55 
	}
}

57 
boŞ
 
	gFesy¡emMªag”
::
	$In™Ÿlize
()

59 ià(
m_¡rDevNode
.
	`em±y
()) {

60 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

62  
çl£
;

65 #ifdeà
NUUO


66 ià(!
	`CheckBlockDeviû
(
m_¡rDevNode
.
	`c_¡r
())) {

67 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

69 
m_¡rDevNode
.
	`c_¡r
());

70  
çl£
;

74 ià(
	`blkid
() != 0) {

75 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

77 
m_¡rDevNode
.
	`c_¡r
());

78  
çl£
;

81  
Œue
;

82 
	}
}

84 
	gFesy¡emMªag”
::
	$S‘MouÁPošt
(cÚ¡ 
¡ršg
 &
mouÁpošt
)

86 
m_¡rMouÁPošt
 = 
mouÁpošt
;

87 
	}
}

89 #ifdeà
NUUO


90 
	gFesy¡emMªag”
::
	$Th»adProc
()

92 ià(!
	`FÜm©
()) {

96 
	`SË•MS
(100);

98 ià(!
	`MouÁ
(
m_¡rMouÁPošt
)) {

102 
	`G’”©eUUIDFe
();

103 
	`C»©eDeçuÉFŞd”s
();

104 
	`Dump
();

105 
	}
}

108 
boŞ
 
	gFesy¡emMªag”
::
	$FÜm©
(
boŞ
 
fÜû
)

110 
»t
 = 0;

111 #ifdeà
NUUO


112 
Cr™iÿlSeùiÚLock
 
	`cs
(&
m_csFÜm©
);

114 ià(
m_bFÜm©
 && !
fÜû
)

115 
fÜm©_dÚe
;

117 
	`In™ŸlizeMke2fsHªdË
();

118 
»t
 = 
	`mke2fs
(&
m_mkfsHªdË
);

119 ià(0 !ğ
»t
) {

120 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

121 "FaØfÜm© % [%d]\n", 
m_¡rDevNode
.
	`c_¡r
(), 
»t
);

122  
çl£
;

125 
fÜm©_dÚe
:

126 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_INFO
, 
LOG_LABEL
,

127 "FÜm© % sucûssfuÎy.\n", 
m_¡rDevNode
.
	`c_¡r
());

128  
Œue
;

129 
	}
}

131 
boŞ
 
	gFesy¡emMªag”
::
	$MouÁ
(cÚ¡ 
¡ršg
& 
¡rMouÁPošt
)

133 
¡ršg
 
¡rE¼ÜLog
;

135 ià(
¡rMouÁPošt
.
	`em±y
()) {

136 
¡rE¼ÜLog
 = "Invalid mount…oint.";

137 
mouÁ_check_”r
;

140 ià(
m_¡rDevNode
.
	`em±y
()) {

141 
¡rE¼ÜLog
 = "Invalid device.";

142 
mouÁ_check_”r
;

145 #ifdeà
NUUO


146 
m_csFÜm©
.
	`Lock
();

148 ià(!
m_bFÜm©
) {

149 
¡rE¼ÜLog
 = "The device isn't formated.";

150 #ifdeà
NUUO


151 
m_csFÜm©
.
	`UÆock
();

153 
mouÁ_check_”r
;

155 #ifdeà
NUUO


156 
m_csFÜm©
.
	`UÆock
();

159 #ifdeà
NUUO


160 ià(!
	`CheckBlockDeviû
(
m_¡rDevNode
.
	`c_¡r
())) {

161 
¡rE¼ÜLog
 = "The device is‚ot‡ block device.";

162 
mouÁ_check_”r
;

165 
m_csMouÁ
.
	`Lock
();

168 ià(
m_bMouÁ


169 && !
m_¡rMouÁPošt
.
	`em±y
()

170 && 
m_¡rMouÁPošt
 =ğ
¡rMouÁPošt


171 #ifdeà
NUUO


172 && 
	`CheckDœeùÜyExi¡
(
m_¡rMouÁPošt
)

173 && 
	`ROOTFS_PROTECT
(
m_¡rMouÁPošt
.
	`c_¡r
())

176 
mouÁ_ok
;

179 ià(
m_bMouÁ
 &&

180 !
m_¡rMouÁPošt
.
	`em±y
() &&

181 
m_¡rMouÁPošt
 !ğ
¡rMouÁPošt
) {

184 
¡rE¼ÜLog
 = "The device has‡lready be mounted. Why„equesto mount‡gain with‡ different mount…oint?";

185 
mouÁ_”r
;

188 #ifdeà
NUUO


189 ià(!
	`CheckDœeùÜyExi¡
(
¡rMouÁPošt
)) {

190 ià(!
	`MakeDœeùÜy
(
¡rMouÁPošt
)) {

191 
¡rE¼ÜLog
 = "Failo create mount…oint.";

192 
mouÁ_”r
;

196 ià(
	`IsMouÁPošt
(
¡rMouÁPošt
)) {

199 
¡rE¼ÜLog
 = "The mount…oint is using by‡nother device..";

200 
mouÁ_”r
;

203 ià(
	`mouÁ
(
m_¡rDevNode
.
	`c_¡r
(), 
¡rMouÁPošt
.c_str(),

204 
m_¡rFSTy³
.
	`c_¡r
(), 0, "") < 0) {

205 
¡rE¼ÜLog
 = 
	`¡ršg_fÜm©
("Failo mount %so %s. (%s)",

206 
m_¡rDevNode
.
	`c_¡r
(),

207 
m_¡rMouÁPošt
.
	`c_¡r
(),

208 
	`¡»¼Ü
(
”ºo
));

209 
mouÁ_”r
;

212 
mouÁ_ok
:

213 
m_bMouÁ
 = 
Œue
;

214 
m_¡rMouÁPošt
 = 
¡rMouÁPošt
;

215 
m_csMouÁ
.
	`UÆock
();

216 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_INFO
, 
LOG_LABEL
,

218 
m_¡rDevNode
.
	`c_¡r
(),

219 
m_¡rMouÁPošt
.
	`c_¡r
());

221  
Œue
;

223 
mouÁ_”r
:

224 
m_csMouÁ
.
	`UÆock
();

225 
mouÁ_check_”r
:

226 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

227 "%s", 
¡rE¼ÜLog
.
	`c_¡r
());

228  
çl£
;

229 
	}
}

231 
boŞ
 
	gFesy¡emMªag”
::
	$UnmouÁ
()

233 #ifdeà
NUUO


234 
Cr™iÿlSeùiÚLock
 
	`cs
(&
m_csMouÁ
);

237 ià(!
m_bMouÁ
)

238 
unmouÁ_dÚe
;

240 ià(
m_¡rMouÁPošt
.
	`em±y
())

241 
unmouÁ_dÚe
;

243 #ifdeà
NUUO


244 ià(!
	`CheckDœeùÜyExi¡
(
m_¡rMouÁPošt
))

245 
unmouÁ_dÚe
;

248 ià(!
	`IsMouÁPošt
(
m_¡rMouÁPošt
))

249 
unmouÁ_dÚe
;

251 ià(
	`umouÁ2
(
m_¡rMouÁPošt
.
	`c_¡r
(), 
UMOUNT_NOFOLLOW
 | 
MNT_DETACH
) < 0) {

252 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
, "Failo unmount %s (%s)\n",

253 
m_¡rMouÁPošt
.
	`c_¡r
(), 
	`¡»¼Ü
(
”ºo
));

254  
çl£
;

261 
unmouÁ_dÚe
:

262 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_INFO
, 
LOG_LABEL
,

264 
m_¡rMouÁPošt
.
	`c_¡r
());

265 
m_bMouÁ
 = 
çl£
;

266 
m_¡rMouÁPošt
 = "";

268  
Œue
;

269 
	}
}

271 
boŞ
 
	gFesy¡emMªag”
::
	$IsFÜm©ed
()

273  
m_bFÜm©
;

274 
	}
}

276 
boŞ
 
	gFesy¡emMªag”
::
	$IsFÜm©šg
(& 
´og»ss
, & 
¡©
)

278 
´og»ss
 = 
m_iFÜm©Prog»ss
;

279 
¡©
 = 
m_iFÜm©šgS‹
;

280 ià(
m_iFÜm©šgS‹
 =ğ
WRITE_INODE_TABLES_WRITING
 ||

281 
m_iFÜm©šgS‹
 =ğ
WRITE_INODE_TABLES_WRITING_DONE
 ||

282 
m_iFÜm©šgS‹
 =ğ
WRITE_INODE_TABLES_INIT
)

283  
Œue
;

285  
çl£
;

286 
	}
}

288 
boŞ
 
	gFesy¡emMªag”
::
	$IsMouÁed
(
¡ršg
& 
¡rMouÁPošt
)

290 #ifdeà
NUUO


291 
Cr™iÿlSeùiÚLock
 
	`cs
(&
m_csMouÁ
);

293 
¡rMouÁPošt
 = 
m_¡rMouÁPošt
;

294  
m_bMouÁ
;

295 
	}
}

297 
boŞ
 
	gFesy¡emMªag”
::
	$IsMouÁed
(& 
num
)

299 #ifdeà
NUUO


300 
Cr™iÿlSeùiÚLock
 
	`cs
(&
m_csMouÁ
);

302 
num
 = 
m_iVŞumeNum
;

303  
m_bMouÁ
;

304 
	}
}

306 
	gFesy¡emMªag”
::
	$S‘FÜm©Info
(
boŞ
 
fÜm©
, 
´og»ss
, 
¡©
)

308 
m_bFÜm©
 = 
fÜm©
;

309 
m_iFÜm©Prog»ss
 = 
´og»ss
;

310 
m_iFÜm©šgS‹
 = 
¡©
;

311 
	}
}

313 
	gFesy¡emMªag”
::
	$MakeFesy¡emProg»ss
(*
pD©a
, 
¡©
,

314 
cu¼’t
, 
tÙ®
)

316 ià(
pD©a
 =ğ
NULL
)

318 
Fesy¡emMªag”
 *
pFSMgr
 = (Fesy¡emMªag”*è
pD©a
;

320 
¡©
) {

321 
WRITE_INODE_TABLES_INIT
:

322 
pFSMgr
->
	`S‘FÜm©Info
(
çl£
, 0, 
¡©
);

324 
WRITE_INODE_TABLES_WRITING
:

325 
WRITE_INODE_TABLES_WRITING_DONE
:

326 
pFSMgr
->
	`S‘FÜm©Info
(
çl£
, ()(()
cu¼’t
 / ()
tÙ®
 * 100), 
¡©
);

328 
WRITE_INODE_TABLES_DONE
:

329 
pFSMgr
->
	`S‘FÜm©Info
(
Œue
, 100, 
¡©
);

331 
WRITE_INODE_TABLES_ERROR
:

332 
pFSMgr
->
	`S‘FÜm©Info
(
çl£
, 0, 
¡©
);

335 
	}
}

337 
	gFesy¡emMªag”
::
	$G’”©eUUIDFe
()

339 #ifdeà
NUUO


340 
Cr™iÿlSeùiÚLock
 
	`cs_mouÁ
(&
m_csMouÁ
);

343 ià(!
m_bMouÁ
 || 
m_¡rMouÁPošt
.
	`em±y
()

344 #ifdeà
NUUO


345 || !
	`CheckDœeùÜyExi¡
(
m_¡rMouÁPošt
) ||

346 !
	`ROOTFS_PROTECT
(
m_¡rMouÁPošt
.
	`c_¡r
())

351 
¡ršg
 
¡rUUIDFeName
 = 
m_¡rMouÁPošt
 + "/uuid";

352 #ifdeà
NUUO


353 ià(
	`CheckFeExi¡
(
¡rUUIDFeName
) &&

354 
	`G‘FeStÜageSize
(
¡rUUIDFeName
) == 32)

358 #ifdeà
NUUO


359 
Cr™iÿlSeùiÚLock
 
	`cs_fÜm©
(&
m_csFÜm©
);

361 ià(
m_¡rUUID
.
	`em±y
())

364 
FILE
 *
pf
 = 
	`fİ’
(
¡rUUIDFeName
.
	`c_¡r
(), "w+");

365 ià(
pf
) {

366 
	`årštf
(
pf
, "%s", 
m_¡rUUID
.
	`c_¡r
());

367 
	`fşo£
(
pf
);

369 
	}
}

371 
boŞ
 
	gFesy¡emMªag”
::
	$C»©eDeçuÉFŞd”s
()

373 #ifdeà
NUUO


374 
Cr™iÿlSeùiÚLock
 
	`cs
(&
m_csMouÁ
);

377 ià(!
m_bMouÁ
 || 
m_¡rMouÁPošt
.
	`em±y
()

378 #ifdeà
NUUO


379 || !
	`CheckDœeùÜyExi¡
(
m_¡rMouÁPošt
) ||

380 !
	`ROOTFS_PROTECT
(
m_¡rMouÁPošt
.
	`c_¡r
())

383  
çl£
;

385 
¡ršg
 
¡rFŞd”Name
 = 
m_¡rMouÁPošt
 + "/VIDEODATA";

386 #ifdeà
NUUO


387 ià(!
	`CheckDœeùÜyExi¡
(
¡rFŞd”Name
)) {

388 ià(!
	`MakeDœeùÜy
(
¡rFŞd”Name
))

389  
çl£
;

393 
¡rFŞd”Name
 = 
m_¡rMouÁPošt
 + "/LOG";

394 #ifdeà
NUUO


395 ià(!
	`CheckDœeùÜyExi¡
(
¡rFŞd”Name
)) {

396 ià(!
	`MakeDœeùÜy
(
¡rFŞd”Name
))

397  
çl£
;

401  
Œue
;

402 
	}
}

404 
	gFesy¡emMªag”
::
	$blkid
()

406 
blkid_ÿche
 
ÿche
 = 
NULL
;

407 
»tv®
 = 0;

409 ià(
»tv®
 = 
	`blkid_g‘_ÿche
(&
ÿche
, 
NULL
) < 0) {

410 
	`Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_ERR
, 
LOG_LABEL
,

411 "[%d] FaØg‘ blkid cache.", 
__LINE__
);

412  
MKE2FS_FAIL_TO_GET_BLKID_CACHE
;

415 #ifdeà
NUUO


416 
m_csFÜm©
.
	`Lock
();

418 
blkid_dev
 
dev
 = 
	`blkid_g‘_dev
(
ÿche
, 
m_¡rDevNode
.
	`c_¡r
(), 
BLKID_DEV_NORMAL
);

419 cÚ¡ *
devÇme
 = 
	`blkid_dev_devÇme
(
dev
);

420 #ifdeà
NUUO


421 ià(!
	`CheckBlockDeviû
(
m_¡rDevNode
)) {

422 
	`Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_ERR
, 
LOG_LABEL
,

423 "[%d] % i nÙ‡ block deviû.", 
__LINE__
, 
m_¡rDevNode
.
	`c_¡r
());

424 
m_csFÜm©
.
	`UÆock
();

425  
MKE2FS_NOT_BLOCK_DEV
;

429 
blkid_g_™”©e
 
™”
;

430 cÚ¡ * 
ty³
 = 
NULL
;

431 cÚ¡ * 
v®ue
 = 
NULL
;

432 
™”
 = 
	`blkid_g_™”©e_begš
(
dev
);

433 
	`blkid_g_Ãxt
(
™”
, &
ty³
, &
v®ue
) == 0) {

434 ià(!
	`¡rcmp
(
ty³
, "UUID")) {

435 
m_¡rUUID
 = 
v®ue
;

436 
m_¡rUUID
.
	`”a£
(
¡d
::
	`»move
(m_¡rUUID.
	`begš
(), m_¡rUUID.
	`’d
(), '-'), m_strUUID.end());

438 ià(!
	`¡rcmp
(
ty³
, "TYPE")) {

439 
m_¡rFSTy³
 = 
v®ue
;

440 ià(
m_¡rFSTy³
 == "ext4" ||

441 
m_¡rFSTy³
 == "ext3")

442 
m_bFÜm©
 = 
Œue
;

443 } ià(!
	`¡rcmp
(
ty³
, "LABEL"))

446 
	`blkid_g_™”©e_’d
(
™”
);

447 #ifdeà
NUUO


448 
m_csFÜm©
.
	`UÆock
();

451 
mt
[256];

452 
mouÁ_æags
 = 0;

453 
mt
[0] = '\0';

454 
»tv®
 = 
	`ext2fs_check_mouÁ_pošt
(
m_¡rDevNode
.
	`c_¡r
(), &
mouÁ_æags
,

455 
mt
, (mtpt));

456 ià(
»tv®
 == 0) {

457 #ifdeà
NUUO


458 
Cr™iÿlSeùiÚLock
 
	`cs
(&
m_csMouÁ
);

460 
»t
 = 0;

461 
m_¡rMouÁPošt
 = 
mt
;

462 ià(
mouÁ_æags
 & 
EXT2_MF_MOUNTED
) {

463 
m_bMouÁ
 = 
Œue
;

464 } ià(
mouÁ_æags
 & 
EXT2_MF_BUSY
) {

465 
m_bMouÁ
 = 
Œue
;

467 
m_bMouÁ
 = 
çl£
;

470 #ifdeà
NUUO


475 ià(
m_bMouÁ
) {

476 
»t
 = 
	`ssÿnf
(
mt
, "/mÁ/VOLUME%d", &
m_iVŞumeNum
);

477 ià(
»t
 < 0 ||„‘ =ğ
EOF
 || 
m_iVŞumeNum
 > 128 ||

478 
m_iVŞumeNum
 < 1) {

479 
m_iVŞumeNum
 = -1;

480 ià(
	`umouÁ2
(
m_¡rMouÁPošt
.
	`c_¡r
(),

481 
UMOUNT_NOFOLLOW
 | 
MNT_DETACH
) < 0) {

482 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
, "Failo unmount %s (%s)\n",

483 
m_¡rMouÁPošt
.
	`c_¡r
(),

484 
	`¡»¼Ü
(
”ºo
));

486 
m_bMouÁ
 = 
çl£
;

487 
m_¡rMouÁPošt
 = "";

494 
m_iVŞumeNum
--;

499 
	`Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_ERR
, 
LOG_LABEL
,

500 "[%d] FaØcheck mouÁ…ošt.", 
__LINE__
);

501  
MKE2FS_CHECK_MOUNT_POINT_FAIL
;

505 
	}
}

507 
	gFesy¡emMªag”
::
	$Dump
()

509 
	`årštf
(
¡dout
, "\tMount Point: %s(%s), Filesystem: %s(%s)\n"

511 
m_¡rMouÁPošt
.
	`c_¡r
(), 
m_bMouÁ
?"Mounted":"Not mounted",

512 
m_¡rFSTy³
.
	`c_¡r
(), 
m_bFÜm©
?"Formated":"Not Formated",

513 
m_¡rUUID
.
	`c_¡r
());

514 
	}
}

516 
boŞ
 
	gFesy¡emMªag”
::
	$do¡©
(cÚ¡ 
¡ršg
& 
·th
, 
¡©
 *
¡
,

517 
do_l¡©
, 
qu›t
)

519 
n
 = 0;

521 ià(
do_l¡©
)

522 
n
 = 
	`l¡©
(
·th
.
	`c_¡r
(), 
¡
);

524 
n
 = 
	`¡©
(
·th
.
	`c_¡r
(), 
¡
);

526 ià(
n
 != 0) {

527 ià(!
qu›t
)

528 
	`årštf
(
¡d”r
, "mountpoint: %s: %s\n",

529 
·th
.
	`c_¡r
(), 
	`¡»¼Ü
(
”ºo
));

530  
çl£
;

533  
Œue
;

534 
	}
}

536 
boŞ
 
	gFesy¡emMªag”
::
	$IsMouÁPošt
(cÚ¡ 
¡ršg
& 
·th
)

538 
¡©
 
¡
, 
¡2
;

539 ià(!
	`do¡©
(
·th
, &
¡
, 1, 0))

540  
çl£
;

542 ià(!
	`do¡©
(
·th
 + "/..", &
¡2
, 1, 0))

543  
çl£
;

545 ià((
¡
.
¡_dev
 !ğ
¡2
.st_dev) ||

546 (
¡
.
¡_dev
 =ğ
¡2
.¡_dev && st.
¡_šo
 == st2.st_ino)) {

547  
Œue
;

550  
çl£
;

551 
	}
}

553 
	gFesy¡emMªag”
::
	$In™ŸlizeMke2fsHªdË
()

555 
	`mem£t
(&
m_mkfsHªdË
.
cfg
, 0x00, (
e2fs_cfg
));

556 
	`¡ºıy
(
m_mkfsHªdË
.
deviû_Çme
, 
m_¡rDevNode
.
	`c_¡r
(),

557 (
m_mkfsHªdË
.
deviû_Çme
));

558 
m_mkfsHªdË
.
cb_func
 = 
MakeFesy¡emProg»ss
;

559 
m_mkfsHªdË
.
buf
 = 
NULL
;

560 
m_mkfsHªdË
.
pD©a
 = 
this
;

562 
m_mkfsHªdË
.
cfg
.
blocksize
 = 4096;

563 
m_mkfsHªdË
.
cfg
.
»£rved_¿tio
 = 1;

564 
m_mkfsHªdË
.
cfg
.
r_İt
 = -1;

565 
m_mkfsHªdË
.
cfg
.
fÜû
 = 1;

566 
m_mkfsHªdË
.
cfg
.
qu›t
 = 1;

567 #ifdeà
DEBUG


568 
m_mkfsHªdË
.
cfg
.
v”bo£
 = 1;

570 
m_mkfsHªdË
.
cfg
.
v”bo£
 = 0;

572 
m_mkfsHªdË
.
cfg
.
ü—tÜ_os
 = 
EXT2_OS_LINUX
;

573 
	`¡ºıy
(
m_mkfsHªdË
.
cfg
.
fs_ty³
, "ext4", 
	`¡¾’
("ext4"));

574 
	}
}

576 
	gFesy¡emMªag”
::
	$S‘VŞumeNum
(cÚ¡ &
num
)

578 
m_iVŞumeNum
 = 
num
;

579 
m_¡rMouÁPošt
 = 
	`¡ršg_fÜm©
("/mÁ/VOLUME%d", 
m_iVŞumeNum
 + 1);

580 
	}
}

	@FilesystemManager.h

1 #iâdeà
__FILESYSTEM_MANAGER_H__


2 
	#__FILESYSTEM_MANAGER_H__


	)

4 #ifdeà
__ılu¥lus


8 
	~"libmke2fs/mke2fs.h
"

11 
	~"blkid/blkid.h
"

12 #ifdeà
__ılu¥lus


16 
	~<¡ršg
>

18 
usšg
 
Çme¥aû
 
¡d
;

20 #ifdeà
NUUO


21 
	~"­r/­r_th»ad_wÜk”.h
"

22 
	~"commÚ/ü™iÿl_£ùiÚ.h
"

23 
usšg
 
Çme¥aû
 
	gSYSUTILS_SPACE
;

25 
şass
 
	gFesy¡emMªag”
: 
public
 
A´Th»adWÜk”


27 
şass
 
Fesy¡emMªag”


30 
´iv©e
:

31 #ifdeà
NUUO


32 
Cr™iÿlSeùiÚ
 
m_csFÜm©
;

33 
Cr™iÿlSeùiÚ
 
	gm_csMouÁ
;

35 
mke2fs_hªdË
 
	gm_mkfsHªdË
;

38 
¡ršg
 
	gm_¡rMouÁPošt
;

39 
¡ršg
 
	gm_¡rDevNode
;

40 
¡ršg
 
	gm_¡rUUID
;

41 
¡ršg
 
	gm_¡rFSTy³
;

42 
	gm_iVŞumeNum
;

43 
	gm_iFÜm©šgS‹
;

44 
	gm_iFÜm©Prog»ss
;

45 
boŞ
 
	gm_bFÜm©
;

46 
boŞ
 
	gm_bMouÁ
;

48 
	g´Ùeùed
:

49 #ifdeà
NUUO


50 
Th»adProc
();

53 
	g´iv©e
:

54 
In™ŸlizeMke2fsHªdË
();

55 
boŞ
 
In™Ÿlize
();

56 
blkid
();

58 
	gpublic
:

59 
Fesy¡emMªag”
();

60 
Fesy¡emMªag”
(cÚ¡ 
¡ršg
& 
dev
);

61 
	gvœtu®
 ~
Fesy¡emMªag”
();

63 
MakeFesy¡emProg»ss
(*
pD©a
, 
¡©
,

64 
cu¼’t
, 
tÙ®
);

67 
boŞ
 
FÜm©
(boŞ 
fÜû
 = 
Œue
);

72 
boŞ
 
S‘DeviûNode
(cÚ¡ 
¡ršg
 &
dev
);

73 
S‘MouÁPošt
(cÚ¡ 
¡ršg
 &
mouÁpošt
);

74 
S‘VŞumeNum
(cÚ¡ &
num
);

75 
boŞ
 
MouÁ
(cÚ¡ 
¡ršg
& 
¡rMouÁPošt
);

76 
boŞ
 
UnmouÁ
();

78 
boŞ
 
IsFÜm©ed
();

79 
boŞ
 
IsFÜm©šg
(& 
´og»ss
, & 
¡©
);

80 
boŞ
 
IsMouÁed
(
¡ršg
& 
¡rMouÁPošt
);

81 
boŞ
 
IsMouÁed
(& 
num
);

82 
S‘FÜm©Info
(
boŞ
 
fÜm©
, 
´og»ss
,

83 
¡©
);

85 
G’”©eUUIDFe
();

86 
boŞ
 
C»©eDeçuÉFŞd”s
();

88 
Dump
();

90 
boŞ
 
do¡©
(cÚ¡ 
¡ršg
& 
·th
, 
¡©
 *
¡
,

91 
do_l¡©
, 
qu›t
);

92 
boŞ
 
IsMouÁPošt
(cÚ¡ 
¡ršg
& 
·th
);

	@RAIDManager.cpp

1 
	~"RAIDMªag”.h
"

3 #ifdeà
NUUO


4 
	~"commÚ/fe.h
"

5 
	~"commÚ/¡ršg.h
"

6 
	~"commÚ/dœeùÜy_Œav”£.h
"

9 
	#LOG_LABEL
 "RAIDMªag”"

	)

11 
	gRAIDMªag”
::
	$RAIDMªag”
()

13 
i
 = 0; i < 128; i++)

14 
m_bU£dMD
[
i
] = 
çl£
;

15 
i
 = 0; i < 128; i++)

16 
m_bU£dVŞume
[
i
] = 
çl£
;

18 #ifdeà
NUUO


19 
DœeùÜyT¿v”£
 
	`dt
("/dev");

24 
dt
.
	`Next
()) {

25 ià(
dt
.
	`G‘P©hName
().
	`fšd
("/dev/md"è!ğ
¡ršg
::
Åos
) {

26 ià(
	`CheckBlockDeviû
(
dt
.
	`G‘P©hName
())) {

27 
num
 = 0;

28 
»t
 = 
	`ssÿnf
(
dt
.
	`G‘P©hName
().
	`c_¡r
(), "/dev/md%d", &
num
);

29 ià(
»t
 < 1 ||„‘ =ğ
EOF
 || 
num
 > 127 ||‚um < 0)

36 ià(
	`Upd©eRAIDInfo
(
dt
.
	`G‘P©hName
(), 
num
)) {

37 
m_bU£dMD
[
num
] = 
Œue
;

40 
vŞumeNum
;

41 ià(
	`IsFÜm©ed
(
dt
.
	`G‘P©hName
())) {

42 ià(
	`IsMouÁed
(
dt
.
	`G‘P©hName
(), 
vŞumeNum
)) {

43 
m_bU£dVŞume
[
vŞumeNum
] = 
Œue
;

45 
	`MouÁ
(
dt
.
	`G‘P©hName
());

51 
dt
.
	`Re£t
();

63 
dt
.
	`Next
()) {

64 ià(
dt
.
	`G‘FÏgs
(è& 
DœeùÜyT¿v”£
::
FLAG_SYMBOLIC
) {

65 ià(
dt
.
	`G‘P©hName
().
	`fšd
("/dev/nuuo_sata") !=

66 
¡ršg
::
Åos
) {

67 ià(
dt
.
	`G‘P©hName
() != "/dev/nuuo_satadom") {

68 
	`AddDiskSymLšk
(
dt
.
	`G‘P©hName
(), 
DISK_TYPE_SATA
);

69 
	`AddDisk
(
dt
.
	`G‘P©hName
());

71 } ià(
dt
.
	`G‘P©hName
().
	`fšd
("/dev/nuuo_e§"è!ğ
¡ršg
::
Åos
) {

72 
	`AddDiskSymLšk
(
dt
.
	`G‘P©hName
(), 
DISK_TYPE_ESATA
);

73 
	`AddDisk
(
dt
.
	`G‘P©hName
());

74 } ià(
dt
.
	`G‘P©hName
().
	`fšd
("/dev/nuuo_iscsi"è!ğ
¡ršg
::
Åos
) {

75 
	`AddDiskSymLšk
(
dt
.
	`G‘P©hName
(), 
DISK_TYPE_ISCSI
);

76 
	`AddDisk
(
dt
.
	`G‘P©hName
());

80 
dt
.
	`Clo£
();

82 
	}
}

84 
	gRAIDMªag”
::~
	$RAIDMªag”
()

87 
	}
}

89 
RAIDMªag”
::
	$G‘F»eMDNum
()

91 #ifdeà
NUUO


92 
Cr™iÿlSeùiÚLock
 
	`cs_md
(&
m_csU£dMD
);

94 
i
 = 0 ; i < 128; i++) {

95 ià(!
m_bU£dMD
[
i
]) {

96 
m_bU£dMD
[
i
] = 
Œue
;

97  
i
;

102 
	}
}

104 
	gRAIDMªag”
::
	$F»eMDNum
(
n
)

106 ià(
n
 < 0 ||‚ > 127)

109 #ifdeà
NUUO


110 
Cr™iÿlSeùiÚLock
 
	`cs_md
(&
m_csU£dMD
);

112 
m_bU£dMD
[
n
] = 
çl£
;

113 
	}
}

115 
	gRAIDMªag”
::
	$S‘MDNum
(
n
)

117 ià(
n
 < 0 ||‚ > 127)

120 #ifdeà
NUUO


121 
Cr™iÿlSeùiÚLock
 
	`cs_md
(&
m_csU£dMD
);

123 
m_bU£dMD
[
n
] = 
Œue
;

124 
	}
}

126 
	gRAIDMªag”
::
	$G‘F»eVŞumeNum
()

128 #ifdeà
NUUO


129 
Cr™iÿlSeùiÚLock
 
	`cs_md
(&
m_csU£dVŞume
);

131 
i
 = 0 ; i < 128; i++) {

132 ià(!
m_bU£dVŞume
[
i
]) {

133 
m_bU£dVŞume
[
i
] = 
Œue
;

134  
i
;

139 
	}
}

141 
	gRAIDMªag”
::
	$F»eVŞumeNum
(
n
)

143 ià(
n
 < 0 ||‚ > 127)

146 #ifdeà
NUUO


147 
Cr™iÿlSeùiÚLock
 
	`cs_md
(&
m_csU£dVŞume
);

149 
m_bU£dVŞume
[
n
] = 
çl£
;

150 
	}
}

152 
	gRAIDMªag”
::
	$S‘VŞumeNum
(
n
)

154 ià(
n
 < 0 ||‚ > 127)

157 #ifdeà
NUUO


158 
Cr™iÿlSeùiÚLock
 
	`cs_md
(&
m_csU£dVŞume
);

160 
m_bU£dVŞume
[
n
] = 
Œue
;

161 
	}
}

163 
	gveùÜ
<
	gRAIDInfo
>::
™”©Ü
 
RAIDMªag”
::
	$IsMDDevInRAIDInfoLi¡
(cÚ¡ 
¡ršg
 &
mddev
, 
RAIDInfo
& 
šfo
)

165 #ifdeà
NUUO


166 
Cr™iÿlSeùiÚLock
 
	`cs
(&
m_csRAIDInfoLi¡
);

168 
veùÜ
<
RAIDInfo
>::
™”©Ü
 
™
 = 
m_vRAIDInfoLi¡
.
	`begš
();

169 
™
 !ğ
m_vRAIDInfoLi¡
.
	`’d
()) {

170 ià(*
™
 =ğ
mddev
) {

171 
šfo
 = *
™
;

175 
™
 ++;

178  
™
;

179 
	}
}

181 
	gveùÜ
<
	gRAIDInfo
>::
™”©Ü
 
RAIDMªag”
::
	$IsMDDevInRAIDInfoLi¡
(cÚ¡ 
¡ršg
 &
mddev
)

183 
RAIDInfo
 
šfo
;

184  
	`IsMDDevInRAIDInfoLi¡
(
mddev
, 
šfo
);

185 
	}
}

187 
boŞ
 
	gRAIDMªag”
::
	$IsDiskExi¡InRAIDDiskLi¡
(cÚ¡ 
¡ršg
& 
dev
)

189 #ifdeà
NUUO


190 
Cr™iÿlSeùiÚLock
 
	`cs
(&
m_csRAIDDiskLi¡
);

192 
veùÜ
<
RAIDDiskInfo
>::
™”©Ü
 
™_disk
 = 
m_vRAIDDiskLi¡
.
	`begš
();

193 
™_disk
 !ğ
m_vRAIDDiskLi¡
.
	`’d
()) {

197 
¡ršg
 
¡rDevNode
 = 
	`G‘DeviûNodeBySymLšk
(
dev
);

198 ià(*
™_disk
 =ğ
¡rDevNode
) {

199  
Œue
;

201 
™_disk
++;

204  
çl£
;

205 
	}
}

207 
boŞ
 
	gRAIDMªag”
::
IsDiskExi¡InRAIDDiskLi¡
(
veùÜ
<
¡ršg
>& 
vDevLi¡
)

209 
veùÜ
<
¡ršg
>::
™”©Ü
 
™_devli¡
 = 
vDevLi¡
.
begš
();

210 
	g™_devli¡
 !ğ
vDevLi¡
.
’d
()) {

211 if(!
IsDiskExi¡InRAIDDiskLi¡
(*
™_devli¡
)) {

212  
çl£
;

215 
	g™_devli¡
++;

218  
	gŒue
;

221 
boŞ
 
	gRAIDMªag”
::
	$IsDiskHaveMDSu³rBlock
(cÚ¡ 
¡ršg
& 
dev
, 
examše_»suÉ
 &
»suÉ
, &
”r
)

223 
veùÜ
<
¡ršg
> 
vDevLi¡
;

224 
mddev_dev
* 
devli¡
 = 
NULL
;

225 
cÚ‹xt
 
c
;

227 
vDevLi¡
.
	`push_back
(
dev
);

228 ià(
NULL
 =ğ(
devli¡
 = 
	`In™ŸlizeDevLi¡
(
vDevLi¡
))) {

229 
”r
 = 
EXAMINE_MEM_ALLOC_FAIL
;

230  
çl£
;

233 
	`In™ŸlizeCÚ‹xt
(
c
);

234 
”r
 = 
	`Examše_ToResuÉ
(
devli¡
, &
c
, 
NULL
, &
»suÉ
);

235 
	`F»eDevLi¡
(
devli¡
);

237  !(
”r
 =ğ
EXAMINE_NO_MD_SUPERBLOCK
);

238 
	}
}

240 
boŞ
 
	gRAIDMªag”
::
	$AddDiskSymLšk
(cÚ¡ 
¡ršg
& 
symlšk
, 
eDiskTy³
 
ty³
)

242 ià(
symlšk
.
	`em±y
())

243  
çl£
;

245 #ifdeà
NUUO


246 
Cr™iÿlSeùiÚLock
 
	`cs
(&
m_csSymLškTabË
);

249 
¡ršg
 
¡rDevNode
 = 
	`G‘DeviûNodeBySymLšk
(
symlšk
);

250 
MiscDiskInfo
 
	`šfo
(
symlšk
, 
ty³
);

251 
šfo
.
	`Dump
();

252 
m_m­SymLškTabË
[
¡rDevNode
] = 
šfo
;

253  
Œue
;

254 
	}
}

256 
boŞ
 
	gRAIDMªag”
::
	$RemoveDiskSymLšk
(cÚ¡ 
¡ršg
& 
symlšk
)

258 ià(
symlšk
.
	`em±y
())

259  
çl£
;

261 
¡ršg
 
¡rDevNode
 = 
	`G‘DeviûNodeBySymLšk
(
symlšk
);

263 #ifdeà
NUUO


264 
Cr™iÿlSeùiÚLock
 
	`cs
(&
m_csSymLškTabË
);

267 
m­
<
¡ršg
, 
MiscDiskInfo
>::
™”©Ü
 
™
 = 
m_m­SymLškTabË
.
	`fšd
(
¡rDevNode
);

268 ià(
™
 !ğ
m_m­SymLškTabË
.
	`’d
())

269 
m_m­SymLškTabË
.
	`”a£
(
™
);

271  
Œue
;

272 
	}
}

274 
boŞ
 
	gRAIDMªag”
::
	$AddDisk
(cÚ¡ 
¡ršg
& 
dev
)

277 ià(
dev
.
	`em±y
())

278  
çl£
;

283 #ifdeà
NUUO


284 ià(!
	`CheckBlockDeviû
(
dev
)) {

285 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

286 "% i nÙ‡ block deviû.\n", 
dev
.
	`c_¡r
());

287  
çl£
;

299 
examše_»suÉ
 
»suÉ
;

300 
»t
 = 
SUCCESS
;

301 
RAIDDiskInfo
 
šfo
;

302 
boŞ
 
bExi¡
 = 
	`IsDiskExi¡InRAIDDiskLi¡
(
dev
);

304 
šfo
.
m_bHasMDSB
 = 
	`IsDiskHaveMDSu³rBlock
(
dev
, 
»suÉ
, 
»t
);

305 
šfo
.
m_¡rDevName
 = 
	`G‘DeviûNodeBySymLšk
(
dev
);

306 
šfo
.
	`S‘HDDV’dÜInfom©iÚ
();

307 
šfo
.
m_iRaidDiskNum
 = 
»suÉ
.
uRaidDiskNum
;

308 
	`memıy
(
šfo
.
m_RaidUUID
, 
»suÉ
.
¬¿yUUID
, () * 4);

311 ià(!
bExi¡
) {

312 #ifdeà
NUUO


313 
Cr™iÿlSeùiÚLock
 
	`cs
(&
m_csRAIDDiskLi¡
);

315 
m_vRAIDDiskLi¡
.
	`push_back
(
šfo
);

316 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_INFO
, 
LOG_LABEL
,

317 "% added sucûssfuÎy .\n", 
dev
.
	`c_¡r
());

322 ià(!
šfo
.
m_bHasMDSB
) {

323 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_INFO
, 
LOG_LABEL
,

324 "% ha nØMD su³rblock .\n", 
dev
.
	`c_¡r
());

325  
Œue
;

326 } ià(
»t
 > 0) {

327 
	`Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_DEBUG
, 
LOG_LABEL
,

328 "[%d] ExamšE¼Ü Cod%s: (%d)\n", 
__LINE__
,

329 
dev
.
	`c_¡r
(), 
»t
);

330  
çl£
;

340 
¡ršg
 
mddev
;

341 
veùÜ
<
RAIDInfo
>::
™”©Ü
 
¿id_™
 = 
	`S—rchDiskB–Úg2RAID
(
šfo
);

342 ià(
¿id_™
 !ğ
m_vRAIDInfoLi¡
.
	`’d
()) {

343 
veùÜ
<
¡ršg
> 
vDevLi¡
;

344 
vDevLi¡
.
	`push_back
(
dev
);

346 ià(
šfo
.
m_iS‹
 & (1 << 
MD_DISK_ACTIVE
)) {

349 
»t
 = 
	`R—ddMDDisks
(
¿id_™
->
m_¡rDevNodeName
, 
vDevLi¡
);

350 ià(
»t
 !ğ
SUCCESS
) {

351 
	`Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_DEBUG
, 
LOG_LABEL
,

353 
__LINE__
,

354 
¿id_™
->
m_¡rDevNodeName
.
	`c_¡r
(), 
»t
);

362 
couÁ”
 = 1;

363 #ifdeà
NUUO


364 
m_csRAIDDiskLi¡
.
	`Lock
();

366 
size_t
 
i
 = 0; i < 
m_vRAIDDiskLi¡
.
	`size
(); i++) {

367 ià(
šfo
.
m_¡rDevName
 =ğ
m_vRAIDDiskLi¡
[
i
].m_strDevName)

371 ià(0 =ğ
	`memcmp
(
šfo
.
m_RaidUUID
, 
m_vRAIDDiskLi¡
[
i
].m_RaidUUID, () * 4))

372 
couÁ”
++;

374 #ifdeà
NUUO


375 
m_csRAIDDiskLi¡
.
	`UÆock
();

378 ià(
couÁ”
 >ğ
šfo
.
m_iRaidDiskNum
) {

379 ià(
	`As£mbËRAID
(
šfo
.
m_RaidUUID
, 
mddev
)) {

384 
num
 = -1;

385 ià(
	`IsFÜm©ed
(
mddev
è&& !
	`IsMouÁed
(mddev, 
num
))

386 
	`MouÁ
(
mddev
);

387  
Œue
;

393 
	`Upd©eRAIDInfo
(
mddev
);

394  
Œue
;

395 
	}
}

397 
	gveùÜ
<
	gRAIDInfo
>::
™”©Ü
 
RAIDMªag”
::
	$S—rchDiskB–Úg2RAID
(
RAIDDiskInfo
& 
šfo
)

400 ià(
šfo
.
m_¡rDevName
.
	`em±y
())

401  
m_vRAIDInfoLi¡
.
	`’d
();

411 #ifdeà
NUUO


412 
Cr™iÿlSeùiÚLock
 
	`cs
(&
m_csRAIDInfoLi¡
);

414 
veùÜ
<
RAIDInfo
>::
™”©Ü
 
™
 = 
m_vRAIDInfoLi¡
.
	`begš
();

415 
™
 !ğ
m_vRAIDInfoLi¡
.
	`’d
()) {

417 ià(0 !ğ
	`memcmp
(
™
->
m_UUID
, 
šfo
.
m_RaidUUID
, (info.m_RaidUUID))) {

418 
™
 ++;

421 
veùÜ
<
RAIDDiskInfo
>::
™”©Ü
 
™_disk
 = 
™
->
m_vDiskLi¡
.
	`begš
();

422 
™_disk
 !ğ
™
->
m_vDiskLi¡
.
	`’d
()) {

423 ià(*
™_disk
 =ğ
šfo
.
m_¡rDevName
) {

424 
šfo
 = *
™_disk
;

428 
™_disk
++;

430  
™
;

434 
™
 ++;

437  
™
;

438 
	}
}

440 
boŞ
 
	gRAIDMªag”
::
	$RemoveDisk
(cÚ¡ 
¡ršg
& 
dev
)

449 ià(
dev
.
	`em±y
())

450  
çl£
;

470 
RAIDDiskInfo
 
šfo
;

471 
veùÜ
<
RAIDInfo
>::
™”©Ü
 
¿id_™
 = 
	`S—rchDiskB–Úg2RAID
(
dev
, 
šfo
);

472 ià(
¿id_™
 !ğ
m_vRAIDInfoLi¡
.
	`’d
()) {

473 
num
 = 0;

474 ià(
	`IsMouÁed
(
¿id_™
->
m_¡rDevNodeName
, 
num
)) {

475 ià(
	`UnmouÁ
(
¿id_™
->
m_¡rDevNodeName
))

476  
çl£
;

479 
veùÜ
<
¡ršg
> 
vDevLi¡
;

480 
vDevLi¡
.
	`push_back
(
dev
);

481 ià(!
	`M¬kFauÉyMDDisks
(
¿id_™
->
m_¡rDevNodeName
, 
vDevLi¡
))

482  
çl£
;

484 ià(!
	`RemoveMDDisks
(
¿id_™
->
m_¡rDevNodeName
, 
vDevLi¡
))

485  
çl£
;

496 #ifdeà
NUUO


497 
m_csRAIDDiskLi¡
.
	`Lock
();

499 
veùÜ
<
RAIDDiskInfo
>::
™”©Ü
 
™
 = 
m_vRAIDDiskLi¡
.
	`begš
();

500 
uuid
[4];

501 
™
 !ğ
m_vRAIDDiskLi¡
.
	`’d
()) {

502 ià(*
™
 =ğ
dev
) {

503 
	`memıy
(
uuid
, 
™
->
m_RaidUUID
, () * 4);

506 
™
++;

509 ià(
™
 =ğ
m_vRAIDDiskLi¡
.
	`’d
()) {

510 #ifdeà
NUUO


511 
m_csRAIDDiskLi¡
.
	`UÆock
();

513 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_INFO
, 
LOG_LABEL
,

514 "% »moved sucûssfuÎy .\n", 
dev
.
	`c_¡r
());

515  
Œue
;

518 
m_vRAIDDiskLi¡
.
	`”a£
(
™
);

519 #ifdeà
NUUO


520 
m_csRAIDDiskLi¡
.
	`UÆock
();

528 ià(
¿id_™
 !ğ
m_vRAIDInfoLi¡
.
	`’d
()) {

530 
	`MouÁ
(
¿id_™
->
m_¡rDevNodeName
);

535 
	`Upd©eRAIDInfo
(
uuid
);

536 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_INFO
, 
LOG_LABEL
,

537 "% »moved sucûssfuÎy .\n", 
dev
.
	`c_¡r
());

538  
Œue
;

539 
	}
}

541 
	gRAIDMªag”
::
Upd©eRAIDDiskLi¡
(
veùÜ
<
RAIDDiskInfo
>& 
vRAIDDiskInfoLi¡
, cÚ¡ 
¡ršg
& 
mddev
)

543 ià(
	gvRAIDDiskInfoLi¡
.
em±y
())

546 
	gveùÜ
<
	gRAIDDiskInfo
>::
™”©Ü
 
™
 = 
vRAIDDiskInfoLi¡
.
begš
();

547 
	g™
 !ğ
vRAIDDiskInfoLi¡
.
’d
()) {

548 
boŞ
 
bExi¡
 = 
çl£
;

549 #ifdeà
NUUO


550 
Cr™iÿlSeùiÚLock
 
cs
(&
m_csRAIDDiskLi¡
);

552 
	gveùÜ
<
	gRAIDDiskInfo
>::
™”©Ü
 
™_®l
 = 
m_vRAIDDiskLi¡
.
begš
();

553 
	g™_®l
 !ğ
m_vRAIDDiskLi¡
.
’d
()) {

554 ià(*
™
 =ğ*
™_®l
) {

555 
examše_»suÉ
 
»suÉ
;

556 
	g»t
 = 
SUCCESS
;

558 
	g™
->
	gm_bHasMDSB
 = 
IsDiskHaveMDSu³rBlock
(
™
->
m_¡rDevName
, 
»suÉ
, 
»t
);

559 *
	g™_®l
 = *
™
;

560 
	gbExi¡
 = 
Œue
;

564 
	g™_®l
++;

567 ià(!
	gbExi¡
) {

572 
	gm_vRAIDDiskLi¡
.
push_back
(*
™
);

575 #ifdeà
NUUO


576 
Cr™iÿlSeùiÚLock
 
cs
(&
m_m­SymLškTabË
);

578 
	gm_m­SymLškTabË
[
™
->
m_¡rDevName
].
	gm_¡rMDDev
 = 
mddev
;

579 
	g™
++;

582 #ifdeà
NUUO


583 
Cr™iÿlSeùiÚLock
 
cs
(&
m_m­SymLškTabË
);

585 
	gm­
<
	g¡ršg
, 
	gMiscDiskInfo
>::
™”©Ü
 
™_symLškTab
 = 
m_m­SymLškTabË
.
begš
();

586 
	g™_symLškTab
 !ğ
m_m­SymLškTabË
.
’d
()) {

587 ià(
™_symLškTab
->
£cÚd
.
m_¡rMDDev
 !ğ
mddev
) {

588 
™_symLškTab
++;

592 
boŞ
 
	gbFound
 = 
çl£
;

593 
size_t
 
	gi
 = 0; i < 
	gvRAIDDiskInfoLi¡
.
size
(); i++) {

594 ià(
	g™_symLškTab
->
	gfœ¡
 =ğ
vRAIDDiskInfoLi¡
[
i
].
m_¡rDevName
) {

595 
bFound
 = 
Œue
;

600 ià(!
	gbFound
)

601 
	g™_symLškTab
->
	g£cÚd
.
	gm_¡rMDDev
 = "";

603 
	g™_symLškTab
++;

607 
boŞ
 
	gRAIDMªag”
::
	$Upd©eRAIDInfo
(cÚ¡ 
¡ršg
& 
mddev
, 
mdnum
)

614 ià(
mddev
.
	`em±y
())

615  
çl£
;

623 
cÚ‹xt
 
c
;

624 
¬¿y_d‘a
 
ad
;

625 
RAIDInfo
 
šfo
;

626 
»t
 = 
SUCCESS
;

628 
	`In™ŸlizeCÚ‹xt
(
c
);

629 
»t
 = 
	`D‘a_ToA¼ayD‘a
(
mddev
.
	`c_¡r
(), &
c
, &
ad
);

630 ià(
»t
 !ğ
SUCCESS
) {

631 
	`Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_DEBUG
, 
LOG_LABEL
,

633 
__LINE__
, 
mddev
.
	`c_¡r
(), 
»t
);

634  
çl£
;

635 } ià(
ad
.
¬¿yInfo
.
Ä_disks
 == 0) {

636 
	`Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_DEBUG
, 
LOG_LABEL
,

638 
__LINE__
, 
mddev
.
	`c_¡r
());

639  
çl£
;

642 #ifdeà
NUUO


643 
Cr™iÿlSeùiÚLock
 
	`cs
(&
m_csRAIDInfoLi¡
);

645 
veùÜ
<
RAIDInfo
>::
™”©Ü
 
™
 = 
m_vRAIDInfoLi¡
.
	`begš
();

646 
™
 !ğ
m_vRAIDInfoLi¡
.
	`’d
()) {

647 *
™
 =ğ
mddev
) {

648 *
™
 = 
ad
;

649 
	`Upd©eRAIDDiskLi¡
(
™
->
m_vDiskLi¡
, 
mddev
);

650  
Œue
;

653 
™
 ++;

656 
šfo
 = 
ad
;

657 
šfo
.
m_iMDNum
 = 
mdnum
;

658 
šfo
.
	`In™ŸlizeFSMªag”
();

659 
	`Upd©eRAIDDiskLi¡
(
šfo
.
m_vDiskLi¡
, 
mddev
);

660 
m_vRAIDInfoLi¡
.
	`push_back
(
šfo
);

661  
Œue
;

662 
	}
}

664 
boŞ
 
	gRAIDMªag”
::
	$Upd©eRAIDInfo
()

673 #ifdeà
NUUO


674 
Cr™iÿlSeùiÚLock
 
	`cs
(&
m_csRAIDInfoLi¡
);

676 ià(
m_vRAIDInfoLi¡
.
	`em±y
())

677  
Œue
;

679 
veùÜ
<
RAIDInfo
>::
™”©Ü
 
™
 = 
m_vRAIDInfoLi¡
.
	`begš
();

680 
™
 !ğ
m_vRAIDInfoLi¡
.
	`’d
()) {

681 
cÚ‹xt
 
c
;

682 
¬¿y_d‘a
 
ad
;

683 
»t
 = 
SUCCESS
;

685 
	`In™ŸlizeCÚ‹xt
(
c
);

686 
»t
 = 
	`D‘a_ToA¼ayD‘a
(
™
->
m_¡rDevNodeName
.
	`c_¡r
(), &
c
, &
ad
);

687 ià(
»t
 !ğ
SUCCESS
) {

688 
	`Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_DEBUG
, 
LOG_LABEL
, "[%d] D‘a E¼Ü Cod%s: (%d)\n", 
__LINE__
, 
™
->
m_¡rDevNodeName
.
	`c_¡r
(), 
»t
);

689 
™
++;

693 *
™
 = 
ad
;

694 
	`Upd©eRAIDDiskLi¡
(
™
->
m_vDiskLi¡
, it->
m_¡rDevNodeName
);

696 
™
 ++;

699  
Œue
;

700 
	}
}

702 
boŞ
 
	gRAIDMªag”
::
	$Upd©eRAIDInfo
(cÚ¡ 
uuid
[4])

710 ià(
uuid
 =ğ
NULL
)

711  
çl£
;

713 #ifdeà
NUUO


714 
Cr™iÿlSeùiÚLock
 
	`cs
(&
m_csRAIDInfoLi¡
);

716 ià(
m_vRAIDInfoLi¡
.
	`em±y
())

717  
Œue
;

719 
veùÜ
<
RAIDInfo
>::
™”©Ü
 
™
 = 
m_vRAIDInfoLi¡
.
	`begš
();

720 
™
 !ğ
m_vRAIDInfoLi¡
.
	`’d
()) {

721 ià(0 =ğ
	`memcmp
(
uuid
, 
™
->
m_UUID
, () * 4)) {

722 
cÚ‹xt
 
c
;

723 
¬¿y_d‘a
 
ad
;

724 
»t
 = 
SUCCESS
;

726 
	`In™ŸlizeCÚ‹xt
(
c
);

727 
»t
 = 
	`D‘a_ToA¼ayD‘a
(
™
->
m_¡rDevNodeName
.
	`c_¡r
(), &
c
, &
ad
);

728 ià(
»t
 =ğ
SUCCESS
) {

729 *
™
 = 
ad
;

730 
	`Upd©eRAIDDiskLi¡
(
™
->
m_vDiskLi¡
, it->
m_¡rDevNodeName
);

731  
Œue
;

733 
	`Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_DEBUG
, 
LOG_LABEL
, "[%d] D‘a E¼Ü Cod%s: (%d)\n", 
__LINE__
, 
™
->
m_¡rDevNodeName
.
	`c_¡r
(), 
»t
);

738 
™
++;

741 * 
p_uuid
 = (*è
uuid
;

742 
¡ršg
 
	`¡rUUID
("");

743 
i
 = 0; i < 16; i++) {

744 
¡rUUID
 +ğ
	`¡ršg_fÜm©
("%02X ", 
p_uuid
[
i
]);

746 
	`Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_DEBUG
, 
LOG_LABEL
, "MD deviû cÜ»¥ÚdšgØ%swa nÙ found.\n", 
¡rUUID
.
	`c_¡r
());

747  
çl£
;

748 
	}
}

750 
	gRAIDMªag”
::
	$In™ŸlizeSh­e
(
sh­e
& 
s
, 
¿iddisks
, 
Ëv–
, 
chunk
, 
b™m­_chunk
, * 
b™m­_fe
)

752 
	`mem£t
(&
s
, 0x00, (
sh­e
));

753 
s
.
¿iddisks
 =„aiddisks;

754 
s
.
Ëv–
 =†evel;

755 
s
.
Ïyout
 = 
UnS‘
;

756 
s
.
b™m­_chunk
 = bitmap_chunk;

757 
s
.
chunk
 = chunk;

758 
s
.
assume_ş—n
 = 0;

759 
s
.
b™m­_fe
 = bitmap_file;

760 
	}
}

762 
	gRAIDMªag”
::
	$In™ŸlizeCÚ‹xt
(
cÚ‹xt
& 
c
, 
fÜû
, 
run¡İ
, 
v”bo£
)

764 
	`mem£t
(&
c
, 0x00, (
cÚ‹xt
));

765 
c
.
fÜû
 = force;

766 
c
.
d–ay
 = 
DEFAULT_BITMAP_DELAY
;

767 
c
.
run¡İ
 =„unstop;

768 
c
.
v”bo£
 = verbose;

769 
c
.
br›f
 = 0;

770 
	}
}

772 
	gRAIDMªag”
::
	$In™ŸlizeMDDevId’t
(
mddev_id’t
& 
id’t
, 
uuid_£t
, cÚ¡ 
uuid
[4], 
b™m­_fd
, * 
b™m­_fe
)

774 
	`mem£t
(&
id’t
, 0x00, (
mddev_id’t
));

775 
id’t
.
uuid_£t
 = uuid_set;

776 
id’t
.
su³r_mšÜ
 = 
UnS‘
;

777 
id’t
.
Ëv–
 = 
UnS‘
;

778 
id’t
.
¿id_disks
 = 
UnS‘
;

779 
id’t
.
¥¬e_disks
 = 
UnS‘
;

780 
id’t
.
b™m­_fd
 = bitmap_fd;

781 
id’t
.
b™m­_fe
 = bitmap_file;

782 ià(
uuid_£t
) {

783 
	`memıy
(
id’t
.
uuid
, uuid, () * 4);

784 
i
 = 0; i < 4; i++) {

785 
id’t
.
uuid
[
i
] = 
	`__be32_to_ıu
(ident.uuid[i]);

788 
	}
}

790 
mddev_dev
* 
	gRAIDMªag”
::
	$In™ŸlizeDevLi¡
(cÚ¡ 
¡ršg
& 
»¶aû
, cÚ¡ sŒšg& 
w™h
)

792 
mddev_dev
* 
devli¡
 = 
NULL
;

793 
mddev_dev
** 
devli¡’d
 = &
devli¡
;

794 
mddev_dev
* 
dv
 = 
NULL
;

796 ià(
»¶aû
.
	`em±y
(è|| 
w™h
.empty())

797  
NULL
;

799 
devli¡
 = 
NULL
;

800 
dv
 = (
mddev_dev
*)
	`m®loc
((mddev_dev));

801 ià(
dv
 =ğ
NULL
) {

802 
	`Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_DEBUG
, 
LOG_LABEL
,

803 "[%d] FaØ®loÿ‹ memÜy.\n", 
__LINE__
);

804  
NULL
;

806 
dv
->
devÇme
 = (*)
»¶aû
.
	`c_¡r
();

807 
dv
->
di¥os™iÚ
 = 'R';

808 
dv
->
wr™emo¡ly
 = 0;

809 
dv
->
u£d
 = 0;

810 
dv
->
Ãxt
 = 
NULL
;

811 *
devli¡’d
 = 
dv
;

812 
devli¡’d
 = &
dv
->
Ãxt
;

814 
dv
 = (
mddev_dev
*)
	`m®loc
((mddev_dev));

815 ià(
dv
 =ğ
NULL
) {

816 
	`F»eDevLi¡
(
devli¡
);

817 
	`Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_DEBUG
, 
LOG_LABEL
,

818 "[%d] FaØ®loÿ‹ memÜy.\n", 
__LINE__
);

819  
NULL
;

821 
dv
->
devÇme
 = (*)
w™h
.
	`c_¡r
();

822 
dv
->
di¥os™iÚ
 = 'w';

823 
dv
->
wr™emo¡ly
 = 0;

824 
dv
->
u£d
 = 0;

825 
dv
->
Ãxt
 = 
NULL
;

826 *
devli¡’d
 = 
dv
;

827 
devli¡’d
 = &
dv
->
Ãxt
;

829  
devli¡
;

830 
	}
}

832 
mddev_dev
* 
	gRAIDMªag”
::
In™ŸlizeDevLi¡
(
veùÜ
<
¡ršg
>& 
devNameLi¡
, 
di¥os™iÚ
)

834 
mddev_dev
* 
	gdevli¡
 = 
NULL
;

835 
mddev_dev
** 
	gdevli¡’d
 = &
devli¡
;

836 
mddev_dev
* 
	gdv
 = 
NULL
;

838 ià(
	gdevNameLi¡
.
em±y
())

839  
	gNULL
;

841 
size_t
 
	gi
 = 0; i < 
	gdevNameLi¡
.
size
(); i ++) {

842 
	gdv
 = (
mddev_dev
*)
m®loc
((mddev_dev));

843 ià(
	gdv
 =ğ
NULL
) {

844 
F»eDevLi¡
(
devli¡
);

845 
Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_DEBUG
, 
LOG_LABEL
,

846 "[%d] FaØ®loÿ‹ memÜy.\n", 
__LINE__
);

847  
	gNULL
;

849 
	gdv
->
	gdevÇme
 = (*)
devNameLi¡
[
i
].
c_¡r
();

850 
	gdv
->
	gdi¥os™iÚ
 = 
di¥os™iÚ
;

851 
	gdv
->
	gwr™emo¡ly
 = 0;

852 
	gdv
->
	gu£d
 = 0;

853 
	gdv
->
	gÃxt
 = 
NULL
;

854 *
	gdevli¡’d
 = 
dv
;

855 
	gdevli¡’d
 = &
dv
->
Ãxt
;

858  
	gdevli¡
;

861 
	gRAIDMªag”
::
	$F»eDevLi¡
(
mddev_dev
* 
devli¡
)

863 
mddev_dev
* 
dv
 = 
NULL
;

864 
dv
 = 
devli¡
; dv; dv = dv->
Ãxt
) {

865 
	`ä“
(
dv
);

867 
devli¡
 = 
NULL
;

868 
	}
}

870 
	gRAIDMªag”
::
	$O³nMDDev
(cÚ¡ 
¡ršg
& 
mddev
)

872 
fd
 = 
	`İ’_mddev
((*)
mddev
.
	`c_¡r
(), 1);

873 ià(
fd
 < 0) {

874 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

875 "FaØİ’ MD deviû. %s\n", 
mddev
.
	`c_¡r
());

878  
fd
;

879 
	}
}

881 
¡ršg
 
	gRAIDMªag”
::
	$G’”©eMDDevName
(
num
)

883  
	`¡ršg_fÜm©
("/dev/md%d", 
num
);

884 
	}
}

886 
	gRAIDMªag”
::
	$G’”©eVŞumeName
(
¡ršg
& 
Çme
)

888 
iF»eVŞume
 = 
	`G‘F»eVŞumeNum
();

889 ià(
iF»eVŞume
 < 0) {

890 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

894 
Çme
 = 
	`¡ršg_fÜm©
("/mÁ/VOLUME%d", 
iF»eVŞume
 + 1);

895 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_INFO
, 
LOG_LABEL
,

896 "VŞumName: %s\n", 
Çme
.
	`c_¡r
());

897  
iF»eVŞume
;

898 
	}
}

900 
boŞ
 
	gRAIDMªag”
::
C»©eRAID
(
veùÜ
<
¡ršg
>& 
vDevLi¡
, 
Ëv–
, sŒšg& 
¡rMDName
)

902 
	g»t
 = 
SUCCESS
;

905 
	gä“MD
 = 
G‘F»eMDNum
();

906 ià(
	gä“MD
 < 0) {

907 
Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

912 
	g»t
 = 
C»©eRAID
(
ä“MD
, 
¡rMDName
, 
vDevLi¡
, 
Ëv–
);

913 ià(
	g»t
 =ğ
SUCCESS
) {

914 
Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_INFO
, 
LOG_LABEL
,

915 "% ü—‹d sucûssfuÎy.\n", 
¡rMDName
.
c_¡r
());

916  
	gŒue
;

917 } ià(
	g»t
 =ğ
CREATE_MDDEV_INUSE
) {

918 
S‘MDNum
(
ä“MD
);

921 
F»eMDNum
(
ä“MD
);

923 } 
	g»t
 =ğ
CREATE_MDDEV_INUSE
);

925 
Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_DEBUG
, 
LOG_LABEL
,

926 "[%d] C»©E¼Ü Code: (%d)\n", 
__LINE__
, 
»t
);

927  
	gçl£
;

930 
	gRAIDMªag”
::
C»©eRAID
(cÚ¡ & 
mdnum
, 
¡ršg
& 
mddev
, 
veùÜ
<¡ršg>& 
vDevLi¡
, 
Ëv–
)

934 ià(
	gmdnum
 < 0)

935  
	gCREATE_MDNUM_ILLEGAL
;

937 
	gmddev
 = 
G’”©eMDDevName
(
mdnum
);

940 ià(
	gvDevLi¡
.
em±y
())

941  
	gCREATE_RAID_DEVS_NOT_ENOUGH
;

947 
	gveùÜ
<
	gRAIDInfo
>::
™”©Ü
 
™
 = 
IsMDDevInRAIDInfoLi¡
(
mddev
);

948 ià(
	g™
 !ğ
m_vRAIDInfoLi¡
.
’d
()) {

949 
Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_DEBUG
, 
LOG_LABEL
,

950 "[%d] C»©E¼Ü Code: (%d)\n", 
__LINE__
, 
CREATE_MDDEV_INUSE
);

952  
	gCREATE_MDDEV_INUSE
;

961 ià(!
IsDiskExi¡InRAIDDiskLi¡
(
vDevLi¡
)) {

962 
Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_DEBUG
, 
LOG_LABEL
,

963 "[%d] C»©E¼Ü Code: (%d)\n", 
__LINE__
, 
CREATE_RAID_DEVS_NOT_EXIST_IN_LIST
);

964  
	gCREATE_RAID_DEVS_NOT_EXIST_IN_LIST
;

968 
sh­e
 
	gs
;

969 
In™ŸlizeSh­e
(
s
, 
vDevLi¡
.
size
(), 
Ëv–
, 512);

972 
cÚ‹xt
 
	gc
;

973 
In™ŸlizeCÚ‹xt
(
c
);

979 
mddev_dev
* 
	gdevli¡
 = 
In™ŸlizeDevLi¡
(
vDevLi¡
);

980 ià(
	gdevli¡
 =ğ
NULL
)

981  
çl£
;

988 
	g»t
 = 
C»©e
(
NULL
, (*)
mddev
.
c_¡r
(), NULL, NULL, 
vDevLi¡
.
size
(), 
devli¡
, &
s
, &
c
, 
INVALID_SECTORS
);

989 ià(
	g»t
 !ğ
SUCCESS
) {

990 
Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

991 "FaØü—‹ vŞum%s: (%d)\n", 
mddev
.
c_¡r
(), 
»t
);

992  
	g»t
;

996 
Upd©eRAIDInfo
(
mddev
, 
mdnum
);

1002 
F»eDevLi¡
(
devli¡
);

1003  
	gSUCCESS
;

1006 
	gRAIDMªag”
::
C»©eRAID
(cÚ¡ 
¡ršg
& 
mddev
, 
veùÜ
<¡ršg>& 
vDevLi¡
, 
Ëv–
)

1010 ià(
	gmddev
.
em±y
())

1011  
	gCREATE_MDDEV_UNSET
;

1015 ià(
	gvDevLi¡
.
em±y
())

1016  
	gCREATE_RAID_DEVS_NOT_ENOUGH
;

1022 
	gveùÜ
<
	gRAIDInfo
>::
™”©Ü
 
™
 = 
IsMDDevInRAIDInfoLi¡
(
mddev
);

1023 ià(
	g™
 !ğ
m_vRAIDInfoLi¡
.
’d
()) {

1024 
Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_DEBUG
, 
LOG_LABEL
,

1025 "[%d] C»©E¼Ü Code: (%d)\n", 
__LINE__
, 
CREATE_MDDEV_INUSE
);

1027  
	gCREATE_MDDEV_INUSE
;

1036 ià(!
IsDiskExi¡InRAIDDiskLi¡
(
vDevLi¡
)) {

1037 
Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_DEBUG
, 
LOG_LABEL
,

1038 "[%d] C»©E¼Ü Code: (%d)\n", 
__LINE__
, 
CREATE_RAID_DEVS_NOT_EXIST_IN_LIST
);

1039  
	gCREATE_RAID_DEVS_NOT_EXIST_IN_LIST
;

1043 
sh­e
 
	gs
;

1044 
In™ŸlizeSh­e
(
s
, 
vDevLi¡
.
size
(), 
Ëv–
, 512);

1047 
cÚ‹xt
 
	gc
;

1048 
In™ŸlizeCÚ‹xt
(
c
);

1054 
mddev_dev
* 
	gdevli¡
 = 
In™ŸlizeDevLi¡
(
vDevLi¡
);

1055 ià(
	gdevli¡
 =ğ
NULL
)

1056  
çl£
;

1063 
	g»t
 = 
C»©e
(
NULL
, (*)
mddev
.
c_¡r
(), NULL, NULL, 
vDevLi¡
.
size
(), 
devli¡
, &
s
, &
c
, 
INVALID_SECTORS
);

1064 ià(
	g»t
 !ğ
SUCCESS
) {

1065 
Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

1066 "FaØü—‹ vŞum%s: (%d)\n", 
mddev
.
c_¡r
(), 
»t
);

1067  
	g»t
;

1071 
Upd©eRAIDInfo
(
mddev
);

1077 
F»eDevLi¡
(
devli¡
);

1078  
	gSUCCESS
;

1081 
boŞ
 
	gRAIDMªag”
::
	$As£mbËRAID
(cÚ¡ 
uuid
[4], 
¡ršg
& 
¡rMDName
)

1083 
»t
 = 
SUCCESS
;

1086 
ä“MD
 = 
	`G‘F»eMDNum
();

1087 ià(
ä“MD
 < 0) {

1088 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

1090  
çl£
;

1093 
»t
 = 
	`As£mbËRAID
(
ä“MD
, 
¡rMDName
, 
uuid
);

1094 ià(
»t
 =ğ
SUCCESS
) {

1095 * 
p_uuid
 = (*è
uuid
;

1096 
¡ršg
 
	`¡rUUID
("");

1097 
i
 = 0; i < 16; i++) {

1098 
¡rUUID
 +ğ
	`¡ršg_fÜm©
("%02X ", 
p_uuid
[
i
]);

1100 
	`Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_DEBUG
, 
LOG_LABEL
,

1101 "%swa as£mbËdØ%s.\n", 
¡rUUID
.
	`c_¡r
(), 
¡rMDName
.c_str());

1102 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_INFO
, 
LOG_LABEL
,

1103 "% as£mbËd sucûssfuÎy.\n", 
¡rMDName
.
	`c_¡r
());

1104  
Œue
;

1105 } ià(
»t
 =ğ
ASSEMBLE_MD_ALREADY_ACTIVE
) {

1106  
Œue
;

1107 } ià(
»t
 =ğ
ASSEMBLE_MDDEV_INUSE
) {

1108 
	`S‘MDNum
(
ä“MD
);

1110 } ià(
»t
 !ğ
ASSEMBLE_RAID_DEVS_NOT_ENOUGH
) {

1111 
	`F»eMDNum
(
ä“MD
);

1113 } 
»t
 =ğ
ASSEMBLE_MDDEV_INUSE
);

1115 
	`Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_DEBUG
, 
LOG_LABEL
,

1116 "[%d] As£mbË E¼Ü Code: (%d)\n", 
__LINE__
, 
»t
);

1117  
çl£
;

1118 
	}
}

1120 
	gRAIDMªag”
::
	$As£mbËRAID
(cÚ¡ & 
mdnum
, 
¡ršg
& 
mddev
, cÚ¡ 
uuid
[4])

1124 ià(
mdnum
 < 0)

1125  
ASSEMBLE_MDNUM_ILLEGAL
;

1127 
mddev
 = 
	`G’”©eMDDevName
(
mdnum
);

1133 ià(
uuid
 =ğ
NULL
)

1134  
ASSEMBLE_INVALID_UUID
;

1140 
RAIDInfo
 
šfo
;

1141 
veùÜ
<
RAIDInfo
>::
™”©Ü
 
™
 = 
	`IsMDDevInRAIDInfoLi¡
(
mddev
, 
šfo
);

1142 ià(
™
 !ğ
m_vRAIDInfoLi¡
.
	`’d
()) {

1143 
»t
 = 
ASSEMBLE_MDDEV_INUSE
;

1144 ià(0 =ğ
	`memcmp
(
uuid
, 
šfo
.
m_UUID
, (info.m_UUID))) {

1145 
»t
 = 
ASSEMBLE_MD_ALREADY_ACTIVE
;

1147 
	`Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_DEBUG
, 
LOG_LABEL
,

1148 "[%d] As£mbË E¼Ü Code: (%d)\n", 
__LINE__
, 
»t
);

1149  
»t
;

1155 
mddev_id’t
 
id’t
;

1156 
	`In™ŸlizeMDDevId’t
(
id’t
, 1, 
uuid
);

1163 
cÚ‹xt
 
c
;

1164 
	`In™ŸlizeCÚ‹xt
(
c
);

1165 
»t
 = 
	`As£mbË
(
NULL
, (*)
mddev
.
	`c_¡r
(), &
id’t
, NULL, &
c
);

1166 ià(
»t
 !ğ
SUCCESS
) {

1167 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

1168 "FaØas£mbË vŞum%s: (%d)\n", 
mddev
.
	`c_¡r
(), 
»t
);

1169 iàĞ
»t
 !ğ
ASSEMBLE_RAID_DEVS_NOT_ENOUGH
)

1170  
»t
;

1176 
	`Upd©eRAIDInfo
(
mddev
, 
mdnum
);

1177  
»t
;

1178 
	}
}

1180 
	gRAIDMªag”
::
	$As£mbËRAID
(cÚ¡ 
¡ršg
& 
mddev
, cÚ¡ 
uuid
[4])

1186 ià(
mddev
.
	`em±y
())

1187  
ASSEMBLE_MDDEV_UNSET
;

1193 ià(
uuid
 =ğ
NULL
)

1194  
ASSEMBLE_INVALID_UUID
;

1200 
RAIDInfo
 
šfo
;

1201 
veùÜ
<
RAIDInfo
>::
™”©Ü
 
™
 = 
	`IsMDDevInRAIDInfoLi¡
(
mddev
, 
šfo
);

1202 ià(
™
 !ğ
m_vRAIDInfoLi¡
.
	`’d
()) {

1203 
»t
 = 
ASSEMBLE_MDDEV_INUSE
;

1204 ià(0 =ğ
	`memcmp
(
uuid
, 
šfo
.
m_UUID
, (info.m_UUID))) {

1205 
»t
 = 
ASSEMBLE_MD_ALREADY_ACTIVE
;

1208 
	`Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_DEBUG
, 
LOG_LABEL
,

1209 "[%d] As£mbË E¼Ü Code: (%d)\n", 
__LINE__
, 
»t
);

1210  
»t
;

1216 
mddev_id’t
 
id’t
;

1217 
	`In™ŸlizeMDDevId’t
(
id’t
, 1, 
uuid
);

1224 
cÚ‹xt
 
c
;

1225 
	`In™ŸlizeCÚ‹xt
(
c
);

1226 
»t
 = 
	`As£mbË
(
NULL
, (*)
mddev
.
	`c_¡r
(), &
id’t
, NULL, &
c
);

1227 ià(
»t
 !ğ
SUCCESS
) {

1228 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

1229 "FaØas£mbË vŞum%s: (%d)\n", 
mddev
.
	`c_¡r
(), 
»t
);

1230 iàĞ
»t
 !ğ
ASSEMBLE_RAID_DEVS_NOT_ENOUGH
)

1231  
»t
;

1237 
	`Upd©eRAIDInfo
(
mddev
);

1238  
»t
;

1239 
	}
}

1241 
boŞ
 
	gRAIDMªag”
::
As£mbËRAID
(
veùÜ
<
¡ršg
>& 
vDevLi¡
, sŒšg& 
¡rMDName
)

1243 
	g»t
 = 
SUCCESS
;

1246 
	gä“MD
 = 
G‘F»eMDNum
();

1247 ià(
	gä“MD
 < 0) {

1248 
Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

1250  
	gçl£
;

1253 
	g»t
 = 
As£mbËRAID
(
ä“MD
, 
¡rMDName
, 
vDevLi¡
);

1254 ià(
	g»t
 =ğ
SUCCESS
) {

1255 
¡ršg
 
¡rDevLi¡
("");

1256 
size_t
 
	gi
 = 0; i < 
	gvDevLi¡
.
size
(); i++) {

1257 
	g¡rDevLi¡
 +ğ
vDevLi¡
[
i
];

1259 
Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_DEBUG
, 
LOG_LABEL
,

1260 "%swa as£mbËdØ%s.\n", 
¡rDevLi¡
.
c_¡r
(), 
¡rMDName
.c_str());

1261 
Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_INFO
, 
LOG_LABEL
,

1262 "% as£mbËd sucûssfuÎy.\n", 
¡rMDName
.
c_¡r
());

1263  
	gŒue
;

1264 } ià(
	g»t
 =ğ
ASSEMBLE_MDDEV_INUSE
) {

1265 
S‘MDNum
(
ä“MD
);

1267 } ià(
	g»t
 !ğ
ASSEMBLE_RAID_DEVS_NOT_ENOUGH
) {

1268 
F»eMDNum
(
ä“MD
);

1270 } 
	g»t
 =ğ
ASSEMBLE_MDDEV_INUSE
);

1272 
Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_DEBUG
, 
LOG_LABEL
,

1273 "[%d] As£mbË E¼Ü Code: (%d)\n", 
__LINE__
, 
»t
);

1274  
	gçl£
;

1277 
	gRAIDMªag”
::
As£mbËRAID
(cÚ¡ & 
mdnum
, 
¡ršg
& 
mddev
, 
veùÜ
<¡ršg>& 
vDevLi¡
)

1283 ià(
	gmdnum
 < 0)

1284  
	gASSEMBLE_MDNUM_ILLEGAL
;

1286 
	gmddev
 = 
G’”©eMDDevName
(
mdnum
);

1292 ià(
	gvDevLi¡
.
em±y
())

1293  
	gASSEMBLE_NO_DEVS_FOR_MD
;

1303 
	gveùÜ
<
	gRAIDInfo
>::
™”©Ü
 
™
 = 
IsMDDevInRAIDInfoLi¡
(
mddev
);

1304 ià(
	g™
 !ğ
m_vRAIDInfoLi¡
.
’d
()) {

1305 
Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_DEBUG
, 
LOG_LABEL
,

1306 "[%d] As£mbË E¼Ü Code: (%d)\n", 
__LINE__
, 
ASSEMBLE_MDDEV_INUSE
);

1308  
	gASSEMBLE_MDDEV_INUSE
;

1317 ià(!
IsDiskExi¡InRAIDDiskLi¡
(
vDevLi¡
)) {

1318 
Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_DEBUG
, 
LOG_LABEL
,

1319 "[%d] As£mbË E¼Ü Code: (%d)\n", 
__LINE__
, 
ASSEMBLE_RAID_DEVS_NOT_EXIST_IN_LIST
);

1320  
	gASSEMBLE_RAID_DEVS_NOT_EXIST_IN_LIST
;

1326 
mddev_id’t
 
	gid’t
;

1327 
In™ŸlizeMDDevId’t
(
id’t
, 0, 
NULL
);

1333 
mddev_dev
* 
	gdevli¡
 = 
In™ŸlizeDevLi¡
(
vDevLi¡
);

1334 if(
	gdevli¡
 =ğ
NULL
) {

1335  
ASSEMBLE_INITIALIZE_DEV_LIST_FAIL
;

1343 
cÚ‹xt
 
	gc
;

1344 
In™ŸlizeCÚ‹xt
(
c
);

1345 
	g»t
 = 
As£mbË
(
NULL
, (*)
mddev
.
c_¡r
(), &
id’t
, 
devli¡
, &
c
);

1346 
F»eDevLi¡
(
devli¡
);

1347 ià(
	g»t
 != 0) {

1348 
Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

1349 "FaØas£mbË vŞum%s: (%d)\n", 
mddev
.
c_¡r
(), 
»t
);

1350 iàĞ
	g»t
 !ğ
ASSEMBLE_RAID_DEVS_NOT_ENOUGH
)

1351  
»t
;

1361 
Upd©eRAIDInfo
(
mddev
, 
mdnum
);

1362  
	g»t
;

1365 
	gRAIDMªag”
::
As£mbËRAID
(cÚ¡ 
¡ršg
& 
mddev
, 
veùÜ
<¡ršg>& 
vDevLi¡
)

1371 ià(
	gmddev
.
em±y
())

1372  
	gASSEMBLE_MDDEV_UNSET
;

1378 ià(
	gvDevLi¡
.
em±y
())

1379  
	gASSEMBLE_NO_DEVS_FOR_MD
;

1389 
	gveùÜ
<
	gRAIDInfo
>::
™”©Ü
 
™
 = 
IsMDDevInRAIDInfoLi¡
(
mddev
);

1390 ià(
	g™
 !ğ
m_vRAIDInfoLi¡
.
’d
()) {

1391 
Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_DEBUG
, 
LOG_LABEL
,

1392 "[%d] As£mbË E¼Ü Code: (%d)\n", 
__LINE__
, 
ASSEMBLE_MDDEV_INUSE
);

1394  
	gASSEMBLE_MDDEV_INUSE
;

1403 ià(!
IsDiskExi¡InRAIDDiskLi¡
(
vDevLi¡
)) {

1404 
Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_DEBUG
, 
LOG_LABEL
,

1405 "[%d] As£mbË E¼Ü Code: (%d)\n", 
__LINE__
, 
ASSEMBLE_RAID_DEVS_NOT_EXIST_IN_LIST
);

1406  
	gASSEMBLE_RAID_DEVS_NOT_EXIST_IN_LIST
;

1412 
mddev_id’t
 
	gid’t
;

1413 
In™ŸlizeMDDevId’t
(
id’t
, 0, 
NULL
);

1419 
mddev_dev
* 
	gdevli¡
 = 
In™ŸlizeDevLi¡
(
vDevLi¡
);

1420 if(
	gdevli¡
 =ğ
NULL
) {

1421  
ASSEMBLE_INITIALIZE_DEV_LIST_FAIL
;

1429 
cÚ‹xt
 
	gc
;

1430 
In™ŸlizeCÚ‹xt
(
c
);

1431 
	g»t
 = 
As£mbË
(
NULL
, (*)
mddev
.
c_¡r
(), &
id’t
, 
devli¡
, &
c
);

1432 
F»eDevLi¡
(
devli¡
);

1433 ià(
	g»t
 != 0) {

1434 
Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

1435 "FaØas£mbË vŞum%s: (%d)\n", 
mddev
.
c_¡r
(), 
»t
);

1436 iàĞ
	g»t
 !ğ
ASSEMBLE_RAID_DEVS_NOT_ENOUGH
)

1437  
»t
;

1447 
Upd©eRAIDInfo
(
mddev
);

1448  
	g»t
;

1451 
boŞ
 
	gRAIDMªag”
::
MªageRAIDSubdevs
(cÚ¡ 
¡ršg
& 
mddev
, 
veùÜ
<¡ršg>& 
vDevLi¡
, 
İ”©iÚ
)

1457 ià(
	gmddev
.
em±y
())

1458  
	gçl£
;

1464 ià(
	gvDevLi¡
.
em±y
())

1465  
	gçl£
;

1471 
	gveùÜ
<
	gRAIDInfo
>::
™”©Ü
 
™
 = 
IsMDDevInRAIDInfoLi¡
(
mddev
);

1472 ià(
	g™
 =ğ
m_vRAIDInfoLi¡
.
’d
()) {

1473 
Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

1474 "% dÛ¢'ˆexi¡.\n", 
mddev
.
c_¡r
());

1475  
	gçl£
;

1484 ià(!
IsDiskExi¡InRAIDDiskLi¡
(
vDevLi¡
)) {

1485 
Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

1486 "Somdisk dÛ¢'ˆb–ÚgØ%s.\n", 
mddev
.
c_¡r
());

1487  
	gçl£
;

1495 
	gfd
 = 
O³nMDDev
(
mddev
);

1496 ià(
	gfd
 < 0)

1497  
	gçl£
;

1508 
mddev_dev
* 
	gdevli¡
 = 
NULL
;

1509 
	gİ”©iÚ
) {

1511 ià(
vDevLi¡
.
size
() != 2) {

1512 
şo£
(
fd
);

1513 
Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_DEBUG
, 
LOG_LABEL
,

1515  
	gçl£
;

1518 ià(
	gNULL
 =ğ(
devli¡
 = 
In™ŸlizeDevLi¡
(
vDevLi¡
[0], vDevList[1]))) {

1519  
	gçl£
;

1523 ià(
NULL
 =ğ(
devli¡
 = 
In™ŸlizeDevLi¡
(
vDevLi¡
, 
İ”©iÚ
))) {

1524  
	gçl£
;

1535 
cÚ‹xt
 
	gc
;

1536 
In™ŸlizeCÚ‹xt
(
c
);

1537 
	g»t
 = 
Mªage_subdevs
((*)
mddev
.
c_¡r
(), 
fd
, 
devli¡
, 
c
.
v”bo£
, 0, 
NULL
, c.
fÜû
);

1538 
şo£
(
fd
);

1539 
F»eDevLi¡
(
devli¡
);

1548 ià(
	g»t
 != 0) {

1549 
Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

1550 "FaØmªagvŞum%s: (%d)\n", 
mddev
.
c_¡r
(), 
»t
);

1551  
	gçl£
;

1554 
Upd©eRAIDInfo
(
mddev
);

1555  
	gSUCCESS
;

1558 
boŞ
 
	gRAIDMªag”
::
RemoveMDDisks
(cÚ¡ 
¡ršg
& 
mddev
, 
veùÜ
<¡ršg>& 
vDevLi¡
)

1560  
MªageRAIDSubdevs
(
mddev
, 
vDevLi¡
, 'r');

1563 
boŞ
 
	gRAIDMªag”
::
M¬kFauÉyMDDisks
(cÚ¡ 
¡ršg
& 
mddev
, 
veùÜ
<¡ršg>& 
vDevLi¡
)

1565  
MªageRAIDSubdevs
(
mddev
, 
vDevLi¡
, 'f');

1568 
boŞ
 
	gRAIDMªag”
::
AddMDDisks
(cÚ¡ 
¡ršg
& 
mddev
, 
veùÜ
<¡ršg>& 
vDevLi¡
)

1570  
MªageRAIDSubdevs
(
mddev
, 
vDevLi¡
, 'a');

1573 
boŞ
 
	gRAIDMªag”
::
R—ddMDDisks
(cÚ¡ 
¡ršg
& 
mddev
, 
veùÜ
<¡ršg>& 
vDevLi¡
)

1575  
MªageRAIDSubdevs
(
mddev
, 
vDevLi¡
, 'A');

1578 
boŞ
 
	gRAIDMªag”
::
	$R•ÏûMDDisk
(cÚ¡ 
¡ršg
& 
mddev
, cÚ¡ sŒšg& 
»¶aû
, cÚ¡ sŒšg& 
w™h
)

1580 ià(
»¶aû
.
	`em±y
(è|| 
w™h
.empty())

1581  
çl£
;

1583 
veùÜ
<
¡ršg
> 
vDevLi¡
;

1584 
vDevLi¡
.
	`push_back
(
»¶aû
);

1585 
vDevLi¡
.
	`push_back
(
w™h
);

1587  
	`MªageRAIDSubdevs
(
mddev
, 
vDevLi¡
, 'R');

1588 
	}
}

1590 
boŞ
 
	gRAIDMªag”
::
	$StİRAID
(cÚ¡ 
¡ršg
& 
mddev
)

1596 ià(
mddev
.
	`em±y
())

1597  
çl£
;

1604 
veùÜ
<
RAIDInfo
>::
™”©Ü
 
™
 = 
	`IsMDDevInRAIDInfoLi¡
(
mddev
);

1605 ià(
™
 =ğ
m_vRAIDInfoLi¡
.
	`’d
()) {

1606 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_WARNING
, 
LOG_LABEL
,

1607 "% dÛ¢'ˆexi¡.\n", 
mddev
.
	`c_¡r
());

1608  
Œue
;

1612 
¡©
 = 
WRITE_INODE_TABLES_UNKNOWN
, 
´og»ss
 = -1;

1613 ià(
	`G‘FÜm©Prog»ss
(
mddev
, 
¡©
, 
´og»ss
)) {

1614 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_INFO
, 
LOG_LABEL
,

1615 "FaØ¡İ vŞum%s. Iˆi fÜm©tšg. [%d/%d%%]\n", 
mddev
.
	`c_¡r
(), 
¡©
, 
´og»ss
);

1616  
çl£
;

1619 
	`UnmouÁ
(
mddev
);

1625 
fd
 = 
	`O³nMDDev
(
mddev
);

1626 ià(
fd
 < 0)

1627  
çl£
;

1635 
cÚ‹xt
 
c
;

1636 
»t
 = 
SUCCESS
;

1638 
	`In™ŸlizeCÚ‹xt
(
c
);

1639 
»t
 = 
	`Mªage_¡İ
((*)
mddev
.
	`c_¡r
(), 
fd
, 
c
.
v”bo£
, 0);

1640 
	`şo£
(
fd
);

1642 ià(
»t
 !ğ
SUCCESS
) {

1643 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

1644 "FaØ¡İ vŞum%s: %d\n", 
mddev
.
	`c_¡r
(), 
»t
);

1645  
çl£
;

1651 #ifdeà
NUUO


1652 
Cr™iÿlSeùiÚLock
 
	`cs
(&
m_csRAIDInfoLi¡
);

1655 
size_t
 
i
 = 0; i < 
™
->
m_vDiskLi¡
.
	`size
(); i++) {

1656 
Cr™iÿlSeùiÚLock
 
	`csSymLškTabË
(&
m_csSymLškTabË
);

1657 
m_m­SymLškTabË
[
™
->
m_vDiskLi¡
[
i
].
m_¡rDevName
].
m_¡rMDDev
 = "";

1660 
	`F»eMDNum
(
™
->
m_iMDNum
);

1661 
m_vRAIDInfoLi¡
.
	`”a£
(
™
);

1662  
Œue
;

1663 
	}
}

1665 
boŞ
 
	gRAIDMªag”
::
	$D–‘eRAID
(cÚ¡ 
¡ršg
& 
mddev
)

1672 
RAIDInfo
 
šfo
;

1673 
veùÜ
<
RAIDInfo
>::
™”©Ü
 
™
 = 
	`IsMDDevInRAIDInfoLi¡
(
mddev
, 
šfo
);

1674 ià(
™
 =ğ
m_vRAIDInfoLi¡
.
	`’d
()) {

1675 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_INFO
, 
LOG_LABEL
,

1676 "D–‘vŞum%s\n", 
mddev
.
	`c_¡r
());

1677  
Œue
;

1680 ià(!
	`StİRAID
(
mddev
))

1681  
çl£
;

1687 ià(
mddev
.
	`em±y
())

1688  
çl£
;

1695 
veùÜ
<
RAIDInfo
>::
™”©Ü
 
™
 = 
	`IsMDDevInRAIDInfoLi¡
(
mddev
);

1696 ià(
™
 =ğ
m_vRAIDInfoLi¡
.
	`’d
()) {

1697 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_INFO
, 
LOG_LABEL
,

1698 "D–‘vŞum%s\n", 
mddev
.
	`c_¡r
());

1699  
Œue
;

1703 
¡©
 = 
WRITE_INODE_TABLES_UNKNOWN
, 
´og»ss
 = -1;

1704 ià(
	`G‘FÜm©Prog»ss
(
mddev
, 
¡©
, 
´og»ss
)) {

1705 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_INFO
, 
LOG_LABEL
,

1706 "FaØd–‘vŞum%s. Iˆi fÜm©tšg. [%d/%d%%]\n", 
mddev
.
	`c_¡r
(), 
¡©
, 
´og»ss
);

1707  
çl£
;

1710 
	`UnmouÁ
(
mddev
);

1716 
fd
 = 
	`O³nMDDev
(
mddev
);

1717 ià(
fd
 < 0)

1718  
çl£
;

1726 
cÚ‹xt
 
c
;

1727 
»t
 = 
SUCCESS
;

1729 
	`In™ŸlizeCÚ‹xt
(
c
);

1730 
»t
 = 
	`Mªage_¡İ
((*)
mddev
.
	`c_¡r
(), 
fd
, 
c
.
v”bo£
, 0);

1731 
	`şo£
(
fd
);

1733 ià(
»t
 !ğ
SUCCESS
) {

1734 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

1735 "FaØ¡İ vŞum%s: %d\n", 
mddev
.
	`c_¡r
(), 
»t
);

1736  
çl£
;

1741 
RAIDInfo
 
šfo
 = *
™
;

1742 #ifdeà
NUUO


1743 
m_csRAIDInfoLi¡
.
	`Lock
();

1746 
	`F»eMDNum
(
šfo
.
m_iMDNum
);

1747 
m_vRAIDInfoLi¡
.
	`”a£
(
™
);

1748 #ifdeà
NUUO


1749 
m_csRAIDInfoLi¡
.
	`UÆock
();

1758 
size_t
 
i
 = 0; i < 
šfo
.
m_vDiskLi¡
.
	`size
(); i++) {

1759 
»t
 = 
	`Kl
((*)
šfo
.
m_vDiskLi¡
[
i
].
m_¡rDevName
.
	`c_¡r
(), 
NULL
, 
c
.
fÜû
, c.
v”bo£
, 0);

1760 ià(
»t
 !ğ
SUCCESS
) {

1761 
	`Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_DEBUG
, 
LOG_LABEL
,

1762 "KÈE¼Ü Cod%s: %d\n", 
šfo
.
m_vDiskLi¡
[
i
].
m_¡rDevName
.
	`c_¡r
(), 
»t
);

1770 
examše_»suÉ
 
»suÉ
;

1771 
»t
 = 
SUCCESS
;

1774 ià(
	`IsDiskHaveMDSu³rBlock
(
šfo
.
m_vDiskLi¡
[
i
].
m_¡rDevName
.
	`c_¡r
(), 
»suÉ
, 
»t
)) {

1775 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_WARNING
, 
LOG_LABEL
,

1777 
šfo
.
m_vDiskLi¡
[
i
].
m_¡rDevName
.
	`c_¡r
(), 
»t
);

1779 
¡ršg
 
cmd
 = 
	`¡ršg_fÜm©
("dd if=/dev/z”Øof=% bs=512 couÁ=1", 
šfo
.
m_vDiskLi¡
[
i
].
m_¡rDevName
.
	`c_¡r
());

1780 
	`sy¡em
(
cmd
.
	`c_¡r
());

1785 
	`Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_WARNING
, 
LOG_LABEL
,

1786 "%s' su³rblock i ş—»d\n", 
šfo
.
m_vDiskLi¡
[
i
].
m_¡rDevName
.
	`c_¡r
());

1789  
Œue
;

1790 
	}
}

1792 
boŞ
 
	gRAIDMªag”
::
	$G‘RAIDInfo
(cÚ¡ 
¡ršg
& 
mddev
, 
RAIDInfo
& 
šfo
)

1798 ià(
mddev
.
	`em±y
())

1799  
çl£
;

1807 #ifdeà
NUUO


1808 
Cr™iÿlSeùiÚLock
 
	`cs
(&
m_csRAIDInfoLi¡
);

1810 
veùÜ
<
RAIDInfo
>::
™”©Ü
 
™
 = 
m_vRAIDInfoLi¡
.
	`begš
();

1811 
™
 !ğ
m_vRAIDInfoLi¡
.
	`’d
()) {

1812 ià(*
™
 =ğ
mddev
) {

1816 
™
++;

1819 ià(
™
 =ğ
m_vRAIDInfoLi¡
.
	`’d
()) {

1820 
	`Wr™eHWLog
(
LOG_LOCAL1
, 
LOG_DEBUG
, 
LOG_LABEL
,

1821 "% dÛ¢'ˆexi¡.\n", 
mddev
.
	`c_¡r
());

1822  
çl£
;

1825 
size_t
 
i
 = 0; i < 
™
->
m_vDiskLi¡
.
	`size
(); i++) {

1826 
Cr™iÿlSeùiÚLock
 
	`csSymLškTabË
(&
m_csSymLškTabË
);

1827 
™
->
m_vDiskLi¡
[
i
].
m_miscInfo
 = 
m_m­SymLškTabË
[™->m_vDiskLi¡[i].
m_¡rDevName
];

1829 
šfo
 = *
™
;

1830  
Œue
;

1831 
	}
}

1833 
	gRAIDMªag”
::
G‘RAIDInfo
(
veùÜ
<
RAIDInfo
>& 
li¡
)

1835 
li¡
.
ş—r
();

1836 #ifdeà
NUUO


1837 
Cr™iÿlSeùiÚLock
 
cs
(&
m_csRAIDInfoLi¡
);

1839 
	gveùÜ
<
	gRAIDInfo
>::
™”©Ü
 
™
 = 
m_vRAIDInfoLi¡
.
begš
();

1840 
	g™
 !ğ
m_vRAIDInfoLi¡
.
’d
()) {

1841 
size_t
 
i
 = 0; 
	gi
 < 
	g™
->
	gm_vDiskLi¡
.
size
(); i++) {

1842 
Cr™iÿlSeùiÚLock
 
csSymLškTabË
(&
m_csSymLškTabË
);

1843 
	g™
->
	gm_vDiskLi¡
[
i
].
	gm_miscInfo
 = 
m_m­SymLškTabË
[
™
->
m_vDiskLi¡
[i].
m_¡rDevName
];

1846 
	gli¡
.
push_back
(*
™
);

1847 
	g™
++;

1851 
	gRAIDMªag”
::
G‘DisksInfo
(
veùÜ
<
RAIDDiskInfo
> &
li¡
)

1853 
li¡
.
ş—r
();

1855 #ifdeà
NUUO


1856 
Cr™iÿlSeùiÚLock
 
cs
(&
m_csRAIDDiskLi¡
);

1858 
	gveùÜ
<
	gRAIDDiskInfo
>::
™”©Ü
 
™
 = 
m_vRAIDDiskLi¡
.
begš
();

1859 
	g™
 !ğ
m_vRAIDDiskLi¡
.
’d
()) {

1860 
RAIDDiskInfo
 
šfo
 = *
™
;

1861 
Cr™iÿlSeùiÚLock
 
csSymLškTabË
(&
m_csSymLškTabË
);

1862 
	gšfo
.
	gm_miscInfo
 = 
m_m­SymLškTabË
[
™
->
m_¡rDevName
];

1863 
	gli¡
.
push_back
(
šfo
);

1864 
	g™
++;

1868 
boŞ
 
	gRAIDMªag”
::
	$G‘DisksInfo
(cÚ¡ 
¡ršg
& 
dev
, 
RAIDDiskInfo
 &
šfo
)

1870 ià(
dev
.
	`em±y
()) {

1871  
çl£
;

1874 
¡ršg
 
¡rDevNode
 = 
	`G‘DeviûNodeBySymLšk
(
dev
);

1876 #ifdeà
NUUO


1877 
Cr™iÿlSeùiÚLock
 
	`csRAIDDiskLi¡
(&
m_csRAIDDiskLi¡
);

1879 
veùÜ
<
RAIDDiskInfo
>::
™”©Ü
 
™
 = 
m_vRAIDDiskLi¡
.
	`begš
();

1880 
™
 !ğ
m_vRAIDDiskLi¡
.
	`’d
()) {

1881 ià(*
™
 =ğ
¡rDevNode
) {

1882 
šfo
 = *
™
;

1883 
Cr™iÿlSeùiÚLock
 
	`csSymLškTabË
(&
m_csSymLškTabË
);

1884 
šfo
.
m_miscInfo
 = 
m_m­SymLškTabË
[
¡rDevNode
];

1885  
Œue
;

1887 
™
++;

1890  
çl£
;

1891 
	}
}

1893 
boŞ
 
	gRAIDMªag”
::
	$FÜm©
(cÚ¡ 
¡ršg
& 
mddev
)

1895 ià(
mddev
.
	`em±y
()) {

1896 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

1897 "[%d] UnknowÀMD deviû.\n", 
__LINE__
);

1898  
çl£
;

1901 
RAIDInfo
 
šfo
;

1902 ià(
	`IsMDDevInRAIDInfoLi¡
(
mddev
, 
šfo
è=ğ
m_vRAIDInfoLi¡
.
	`’d
()) {

1903 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_INFO
, 
LOG_LABEL
,

1904 "% dÛ¢'ˆexi¡.\n", 
mddev
.
	`c_¡r
());

1905  
çl£
;

1908 ià(
šfo
.
m_fsMgr
.
	`g‘
(è=ğ
NULL
) {

1909 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

1911 
mddev
.
	`c_¡r
());

1912  
çl£
;

1915 
num
 = 
	`G‘F»eVŞumeNum
();

1916 ià(
num
 < 0) {

1917 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

1919  
çl£
;

1922 
šfo
.
m_fsMgr
->
	`S‘VŞumeNum
(
num
);

1923 
šfo
.
m_fsMgr
->
	`C»©eTh»ad
();

1925  
Œue
;

1926 
	}
}

1928 
boŞ
 
	gRAIDMªag”
::
	$MouÁ
(cÚ¡ 
¡ršg
& 
mddev
)

1930 ià(
mddev
.
	`em±y
()) {

1931 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

1932 "[%d] UnknowÀMD deviû.\n", 
__LINE__
);

1933  
çl£
;

1936 
RAIDInfo
 
šfo
;

1937 ià(
	`IsMDDevInRAIDInfoLi¡
(
mddev
, 
šfo
è=ğ
m_vRAIDInfoLi¡
.
	`’d
()) {

1938 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_INFO
, 
LOG_LABEL
,

1939 "% dÛ¢'ˆexi¡.\n", 
mddev
.
	`c_¡r
());

1940  
çl£
;

1943 ià(
šfo
.
m_fsMgr
.
	`g‘
(è=ğ
NULL
) {

1944 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

1946 
mddev
.
	`c_¡r
());

1947  
çl£
;

1950 ià(!
šfo
.
m_fsMgr
->
	`IsFÜm©ed
()) {

1951 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

1953 
mddev
.
	`c_¡r
());

1954  
çl£
;

1957 
num
 = -1;

1958 ià(!
šfo
.
m_fsMgr
->
	`IsMouÁed
(
num
)) {

1959 
¡ršg
 
¡rMouÁPošt
;

1960 ià(
num
 < 0) {

1961 
num
 = 
	`G‘F»eVŞumeNum
();

1962 ià(
num
 < 0) {

1963 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

1965  
çl£
;

1967 
šfo
.
m_fsMgr
->
	`S‘VŞumeNum
(
num
);

1970 
šfo
.
m_fsMgr
->
	`IsMouÁed
(
¡rMouÁPošt
);

1971 ià(!
šfo
.
m_fsMgr
->
	`MouÁ
(
¡rMouÁPošt
)) {

1972 
	`F»eVŞumeNum
(
num
);

1973  
çl£
;

1978 
šfo
.
m_fsMgr
->
	`G’”©eUUIDFe
();

1979 
šfo
.
m_fsMgr
->
	`C»©eDeçuÉFŞd”s
();

1981  
Œue
;

1982 
	}
}

1984 
boŞ
 
	gRAIDMªag”
::
	$UnmouÁ
(cÚ¡ 
¡ršg
& 
mddev
)

1986 ià(
mddev
.
	`em±y
()) {

1987 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

1988 "[%d] UnknowÀMD deviû.\n", 
__LINE__
);

1989  
çl£
;

1992 
RAIDInfo
 
šfo
;

1993 ià(
	`IsMDDevInRAIDInfoLi¡
(
mddev
, 
šfo
è=ğ
m_vRAIDInfoLi¡
.
	`’d
()) {

1994 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_INFO
, 
LOG_LABEL
,

1995 "% dÛ¢'ˆexi¡.\n", 
mddev
.
	`c_¡r
());

1996  
çl£
;

1999 ià(
šfo
.
m_fsMgr
.
	`g‘
(è=ğ
NULL
) {

2000 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

2002 
mddev
.
	`c_¡r
());

2003  
çl£
;

2006 
num
 = -1;

2007 ià(
šfo
.
m_fsMgr
->
	`IsMouÁed
(
num
)) {

2008 ià(
šfo
.
m_fsMgr
->
	`UnmouÁ
()) {

2009 
	`F»eVŞumeNum
(
num
);

2010  
Œue
;

2013 
	`F»eVŞumeNum
(
num
);

2014  
çl£
;

2018  
Œue
;

2019 
	}
}

2021 
boŞ
 
	gRAIDMªag”
::
	$G‘FÜm©Prog»ss
(cÚ¡ 
¡ršg
& 
mddev
,

2022 & 
¡©
, & 
´og»ss
)

2024 ià(
mddev
.
	`em±y
()) {

2025 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

2026 "[%d] UnknowÀMD deviû.\n", 
__LINE__
);

2027  
çl£
;

2030 
RAIDInfo
 
šfo
;

2031 ià(
	`IsMDDevInRAIDInfoLi¡
(
mddev
, 
šfo
è=ğ
m_vRAIDInfoLi¡
.
	`’d
()) {

2032 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_INFO
, 
LOG_LABEL
,

2033 "% dÛ¢'ˆexi¡.\n", 
mddev
.
	`c_¡r
());

2034  
çl£
;

2037 ià(
šfo
.
m_fsMgr
.
	`g‘
(è=ğ
NULL
) {

2038 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

2040 
mddev
.
	`c_¡r
());

2041  
çl£
;

2044  
šfo
.
m_fsMgr
->
	`IsFÜm©šg
(
´og»ss
, 
¡©
);

2045 
	}
}

2047 
boŞ
 
	gRAIDMªag”
::
	$IsMouÁed
(cÚ¡ 
¡ršg
& 
mddev
, &
num
)

2049 ià(
mddev
.
	`em±y
()) {

2050 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

2051 "[%d] UnknowÀMD deviû.\n", 
__LINE__
);

2052  
çl£
;

2055 
RAIDInfo
 
šfo
;

2056 ià(
	`IsMDDevInRAIDInfoLi¡
(
mddev
, 
šfo
è=ğ
m_vRAIDInfoLi¡
.
	`’d
()) {

2057 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_INFO
, 
LOG_LABEL
,

2058 "% dÛ¢'ˆexi¡.\n", 
mddev
.
	`c_¡r
());

2059  
çl£
;

2062 ià(
šfo
.
m_fsMgr
.
	`g‘
(è=ğ
NULL
) {

2063 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

2065 
mddev
.
	`c_¡r
());

2066  
çl£
;

2069  
šfo
.
m_fsMgr
->
	`IsMouÁed
(
num
);

2070 
	}
}

2072 
boŞ
 
	gRAIDMªag”
::
	$IsFÜm©ed
(cÚ¡ 
¡ršg
& 
mddev
)

2074 ià(
mddev
.
	`em±y
()) {

2075 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

2076 "[%d] UnknowÀMD deviû.\n", 
__LINE__
);

2077  
çl£
;

2080 
RAIDInfo
 
šfo
;

2081 ià(
	`IsMDDevInRAIDInfoLi¡
(
mddev
, 
šfo
è=ğ
m_vRAIDInfoLi¡
.
	`’d
()) {

2082 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_INFO
, 
LOG_LABEL
,

2083 "% dÛ¢'ˆexi¡.\n", 
mddev
.
	`c_¡r
());

2084  
çl£
;

2087 ià(
šfo
.
m_fsMgr
.
	`g‘
(è=ğ
NULL
) {

2088 
	`Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, 
LOG_LABEL
,

2090 
mddev
.
	`c_¡r
());

2091  
çl£
;

2094  
šfo
.
m_fsMgr
->
	`IsFÜm©ed
();

2095 
	}
}

2097 
	gRAIDMªag”
::
	$Dump
()

2099 
	`´štf
("Used MD Number: ");

2100 
i
 = 0; i < 128; i ++)

2101 ià(
m_bU£dMD
[
i
])

2102 
	`´štf
("%d ", 
i
);

2103 
	`´štf
("\n");

2104 
	`´štf
("Used Volume Number: ");

2105 
i
 = 0; i < 128; i ++)

2106 ià(
m_bU£dVŞume
[
i
])

2107 
	`´štf
("%d ", 
i
 + 1);

2108 
	`´štf
("\n");

2109 
size_t
 
i
 = 0; i < 
m_vRAIDDiskLi¡
.
	`size
(); i++) {

2110 
m_vRAIDDiskLi¡
[
i
].
	`Dump
();

2112 
	}
}

2114 
¡ršg
 
	gRAIDMªag”
::
	$G‘DeviûNodeBySymLšk
(cÚ¡ 
¡ršg
& 
symlšk
)

2117 
¡©
 
s
;

2118 ià(
	`l¡©
(
symlšk
.
	`c_¡r
(), &
s
) >= 0) {

2119 ià(
	`S_ISLNK
(
s
.
¡_mode
) == 1) {

2120 
buf
[128];

2121 
Ën
 = 0;

2122 ià((
Ën
 = 
	`»adlšk
(
symlšk
.
	`c_¡r
(), 
buf
, (buf) - 1)) >= 0) {

2123 
¡ršg
 
¡rDevNode
 = "/dev/";

2124 
buf
[
Ën
] = '\0';

2125 
¡rDevNode
 +ğ
buf
;

2126  
¡rDevNode
;

2131  
symlšk
;

2132 
	}
}

	@RAIDManager.h

1 #iâdeà
__RAIDMANAGER_H__


2 
	#__RAIDMANAGER_H__


	)

4 #ifdeà
__ılu¥lus


7 
	~"libmdadm/mdadm.h
"

8 #ifdeà
__ılu¥lus


12 
	~"Fesy¡emMªag”.h
"

14 #ifdeà
NUUO


15 
	~"commÚ/ü™iÿl_£ùiÚ.h
"

16 
	~"commÚ/nusy¦og.h
"

17 
	~"commÚ/sm¬t_poš‹r.h
"

18 
usšg
 
Çme¥aû
 
SYSUTILS_SPACE
;

20 
	~"‹¡_uts.h
"

23 
	~<¡ršg
>

24 
	~<veùÜ
>

25 
	~<™”©Ü
>

26 
	~<memÜy
>

27 
	~<m­
>

29 
	~<¡dšt.h
>

30 
	~<sys/¡©.h
>

31 
	~<uni¡d.h
>

32 
	~<scsi/sg_cmds.h
>

33 
	~<scsi/sg_uÇligÃd.h
>

35 
usšg
 
Çme¥aû
 
	g¡d
;

37 
	eeDiskTy³
 {

38 
	mDISK_TYPE_UNKNOWN
 = -1,

39 
	mDISK_TYPE_SATA
,

40 
	mDISK_TYPE_ESATA
,

41 
	mDISK_TYPE_ISCSI
,

42 
	mDISK_TYPE_NFS


45 
	sSGS”ŸlNoPage
 {

46 
ušt8_t
 
	mm_by‹PQPDT
;

47 
ušt8_t
 
	mm_by‹PageCode
;

48 
ušt8_t
 
	mm_by‹Re£rv›d
;

49 
ušt8_t
 
	mm_by‹PageL’gth
;

50 
ušt8_t
 
	mm_by‹PageSN
[32];

53 
	sSGR—dC­ac™y10
 {

54 
ušt8_t
 
	mm_LogiÿlBlockAddr
[4];

55 
ušt8_t
 
	mm_BlockL’gth
[4];

58 
	sMiscDiskInfo
 {

59 
¡ršg
 
	mm_¡rSymLšk
;

60 
¡ršg
 
	mm_¡rMDDev
;

61 
eDiskTy³
 
	mm_diskTy³
;

63 
MiscDiskInfo
()

64 : 
m_¡rSymLšk
("")

65 , 
m_¡rMDDev
("")

66 , 
m_diskTy³
(
DISK_TYPE_UNKNOWN
)

70 
MiscDiskInfo
(cÚ¡ 
¡ršg
& 
lšk
, 
eDiskTy³
 
ty³
)

71 : 
m_¡rSymLšk
(
lšk
)

72 , 
m_¡rMDDev
("")

73 , 
m_diskTy³
(
ty³
)

77 ~
MiscDiskInfo
()

81 
	mMiscDiskInfo
& 
	mİ”©Ü
=(cÚ¡ 
MiscDiskInfo
& 
rhs
)

83 ià(
this
 =ğ&
rhs
)

84  *
this
;

86 
	mm_¡rSymLšk
 = 
rhs
.
m_¡rSymLšk
;

87 
	mm_diskTy³
 = 
rhs
.
m_diskTy³
;

88 
	mm_¡rMDDev
 = 
rhs
.
m_¡rMDDev
;

89  *
	mthis
;

92 
boŞ
 
	mİ”©Ü
==(cÚ¡ 
MiscDiskInfo
& 
rhs
)

94  (
m_¡rSymLšk
 =ğ
rhs
.m_strSymLink);

97 
Dump
()

99 
´štf
("Soft Link: %s, In RAID: %s",

100 
m_¡rSymLšk
.
c_¡r
(), 
m_¡rMDDev
.c_str());

101 
	mm_diskTy³
) {

102 
	mDISK_TYPE_UNKNOWN
:

103 
´štf
(", Type: Unknown\n");

105 
	mDISK_TYPE_SATA
:

106 
´štf
(", Type: SATA\n");

108 
	mDISK_TYPE_ESATA
:

109 
´štf
(", Type: ESATA\n");

111 
	mDISK_TYPE_ISCSI
:

112 
´štf
(", Type: iSCSI\n");

114 
	mDISK_TYPE_NFS
:

115 
´štf
(", Type: NFS\n");

121 
	sRAIDDiskInfo
 {

122 
MiscDiskInfo
 
	mm_miscInfo
;

123 
¡ršg
 
	mm_¡rS‹
;

124 
¡ršg
 
	mm_¡rDevName
;

125 
¡ršg
 
	mm_¡rV’dÜ
;

126 
¡ršg
 
	mm_¡rMod–
;

127 
¡ršg
 
	mm_¡rFœmw¬eV”siÚ
;

128 
¡ršg
 
	mm_¡rS”ŸlNum
;

129 
št64_t
 
	mm_ÎC­ac™y
;

130 
št32_t
 
	mm_RaidUUID
[4];

131 
št32_t
 
	mm_iS‹
;

132 
št32_t
 
	mm_iRaidDiskNum
;

133 
št32_t
 
	mm_iMajÜ
;

134 
št32_t
 
	mm_iMšÜ
;

135 
boŞ
 
	mm_bHasMDSB
;

137 
RAIDDiskInfo
()

138 : 
m_¡rS‹
("")

139 , 
m_¡rDevName
("")

140 , 
m_¡rV’dÜ
("")

141 , 
m_¡rMod–
("")

142 , 
m_¡rFœmw¬eV”siÚ
("")

143 , 
m_¡rS”ŸlNum
("")

144 , 
m_ÎC­ac™y
(0ll)

145 , 
m_iS‹
(0)

146 , 
m_iRaidDiskNum
(0)

147 , 
m_iMajÜ
(0)

148 , 
m_iMšÜ
(0)

149 , 
m_bHasMDSB
(
çl£
)

151 
mem£t
(
m_RaidUUID
, 0x00, (m_RaidUUID));

154 ~
RAIDDiskInfo
() {}

156 
	mRAIDDiskInfo
& 
	mİ”©Ü
=(cÚ¡ 
¬¿y_disk_šfo
& 
rhs
)

158 
m_¡rS‹
 = 
rhs
.
¡rS‹
;

159 
	mm_¡rDevName
 = 
rhs
.
¡rDevName
;

160 
	mm_iS‹
 = 
rhs
.
diskInfo
.
¡©e
;

161 
	mm_iRaidDiskNum
 = 
rhs
.
diskInfo
.
¿id_disk
;

162 
	mm_iMajÜ
 = 
rhs
.
diskInfo
.
majÜ
;

163 
	mm_iMšÜ
 = 
rhs
.
diskInfo
.
mšÜ
;

164 
S‘HDDV’dÜInfom©iÚ
();

165  *
	mthis
;

168 
Dump
()

170 
´štf
("Device: %s, State: %s, MD Super Block: %s, Major: %d, Minor: %d\n\t",

171 
m_¡rDevName
.
c_¡r
(), 
m_¡rS‹
.c_¡r(), 
m_bHasMDSB
 ? "Yes" : "No",

172 
m_iMajÜ
, 
m_iMšÜ
);

173 
	mm_miscInfo
.
Dump
();

176 
S‘HDDV’dÜInfom©iÚ
() {

177 ià(
	mm_¡rDevName
.
em±y
())

180 
sg_sim¶e_šquœy_»¥
 
	m»¥
;

181 
SGS”ŸlNoPage
 
	msg_¢_»¥
;

182 
SGR—dC­ac™y10
 
	msg_»adÿp10_»¥
;

183 
	msg_fd
 = 
sg_cmds_İ’_deviû
(
m_¡rDevName
.
c_¡r
(), 1, 1);

185 ià(
	msg_fd
 < 0)

188 ià(0 =ğ
sg_sim¶e_šquœy
(
sg_fd
, &
»¥
, 0, 0)) {

189 
	mm_¡rV’dÜ
 = 
»¥
.
v’dÜ
;

190 
	mm_¡rMod–
 = 
»¥
.
´oduù
;

191 
	mm_¡rFœmw¬eV”siÚ
 = 
»¥
.
»visiÚ
;

198 ià(0 =ğ
sg_Î_šquœy
(
sg_fd
, 0 ,1 , 0x80,

199 (*)&
sg_¢_»¥
,

200 (
SGS”ŸlNoPage
),

202 
	mm_¡rS”ŸlNum
 = (*)
sg_¢_»¥
.
m_by‹PageSN
;

209 ià(0 =ğ
sg_Î_»adÿp_10
(
sg_fd
, 0, 1,

210 &
sg_»adÿp10_»¥
,

211 (
SGR—dC­ac™y10
),

213 
ušt32_t
 
	mÏ¡_blk_addr
 = 0, 
	mblock_size
 = 0;

214 
	mÏ¡_blk_addr
 = 
sg_g‘_uÇligÃd_be32
(&(
sg_»adÿp10_»¥
.
m_LogiÿlBlockAddr
));

215 ià(0xfffffffà!ğ
Ï¡_blk_addr
) {

216 
block_size
 = 
sg_g‘_uÇligÃd_be32
(&(
sg_»adÿp10_»¥
.
m_BlockL’gth
));

217 
	mm_ÎC­ac™y
 = (
Ï¡_blk_addr
 + 1è* 
block_size
;

225 
sg_cmds_şo£_deviû
(
sg_fd
);

228 
	mRAIDDiskInfo
& 
	mİ”©Ü
=(cÚ¡ 
RAIDDiskInfo
& 
rhs
)

230 ià(
this
 =ğ&
rhs
)

231  *
this
;

232 
	mm_¡rS‹
 = 
rhs
.
m_¡rS‹
;

233 
	mm_¡rDevName
 = 
rhs
.
m_¡rDevName
;

234 
	mm_iS‹
 = 
rhs
.
m_iS‹
;

235 
	mm_iRaidDiskNum
 = 
rhs
.
m_iRaidDiskNum
;

236 
	mm_bHasMDSB
 = 
rhs
.
m_bHasMDSB
;

237 
	mm_iMajÜ
 = 
rhs
.
m_iMajÜ
;

238 
	mm_iMšÜ
 = 
rhs
.
m_iMšÜ
;

239 
S‘HDDV’dÜInfom©iÚ
();

240  *
	mthis
;

243 
boŞ
 
	mİ”©Ü
==(cÚ¡ 
RAIDDiskInfo
& 
rhs
) const

245  (
m_¡rDevName
 =ğ
rhs
.m_strDevName);

248 
boŞ
 
	mİ”©Ü
==(cÚ¡ 
¡ršg
& 
rhs
) const

250  (
rhs
 =ğ
m_¡rDevName
);

254 
	sRAIDInfo
 {

255 
	msm¬t_±r
<
	mFesy¡emMªag”
> 
	mm_fsMgr
;

256 
	mveùÜ
<
	mRAIDDiskInfo
> 
	mm_vDiskLi¡
;

257 
¡ršg
 
	mm_¡rDevNodeName
;

258 
¡ršg
 
	mm_¡rS‹
;

259 
¡ršg
 
	mm_¡rLayout
;

260 
¡ršg
 
	mm_¡rRebudšgO³¿tiÚ
;

261 
time_t
 
	mm_C»©iÚTime
;

262 
time_t
 
	mm_Upd©eTime
;

263 
ušt32_t
 
	mm_UUID
[4];

264 
št64_t
 
	mm_uÎTÙ®C­ac™y
;

265 
št64_t
 
	mm_uÎU£dSize
;

266 
št32_t
 
	mm_iRAIDLev–
;

267 
št32_t
 
	mm_iTÙ®DiskNum
;

268 
št32_t
 
	mm_iRAIDDiskNum
;

269 
št32_t
 
	mm_iAùiveDiskNum
;

270 
št32_t
 
	mm_iWÜkšgDiskNum
;

271 
št32_t
 
	mm_iFaedDiskNum
;

272 
št32_t
 
	mm_iS·»DiskNum
;

273 
št32_t
 
	mm_iS‹
;

274 
št32_t
 
	mm_iChunkSize
;

275 
št32_t
 
	mm_iRebudšgProg»ss
;

276 
št32_t
 
	mm_iMDNum
;

277 
boŞ
 
	mm_bSu³rBlockP”si¡’t
;

278 
boŞ
 
	mm_bIÇùive
;

279 
boŞ
 
	mm_bRebudšg
;

281 
RAIDInfo
()

282 : 
m_fsMgr
(
NULL
)

283 , 
m_¡rDevNodeName
("")

284 , 
m_¡rS‹
("")

285 , 
m_¡rLayout
("")

286 , 
m_¡rRebudšgO³¿tiÚ
("")

287 , 
m_C»©iÚTime
(0)

288 , 
m_Upd©eTime
(0)

289 , 
m_uÎTÙ®C­ac™y
(0ull)

290 , 
m_uÎU£dSize
(0ull)

291 , 
m_iRAIDLev–
(
UnS‘
)

292 , 
m_iTÙ®DiskNum
(0)

293 , 
m_iRAIDDiskNum
(0)

294 , 
m_iAùiveDiskNum
(0)

295 , 
m_iWÜkšgDiskNum
(0)

296 , 
m_iFaedDiskNum
(0)

297 , 
m_iS·»DiskNum
(0)

298 , 
m_iS‹
(0)

299 , 
m_iChunkSize
(512)

300 , 
m_iRebudšgProg»ss
(-1)

301 , 
m_iMDNum
(-1)

302 , 
m_bSu³rBlockP”si¡’t
(
çl£
)

303 , 
m_bIÇùive
(
çl£
)

304 , 
m_bRebudšg
(
çl£
)

306 
	mi
 = 0; i < 4; i ++)

307 
	mm_UUID
[
i
] = 0;

310 ~
RAIDInfo
() {

311 
	mm_fsMgr
 = 
NULL
;

314 
boŞ
 
In™ŸlizeFSMªag”
() {

315 
	mŒy
 {

316 
	mm_fsMgr
 = 
Ãw
 
Fesy¡emMªag”
;

317 ià(!
	mm_fsMgr
->
S‘DeviûNode
(
m_¡rDevNodeName
)) {

318 
Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, "RAIDInfo",

320  
	mçl£
;

322 } 
ÿtch
 (
bad_®loc
&) {

323 
	mm_fsMgr
 = 
NULL
;

324 
Wr™eHWLog
(
LOG_LOCAL0
, 
LOG_ERR
, "RAIDInfo",

326  
	mçl£
;

329  
	mŒue
;

332 
	mRAIDInfo
& 
	mİ”©Ü
=(cÚ¡ 
¬¿y_d‘a
& 
rhs
)

334 
m_vDiskLi¡
.
ş—r
();

335 
	mi
 = 0; i < 
	mrhs
.
	m¬¿yInfo
.
	mÄ_disks
; i++) {

336 
RAIDDiskInfo
 
	mšfo
;

337 ià(
	mrhs
.
	m¬¿yDisks
[
i
].
	mdiskInfo
.
	mmajÜ
 == 0 &&

338 
rhs
.
¬¿yDisks
[
i
].
diskInfo
.
mšÜ
 == 0)

341 
	mšfo
 = 
rhs
.
¬¿yDisks
[
i
];

342 
	mm_vDiskLi¡
.
push_back
(
šfo
);

345 
	mm_¡rS‹
 = 
rhs
.
¡rA¼ayS‹
;

346 
	mm_¡rLayout
 = 
rhs
.
¡rRaidLayout
;

347 
	mm_¡rRebudšgO³¿tiÚ
 = 
rhs
.
¡rRebudO³¿tiÚ
;

348 
	mm_¡rDevNodeName
 = 
rhs
.
¡rA¼ayDevName
;

349 
memıy
(
m_UUID
, 
rhs
.
uuid
, (m_UUID));

350 
	mm_uÎTÙ®C­ac™y
 = 
rhs
.
uÎA¼aySize
;

351 
	mm_uÎU£dSize
 = 
rhs
.
uÎU£dSize
;

352 
	mm_iRAIDLev–
 = 
rhs
.
¬¿yInfo
.
Ëv–
;

353 
	mm_iTÙ®DiskNum
 = 
rhs
.
¬¿yInfo
.
Ä_disks
;

354 
	mm_iRAIDDiskNum
 = 
rhs
.
¬¿yInfo
.
¿id_disks
;

355 
	mm_iAùiveDiskNum
 = 
rhs
.
¬¿yInfo
.
aùive_disks
;

356 
	mm_iWÜkšgDiskNum
 = 
rhs
.
¬¿yInfo
.
wÜkšg_disks
;

357 
	mm_iFaedDiskNum
 = 
rhs
.
¬¿yInfo
.
çed_disks
;

358 
	mm_iS·»DiskNum
 = 
rhs
.
¬¿yInfo
.
¥¬e_disks
;

359 
	mm_iS‹
 = 
rhs
.
¬¿yInfo
.
¡©e
;

360 
	mm_iChunkSize
 = 
rhs
.
¬¿yInfo
.
chunk_size
;

361 
	mm_iRebudšgProg»ss
 = 
rhs
.
iRebudProg»ss
;

362 
	mm_bRebudšg
 = 
rhs
.
bIsRebudšg
 =ğ1 ? 
Œue
 : 
çl£
;

363 
	mm_bIÇùive
 = 
rhs
.
bIÇùive
 =ğ1 ? 
Œue
 : 
çl£
;

364 
	mm_bSu³rBlockP”si¡’t
 = 
rhs
.
bIsSu³rBlockP”si¡’t
 =ğ1 ? 
Œue
 : 
çl£
;

365 
	mm_C»©iÚTime
 = 
rhs
.
¬¿yInfo
.
ùime
;

366 
	mm_Upd©eTime
 = 
rhs
.
¬¿yInfo
.
utime
;

368  *
	mthis
;

371 
	mRAIDInfo
& 
	mİ”©Ü
=(cÚ¡ 
RAIDInfo
& 
rhs
)

373 ià(
this
 =ğ&
rhs
)

374  *
this
;

376 
	mm_vDiskLi¡
.
ş—r
();

377 
size_t
 
	mi
 = 0; i < 
	mrhs
.
	mm_vDiskLi¡
.
size
(); i++) {

378 
	mm_vDiskLi¡
.
push_back
(
rhs
.
m_vDiskLi¡
[
i
]);

381 
	mm_¡rS‹
 = 
rhs
.
m_¡rS‹
;

382 
	mm_¡rLayout
 = 
rhs
.
m_¡rLayout
;

383 
	mm_¡rRebudšgO³¿tiÚ
 = 
rhs
.
m_¡rRebudšgO³¿tiÚ
;

384 
	mm_¡rDevNodeName
 = 
rhs
.
m_¡rDevNodeName
;

385 
memıy
(
m_UUID
, 
rhs
.m_UUID, (m_UUID));

386 
	mm_uÎTÙ®C­ac™y
 = 
rhs
.
m_uÎTÙ®C­ac™y
;

387 
	mm_uÎU£dSize
 = 
rhs
.
m_uÎU£dSize
;

388 
	mm_iRAIDLev–
 = 
rhs
.
m_iRAIDLev–
;

389 
	mm_iTÙ®DiskNum
 = 
rhs
.
m_iTÙ®DiskNum
;

390 
	mm_iRAIDDiskNum
 = 
rhs
.
m_iRAIDDiskNum
;

391 
	mm_iAùiveDiskNum
 = 
rhs
.
m_iAùiveDiskNum
;

392 
	mm_iWÜkšgDiskNum
 = 
rhs
.
m_iWÜkšgDiskNum
;

393 
	mm_iFaedDiskNum
 = 
rhs
.
m_iFaedDiskNum
;

394 
	mm_iS·»DiskNum
 = 
rhs
.
m_iS·»DiskNum
;

395 
	mm_iS‹
 = 
rhs
.
m_iS‹
;

396 
	mm_iChunkSize
 = 
rhs
.
m_iChunkSize
;

397 
	mm_iRebudšgProg»ss
 = 
rhs
.
m_iRebudšgProg»ss
;

398 
	mm_bRebudšg
 = 
rhs
.
m_bRebudšg
;

399 
	mm_bIÇùive
 = 
rhs
.
m_bIÇùive
;

400 
	mm_bSu³rBlockP”si¡’t
 = 
rhs
.
m_bSu³rBlockP”si¡’t
;

401 
	mm_C»©iÚTime
 = 
rhs
.
m_C»©iÚTime
;

402 
	mm_Upd©eTime
 = 
rhs
.
m_Upd©eTime
;

403 
	mm_fsMgr
 = 
rhs
.
m_fsMgr
;

404 
	mm_iMDNum
 = 
rhs
.
m_iMDNum
;

406  *
	mthis
;

409 
boŞ
 
	mİ”©Ü
==(cÚ¡ 
RAIDInfo
& 
rhs
) const

411  (
m_¡rDevNodeName
 =ğ
rhs
.m_strDevNodeName &&

412 0 =ğ
memcmp
(
rhs
.
m_UUID
, m_UUID, (m_UUID)));

415 
boŞ
 
	mİ”©Ü
==(cÚ¡ 
¡ršg
& 
rhs
) const

417  (
m_¡rDevNodeName
 =ğ
rhs
);

420 
boŞ
 
IsRAIDStusChªged
(cÚ¡ 
RAIDInfo
& 
´evious
) {

421  !(
	mm_Upd©eTime
 =ğ
´evious
.
m_Upd©eTime
 &&

422 
m_iFaedDiskNum
 =ğ
´evious
.m_iFailedDiskNum &&

423 
m_iWÜkšgDiskNum
 =ğ
´evious
.m_iWorkingDiskNum &&

424 
m_iS·»DiskNum
 =ğ
´evious
.m_iSpareDiskNum);

427 
Dump
()

429 
´štf
("Device: %s\n"

435 
m_¡rDevNodeName
.
c_¡r
(), 
m_¡rS‹
.c_str(),

436 
m_iRAIDLev–
, 
m_iChunkSize
,

437 
m_uÎTÙ®C­ac™y
, 
m_uÎU£dSize
,

438 
m_iTÙ®DiskNum
, 
m_iRAIDDiskNum
, 
m_iAùiveDiskNum
,

439 
m_iWÜkšgDiskNum
, 
m_iFaedDiskNum
, 
m_iS·»DiskNum
,

440 
ùime
(&
m_C»©iÚTime
), ctime(&
m_Upd©eTime
),

441 
m_bRebudšg
?"Yes":"No", (
m_iRebudšgProg»ss
 < 0)?100:m_iRebuildingProgress

444 ià(
	mm_fsMgr
.
g‘
(è!ğ
NULL
)

445 
m_fsMgr
->
Dump
();

446 
´štf
("\n");

448 
size_t
 
	mi
 =0 ; i < 
	mm_vDiskLi¡
.
size
(); i++) {

449 
´štf
("\t");

450 
	mm_vDiskLi¡
[
i
].
Dump
();

452 
´štf
("\n");

456 şas 
	cRAIDMªag”
 {

457 
	m´iv©e
:

458 
veùÜ
<
RAIDInfo
> 
m_vRAIDInfoLi¡
;

459 
	mveùÜ
<
	mRAIDDiskInfo
> 
	mm_vRAIDDiskLi¡
;

460 
	mm­
<
	m¡ršg
, 
	mMiscDiskInfo
> 
	mm_m­SymLškTabË
;

462 #ifdeà
NUUO


463 
Cr™iÿlSeùiÚ
 
	mm_csRAIDInfoLi¡
;

464 
Cr™iÿlSeùiÚ
 
	mm_csRAIDDiskLi¡
;

465 
Cr™iÿlSeùiÚ
 
	mm_csU£dMD
;

466 
Cr™iÿlSeùiÚ
 
	mm_csU£dVŞume
;

467 
Cr™iÿlSeùiÚ
 
	mm_csSymLškTabË
;

470 
boŞ
 
	mm_bU£dMD
[128];

471 
boŞ
 
	mm_bU£dVŞume
[128];

473 
	m´iv©e
:

474 
veùÜ
<
RAIDInfo
>::
™”©Ü
 
S—rchDiskB–Úg2RAID
(
RAIDDiskInfo
& 
devInfo
);

476 
In™ŸlizeSh­e
(
sh­e
& 
s
, 
¿iddisks
, 
Ëv–
, 
chunk
 = 512, 
b™m­_chunk
 = 
UnS‘
, * 
b™m­_fe
 = 
NULL
);

477 #ifdeà
DEBUG


478 
In™ŸlizeCÚ‹xt
(
cÚ‹xt
& 
c
, 
fÜû
 = 1, 
run¡İ
 = 1, 
v”bo£
 = 1);

480 
In™ŸlizeCÚ‹xt
(
cÚ‹xt
& 
c
, 
fÜû
 = 1, 
run¡İ
 = 1, 
v”bo£
 = 0);

482 
In™ŸlizeMDDevId’t
(
mddev_id’t
& 
id’t
, 
uuid_£t
, cÚ¡ 
uuid
[4], 
b™m­_fd
 = -1, * 
b™m­_fe
 = 
NULL
);

483 
mddev_dev
* 
In™ŸlizeDevLi¡
(
veùÜ
<
¡ršg
>& 
devNameLi¡
, 
di¥os™iÚ
 = 0);

484 
mddev_dev
* 
In™ŸlizeDevLi¡
(cÚ¡ 
¡ršg
& 
»¶aû
, cÚ¡ sŒšg& 
w™h
);

485 
F»eDevLi¡
(
mddev_dev
* 
devli¡
);

486 
O³nMDDev
(cÚ¡ 
¡ršg
& 
mddev
);

488 
C»©eRAID
(cÚ¡ & 
mdnum
, 
¡ršg
& 
mddev
, 
veùÜ
<¡ršg>& 
vDevLi¡
, 
Ëv–
);

489 
C»©eRAID
(cÚ¡ 
¡ršg
& 
mddev
, 
veùÜ
<¡ršg>& 
vDevLi¡
, 
Ëv–
);

490 
As£mbËRAID
(cÚ¡ & 
mdnum
, 
¡ršg
& 
mddev
, cÚ¡ 
uuid
[4]);

491 
As£mbËRAID
(cÚ¡ 
¡ršg
& 
mddev
, cÚ¡ 
uuid
[4]);

492 
As£mbËRAID
(cÚ¡ & 
mdnum
, 
¡ršg
& 
mddev
, 
veùÜ
<¡ršg>& 
vDevLi¡
);

493 
As£mbËRAID
(cÚ¡ 
¡ršg
& 
mddev
, 
veùÜ
<¡ršg>& 
vDevLi¡
);

494 
G‘F»eMDNum
();

495 
F»eMDNum
(
n
);

496 
S‘MDNum
(
n
);

497 
G‘F»eVŞumeNum
();

498 
F»eVŞumeNum
(
n
);

499 
S‘VŞumeNum
(
n
);

501 
Upd©eRAIDDiskLi¡
(
veùÜ
<
RAIDDiskInfo
>& 
vRAIDDiskInfoLi¡
);

502 
boŞ
 
MªageRAIDSubdevs
(cÚ¡ 
¡ršg
& 
mddev
, 
veùÜ
<¡ršg>& 
vDevLi¡
, 
İ”©iÚ
);

503 
	mveùÜ
<
	mRAIDInfo
>::
™”©Ü
 
IsMDDevInRAIDInfoLi¡
(cÚ¡ 
¡ršg
 &
mddev
);

504 
	mveùÜ
<
	mRAIDInfo
>::
™”©Ü
 
IsMDDevInRAIDInfoLi¡
(cÚ¡ 
¡ršg
 &
mddev
, 
RAIDInfo
& 
šfo
);

505 
boŞ
 
IsDiskExi¡InRAIDDiskLi¡
(cÚ¡ 
¡ršg
& 
dev
);

506 
boŞ
 
IsDiskExi¡InRAIDDiskLi¡
(
veùÜ
<
¡ršg
>& 
vDevLi¡
);

507 
¡ršg
 
G’”©eMDDevName
(
num
);

508 
G’”©eVŞumeName
(
¡ršg
& 
Çme
);

510 
boŞ
 
IsDiskHaveMDSu³rBlock
(cÚ¡ 
¡ršg
& 
dev
, 
examše_»suÉ
 &
»suÉ
, &
”r
);

512 
	mpublic
:

513 
RAIDMªag”
();

514 ~
RAIDMªag”
();

516 
boŞ
 
AddDiskSymLšk
(cÚ¡ 
¡ršg
& 
symlšk
, 
eDiskTy³
 
ty³
);

517 
boŞ
 
RemoveDiskSymLšk
(cÚ¡ 
¡ršg
& 
symlšk
);

518 
boŞ
 
AddDisk
(cÚ¡ 
¡ršg
& 
dev
);

519 
boŞ
 
RemoveDisk
(cÚ¡ 
¡ršg
& 
dev
);

521 
boŞ
 
C»©eRAID
(
veùÜ
<
¡ršg
>& 
vDevLi¡
, 
Ëv–
, sŒšg& 
¡rMDName
);

522 
boŞ
 
As£mbËRAID
(cÚ¡ 
uuid
[4], 
¡ršg
& 
¡rMDName
);

523 
boŞ
 
As£mbËRAID
(
veùÜ
<
¡ršg
>& 
vDevLi¡
, sŒšg& 
¡rMDName
);

524 
boŞ
 
RemoveMDDisks
(cÚ¡ 
¡ršg
& 
mddev
, 
veùÜ
<¡ršg>& 
vDevLi¡
);

525 
boŞ
 
M¬kFauÉyMDDisks
(cÚ¡ 
¡ršg
& 
mddev
, 
veùÜ
<¡ršg>& 
vDevLi¡
);

526 
boŞ
 
AddMDDisks
(cÚ¡ 
¡ršg
& 
mddev
, 
veùÜ
<¡ršg>& 
vDevLi¡
);

527 
boŞ
 
R—ddMDDisks
(cÚ¡ 
¡ršg
& 
mddev
, 
veùÜ
<¡ršg>& 
vDevLi¡
);

528 
boŞ
 
R•ÏûMDDisk
(cÚ¡ 
¡ršg
& 
mddev
, cÚ¡ sŒšg& 
»¶aû
, cÚ¡ sŒšg& 
w™h
);

529 
boŞ
 
D–‘eRAID
(cÚ¡ 
¡ršg
& 
mddev
);

530 
boŞ
 
StİRAID
(cÚ¡ 
¡ršg
& 
mddev
);

532 
boŞ
 
G‘RAIDInfo
(cÚ¡ 
¡ršg
& 
mddev
, 
RAIDInfo
& 
šfo
);

533 
G‘RAIDInfo
(
veùÜ
<
RAIDInfo
>& 
li¡
);

534 
G‘DisksInfo
(
veùÜ
<
RAIDDiskInfo
> &
li¡
);

535 
boŞ
 
G‘DisksInfo
(cÚ¡ 
¡ršg
& 
dev
, 
RAIDDiskInfo
 &
šfo
);

536 
boŞ
 
G‘DisksInfoBySymLšk
(cÚ¡ 
¡ršg
& 
lšk
, 
RAIDDiskInfo
 &
šfo
);

537 
boŞ
 
G‘DisksInfoBySymLšk
(
veùÜ
<
RAIDDiskInfo
> &
li¡
);

539 
boŞ
 
Upd©eRAIDInfo
();

540 
boŞ
 
Upd©eRAIDInfo
(cÚ¡ 
¡ršg
& 
mddev
, 
mdnum
 = -1);

541 
boŞ
 
Upd©eRAIDInfo
(cÚ¡ 
uuid
[4]);

543 
boŞ
 
CheckFeSy¡em
();

544 
boŞ
 
DoFeSy¡emRecov”y
();

545 
boŞ
 
G‘FeSy¡emStus
();

547 
boŞ
 
FÜm©
(cÚ¡ 
¡ršg
& 
mddev
);

548 
boŞ
 
MouÁ
(cÚ¡ 
¡ršg
& 
mddev
);

549 
boŞ
 
UnmouÁ
(cÚ¡ 
¡ršg
& 
mddev
);

550 
boŞ
 
G‘FÜm©Prog»ss
(cÚ¡ 
¡ršg
& 
mddev
,

551 & 
¡©
, & 
´og»ss
);

552 
boŞ
 
IsMouÁed
(cÚ¡ 
¡ršg
& 
mddev
, &
num
);

553 
boŞ
 
IsFÜm©ed
(cÚ¡ 
¡ršg
& 
mddev
);

555 
Dump
();

557 
¡ršg
 
G‘DeviûNodeBySymLšk
(cÚ¡ sŒšg& 
symlšk
);

	@build/CMakeFiles/2.8.12.2/CompilerIdCXX/CMakeCXXCompilerId.cpp

4 #iâdeà
__ılu¥lus


11 #ià
defšed
(
__COMO__
)

12 
	#COMPILER_ID
 "Com—u"

	)

14 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__COMO_VERSION__
 / 100)

	)

15 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__COMO_VERSION__
 % 100)

	)

17 #–ià
defšed
(
__INTEL_COMPILER
è|| defšed(
__ICC
)

18 
	#COMPILER_ID
 "IÁ–"

	)

20 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__INTEL_COMPILER
/100)

	)

21 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__INTEL_COMPILER
/10 % 10)

	)

22 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__INTEL_COMPILER
 % 10)

	)

23 #ià
defšed
(
__INTEL_COMPILER_BUILD_DATE
)

25 
	#COMPILER_VERSION_TWEAK
 
	`DEC
(
__INTEL_COMPILER_BUILD_DATE
)

	)

28 #–ià
defšed
(
__PATHCC__
)

29 
	#COMPILER_ID
 "P©hSÿË"

	)

30 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__PATHCC__
)

	)

31 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__PATHCC_MINOR__
)

	)

32 #ià
defšed
(
__PATHCC_PATCHLEVEL__
)

33 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__PATHCC_PATCHLEVEL__
)

	)

36 #–ià
defšed
(
__şªg__
)

37 
	#COMPILER_ID
 "CÏng"

	)

38 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__şªg_majÜ__
)

	)

39 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__şªg_mšÜ__
)

	)

40 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__şªg_·tchËv–__
)

	)

42 #–ià
defšed
(
__BORLANDC__
è&& defšed(
__CODEGEARC_VERSION__
)

43 
	#COMPILER_ID
 "Emb¬ÿd”o"

	)

44 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__CODEGEARC_VERSION__
>>24 & 0x00FF)

	)

45 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__CODEGEARC_VERSION__
>>16 & 0x00FF)

	)

46 
	#COMPILER_VERSION_PATCH
 
	`HEX
(
__CODEGEARC_VERSION__
 & 0xFFFF)

	)

48 #–ià
defšed
(
__BORLANDC__
)

49 
	#COMPILER_ID
 "BÜÏnd"

	)

51 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__BORLANDC__
>>8)

	)

52 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__BORLANDC__
 & 0xFF)

	)

54 #–ià
defšed
(
__WATCOMC__
)

55 
	#COMPILER_ID
 "W©com"

	)

57 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__WATCOMC__
 / 100)

	)

58 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__WATCOMC__
 % 100)

	)

60 #–ià
defšed
(
__SUNPRO_CC
)

61 
	#COMPILER_ID
 "SunPro"

	)

62 #ià
__SUNPRO_CC
 >= 0x5100

64 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__SUNPRO_CC
>>12)

	)

65 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__SUNPRO_CC
>>4 & 0xFF)

	)

66 
	#COMPILER_VERSION_PATCH
 
	`HEX
(
__SUNPRO_CC
 & 0xF)

	)

69 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__SUNPRO_CC
>>8)

	)

70 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__SUNPRO_CC
>>4 & 0xF)

	)

71 
	#COMPILER_VERSION_PATCH
 
	`HEX
(
__SUNPRO_CC
 & 0xF)

	)

74 #–ià
defšed
(
__HP_aCC
)

75 
	#COMPILER_ID
 "HP"

	)

77 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__HP_aCC
/10000)

	)

78 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__HP_aCC
/100 % 100)

	)

79 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__HP_aCC
 % 100)

	)

81 #–ià
defšed
(
__DECCXX
)

82 
	#COMPILER_ID
 "Com·q"

	)

84 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__DECCXX_VER
/10000000)

	)

85 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__DECCXX_VER
/100000 % 100)

	)

86 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__DECCXX_VER
 % 10000)

	)

88 #–ià
defšed
(
__IBMCPP__
)

89 #ià
defšed
(
__COMPILER_VER__
)

90 
	#COMPILER_ID
 "zOS"

	)

92 #ià
__IBMCPP__
 >= 800

93 
	#COMPILER_ID
 "XL"

	)

95 
	#COMPILER_ID
 "Visu®Age"

	)

98 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__IBMCPP__
/100)

	)

99 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__IBMCPP__
/10 % 10)

	)

100 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__IBMCPP__
 % 10)

	)

103 #–ià
defšed
(
__PGI
)

104 
	#COMPILER_ID
 "PGI"

	)

105 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__PGIC__
)

	)

106 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__PGIC_MINOR__
)

	)

107 #ià
defšed
(
__PGIC_PATCHLEVEL__
)

108 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__PGIC_PATCHLEVEL__
)

	)

111 #–ià
defšed
(
_CRAYC
)

112 
	#COMPILER_ID
 "C¿y"

	)

113 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
_RELEASE
)

	)

114 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
_RELEASE_MINOR
)

	)

116 #–ià
defšed
(
__TI_COMPILER_VERSION__
)

117 
	#COMPILER_ID
 "TI"

	)

119 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__TI_COMPILER_VERSION__
/1000000)

	)

120 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__TI_COMPILER_VERSION__
/1000 % 1000)

	)

121 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__TI_COMPILER_VERSION__
 % 1000)

	)

123 #–ià
defšed
(
__SCO_VERSION__
)

124 
	#COMPILER_ID
 "SCO"

	)

126 #–ià
defšed
(
__GNUC__
)

127 
	#COMPILER_ID
 "GNU"

	)

128 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__GNUC__
)

	)

129 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__GNUC_MINOR__
)

	)

130 #ià
defšed
(
__GNUC_PATCHLEVEL__
)

131 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__GNUC_PATCHLEVEL__
)

	)

134 #–ià
defšed
(
_MSC_VER
)

135 
	#COMPILER_ID
 "MSVC"

	)

137 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
_MSC_VER
 / 100)

	)

138 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
_MSC_VER
 % 100)

	)

139 #ià
defšed
(
_MSC_FULL_VER
)

140 #ià
_MSC_VER
 >= 1400

142 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
_MSC_FULL_VER
 % 100000)

	)

145 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
_MSC_FULL_VER
 % 10000)

	)

148 #ià
defšed
(
_MSC_BUILD
)

149 
	#COMPILER_VERSION_TWEAK
 
	`DEC
(
_MSC_BUILD
)

	)

153 #–ià
defšed
(
__VISUALDSPVERSION__
)

154 
	#COMPILER_ID
 "ADSP"

	)

156 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__VISUALDSPVERSION__
>>24)

	)

157 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__VISUALDSPVERSION__
>>16 & 0xFF)

	)

158 
	#COMPILER_VERSION_PATCH
 
	`HEX
(
__VISUALDSPVERSION__
>>8 & 0xFF)

	)

161 #–ià
defšed
(
__ADSPBLACKFIN__
è|| defšed(
__ADSPTS__
è|| defšed(
__ADSP21000__
)

162 
	#COMPILER_ID
 "ADSP"

	)

166 #–ià
defšed
(
__IAR_SYSTEMS_ICC__
 ) || defšed(
__IAR_SYSTEMS_ICC
)

167 
	#COMPILER_ID
 "IAR"

	)

169 #–ià
defšed
(
_SGI_COMPILER_VERSION
è|| defšed(
_COMPILER_VERSION
)

170 
	#COMPILER_ID
 "MIPS´o"

	)

171 #ià
defšed
(
_SGI_COMPILER_VERSION
)

173 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
_SGI_COMPILER_VERSION
/100)

	)

174 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
_SGI_COMPILER_VERSION
/10 % 10)

	)

175 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
_SGI_COMPILER_VERSION
 % 10)

	)

178 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
_COMPILER_VERSION
/100)

	)

179 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
_COMPILER_VERSION
/10 % 10)

	)

180 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
_COMPILER_VERSION
 % 10)

	)

186 #–ià
defšed
(
__sgi
)

187 
	#COMPILER_ID
 "MIPS´o"

	)

189 #–ià
defšed
(
__hpux
è|| defšed(
__hpua
)

190 
	#COMPILER_ID
 "HP"

	)

193 
	#COMPILER_ID
 ""

	)

201 cÚ¡* 
	gšfo_comp”
 = "INFO" ":" "comp”[" 
COMPILER_ID
 "]";

204 #ià
defšed
(
__lšux
è|| defšed(
__lšux__
è|| defšed(
lšux
)

205 
	#PLATFORM_ID
 "Lšux"

	)

207 #–ià
defšed
(
__CYGWIN__
)

208 
	#PLATFORM_ID
 "Cygwš"

	)

210 #–ià
defšed
(
__MINGW32__
)

211 
	#PLATFORM_ID
 "MšGW"

	)

213 #–ià
defšed
(
__APPLE__
)

214 
	#PLATFORM_ID
 "D¬wš"

	)

216 #–ià
defšed
(
_WIN32
è|| defšed(
__WIN32__
è|| defšed(
WIN32
)

217 
	#PLATFORM_ID
 "Wšdows"

	)

219 #–ià
defšed
(
__F»eBSD__
è|| defšed(
__F»eBSD
)

220 
	#PLATFORM_ID
 "F»eBSD"

	)

222 #–ià
defšed
(
__N‘BSD__
è|| defšed(
__N‘BSD
)

223 
	#PLATFORM_ID
 "N‘BSD"

	)

225 #–ià
defšed
(
__O³nBSD__
è|| defšed(
__OPENBSD
)

226 
	#PLATFORM_ID
 "O³nBSD"

	)

228 #–ià
defšed
(
__sun
è|| defšed(
sun
)

229 
	#PLATFORM_ID
 "SunOS"

	)

231 #–ià
defšed
(
_AIX
è|| defšed(
__AIX
è|| defšed(
__AIX__
è|| defšed(
__aix
è|| defšed(
__aix__
)

232 
	#PLATFORM_ID
 "AIX"

	)

234 #–ià
defšed
(
__sgi
è|| defšed(
__sgi__
è|| defšed(
_SGI
)

235 
	#PLATFORM_ID
 "IRIX"

	)

237 #–ià
defšed
(
__hpux
è|| defšed(
__hpux__
)

238 
	#PLATFORM_ID
 "HP-UX"

	)

240 #–ià
defšed
(
__HAIKU__
)

241 
	#PLATFORM_ID
 "Haiku"

	)

243 #–ià
defšed
(
__BeOS
è|| defšed(
__BEOS__
è|| defšed(
_BEOS
)

244 
	#PLATFORM_ID
 "BeOS"

	)

246 #–ià
defšed
(
__QNX__
è|| defšed(
__QNXNTO__
)

247 
	#PLATFORM_ID
 "QNX"

	)

249 #–ià
defšed
(
__Œu64
è|| defšed(
_Œu64
è|| defšed(
__TRU64__
)

250 
	#PLATFORM_ID
 "Tru64"

	)

252 #–ià
defšed
(
__riscos
è|| defšed(
__riscos__
)

253 
	#PLATFORM_ID
 "RISCos"

	)

255 #–ià
defšed
(
__sšix
è|| defšed(
__sšix__
è|| defšed(
__SINIX__
)

256 
	#PLATFORM_ID
 "SINIX"

	)

258 #–ià
defšed
(
__UNIX_SV__
)

259 
	#PLATFORM_ID
 "UNIX_SV"

	)

261 #–ià
defšed
(
__bsdos__
)

262 
	#PLATFORM_ID
 "BSDOS"

	)

264 #–ià
defšed
(
_MPRAS
è|| defšed(
MPRAS
)

265 
	#PLATFORM_ID
 "MP-RAS"

	)

267 #–ià
defšed
(
__osf
è|| defšed(
__osf__
)

268 
	#PLATFORM_ID
 "OSF1"

	)

270 #–ià
defšed
(
_SCO_SV
è|| defšed(
SCO_SV
è|| defšed(
sco_sv
)

271 
	#PLATFORM_ID
 "SCO_SV"

	)

273 #–ià
defšed
(
__uÉrix
è|| defšed(
__uÉrix__
è|| defšed(
_ULTRIX
)

274 
	#PLATFORM_ID
 "ULTRIX"

	)

276 #–ià
defšed
(
__XENIX__
è|| defšed(
_XENIX
è|| defšed(
XENIX
)

277 
	#PLATFORM_ID
 "X’ix"

	)

280 
	#PLATFORM_ID
 ""

	)

289 #ià
defšed
(
_WIN32
è&& defšed(
_MSC_VER
)

290 #ià
defšed
(
_M_IA64
)

291 
	#ARCHITECTURE_ID
 "IA64"

	)

293 #–ià
defšed
(
_M_X64
è|| defšed(
_M_AMD64
)

294 
	#ARCHITECTURE_ID
 "x64"

	)

296 #–ià
defšed
(
_M_IX86
)

297 
	#ARCHITECTURE_ID
 "X86"

	)

299 #–ià
defšed
(
_M_ARM
)

300 
	#ARCHITECTURE_ID
 "ARM"

	)

302 #–ià
defšed
(
_M_MIPS
)

303 
	#ARCHITECTURE_ID
 "MIPS"

	)

305 #–ià
defšed
(
_M_SH
)

306 
	#ARCHITECTURE_ID
 "SHx"

	)

309 
	#ARCHITECTURE_ID
 ""

	)

313 
	#ARCHITECTURE_ID
 ""

	)

317 
	#DEC
(
n
) \

318 ('0' + (((
n
) / 10000000)%10)), \

319 ('0' + (((
n
) / 1000000)%10)), \

320 ('0' + (((
n
) / 100000)%10)), \

321 ('0' + (((
n
) / 10000)%10)), \

322 ('0' + (((
n
) / 1000)%10)), \

323 ('0' + (((
n
) / 100)%10)), \

324 ('0' + (((
n
) / 10)%10)), \

325 ('0' + ((
n
è% 10))

	)

328 
	#HEX
(
n
) \

329 ('0' + ((
n
)>>28 & 0xF)), \

330 ('0' + ((
n
)>>24 & 0xF)), \

331 ('0' + ((
n
)>>20 & 0xF)), \

332 ('0' + ((
n
)>>16 & 0xF)), \

333 ('0' + ((
n
)>>12 & 0xF)), \

334 ('0' + ((
n
)>>8 & 0xF)), \

335 ('0' + ((
n
)>>4 & 0xF)), \

336 ('0' + ((
n
è& 0xF))

	)

339 #ifdeà
COMPILER_VERSION_MAJOR


340 cÚ¡ 
	gšfo_v”siÚ
[] = {

343 
COMPILER_VERSION_MAJOR
,

344 #ifdeà
COMPILER_VERSION_MINOR


345 '.', 
COMPILER_VERSION_MINOR
,

346 #ifdeà
COMPILER_VERSION_PATCH


347 '.', 
COMPILER_VERSION_PATCH
,

348 #ifdeà
COMPILER_VERSION_TWEAK


349 '.', 
COMPILER_VERSION_TWEAK
,

360 cÚ¡* 
	gšfo_¶©fÜm
 = "INFO" ":" "¶©fÜm[" 
PLATFORM_ID
 "]";

361 cÚ¡* 
	gšfo_¬ch
 = "INFO" ":" "¬ch[" 
ARCHITECTURE_ID
 "]";

367 
	$maš
(
¬gc
, * 
¬gv
[])

369 
»quœe
 = 0;

370 
»quœe
 +ğ
šfo_comp”
[
¬gc
];

371 
»quœe
 +ğ
šfo_¶©fÜm
[
¬gc
];

372 #ifdeà
COMPILER_VERSION_MAJOR


373 
»quœe
 +ğ
šfo_v”siÚ
[
¬gc
];

375 ()
¬gv
;

376  
»quœe
;

377 
	}
}

	@libmdadm/bitmap.h

6 #iâdeà
BITMAP_H


7 
	#BITMAP_H
 1

	)

9 
	#BITMAP_MAJOR_LO
 3

	)

13 
	#BITMAP_MAJOR_HI
 4

	)

14 
	#BITMAP_MAJOR_HOSTENDIAN
 3

	)

16 
	#BITMAP_MINOR
 39

	)

80 #ifdeà
__KERNEL__


82 
	#PAGE_BITS
 (
PAGE_SIZE
 << 3)

	)

83 
	#PAGE_BIT_SHIFT
 (
PAGE_SHIFT
 + 3)

	)

85 
__u16
 
	tb™m­_couÁ”_t
;

86 
	#COUNTER_BITS
 16

	)

87 
	#COUNTER_BIT_SHIFT
 4

	)

88 
	#COUNTER_BYTE_RATIO
 (
COUNTER_BITS
 / 8)

	)

89 
	#COUNTER_BYTE_SHIFT
 (
COUNTER_BIT_SHIFT
 - 3)

	)

91 
	#NEEDED_MASK
 ((
b™m­_couÁ”_t
è(1 << (
COUNTER_BITS
 - 1)))

	)

92 
	#RESYNC_MASK
 ((
b™m­_couÁ”_t
è(1 << (
COUNTER_BITS
 - 2)))

	)

93 
	#COUNTER_MAX
 ((
b™m­_couÁ”_t
è
RESYNC_MASK
 - 1)

	)

94 
	#NEEDED
(
x
è(((
b™m­_couÁ”_t
èxè& 
NEEDED_MASK
)

	)

95 
	#RESYNC
(
x
è(((
b™m­_couÁ”_t
èxè& 
RESYNC_MASK
)

	)

96 
	#COUNTER
(
x
è(((
b™m­_couÁ”_t
èxè& 
COUNTER_MAX
)

	)

99 
	#PAGE_COUNTER_RATIO
 (
PAGE_BITS
 / 
COUNTER_BITS
)

	)

101 
	#PAGE_COUNTER_SHIFT
 (
PAGE_BIT_SHIFT
 - 
COUNTER_BIT_SHIFT
)

	)

103 
	#PAGE_COUNTER_MASK
 (
PAGE_COUNTER_RATIO
 - 1)

	)

105 
	#BITMAP_BLOCK_SIZE
 512

	)

106 
	#BITMAP_BLOCK_SHIFT
 9

	)

109 
	#CHUNK_BLOCK_RATIO
(
b™m­
è((b™m­)->
chunksize
 >> 
BITMAP_BLOCK_SHIFT
)

	)

110 
	#CHUNK_BLOCK_SHIFT
(
b™m­
è((b™m­)->
chunkshiá
 - 
BITMAP_BLOCK_SHIFT
)

	)

111 
	#CHUNK_BLOCK_MASK
(
b™m­
è(
	`CHUNK_BLOCK_RATIO
(b™m­è- 1)

	)

115 
	#PAGEPTR_BLOCK_RATIO
(
b™m­
) \

116 (
	`CHUNK_BLOCK_RATIO
(
b™m­
è<< 
PAGE_COUNTER_SHIFT
 >> 1)

	)

117 
	#PAGEPTR_BLOCK_SHIFT
(
b™m­
) \

118 (
	`CHUNK_BLOCK_SHIFT
(
b™m­
è+ 
PAGE_COUNTER_SHIFT
 - 1)

	)

119 
	#PAGEPTR_BLOCK_MASK
(
b™m­
è(
	`PAGEPTR_BLOCK_RATIO
(b™m­è- 1)

	)

129 
	#CHUNK_BIT_OFFSET
(
chunk
è((chunkè+ ((
b™m­_su³r_t
è<< 3))

	)

137 
	#BITMAP_MAGIC
 0x6d746962

	)

140 
	eb™m­_¡©e
 {

141 
	mBITMAP_ACTIVE
 = 0x001,

142 
	mBITMAP_STALE
 = 0x002

146 
	sb™m­_su³r_s
 {

147 
__u32
 
	mmagic
;

148 
__u32
 
	mv”siÚ
;

149 
__u8
 
	muuid
[16];

150 
__u64
 
	mev’ts
;

151 
__u64
 
	mev’ts_ş—»d
;

152 
__u64
 
	msync_size
;

153 
__u32
 
	m¡©e
;

154 
__u32
 
	mchunksize
;

155 
__u32
 
	md«mÚ_¦“p
;

156 
__u32
 
	mwr™e_behšd
;

158 
__u8
 
	m·d
[256 - 64];

159 } 
	tb™m­_su³r_t
;

175 #ifdeà
__KERNEL__


178 
	sb™m­_·ge
 {

182 *
	mm­
;

187 
	mhijacked
;

191 
	mcouÁ
;

195 
	s·ge_li¡
 {

196 
li¡_h—d
 
	mli¡
;

197 
·ge
 *
	m·ge
;

201 
	sb™m­
 {

202 
b™m­_·ge
 *
	mbp
;

203 
	m·ges
;

204 
	mmissšg_·ges
;

206 
mddev_t
 *
	mmddev
;

208 
	mcouÁ”_b™s
;

211 
	mchunksize
;

212 
	mchunkshiá
;

213 
	mchunks
;

220 
	msyncchunk
;

222 
__u64
 
	mev’ts_ş—»d
;

225 
¥šlock_t
 
	mlock
;

227 
fe
 *
	mfe
;

228 
·ge
 *
	msb_·ge
;

229 
·ge
 **
	mfem­
;

230 *
	mfem­_©Œ
;

231 
	mfe_·ges
;

233 
	mæags
;

239 
mdk_th»ad_t
 *
	md«mÚ
;

240 
	md«mÚ_¦“p
;

251 
mdk_th»ad_t
 *
	mwr™e_d«mÚ
;

252 
mdk_th»ad_t
 *
	mwr™eback_d«mÚ
;

253 
¥šlock_t
 
	mwr™e_lock
;

254 
£m­hÜe
 
	mwr™e_»ady
;

255 
£m­hÜe
 
	mwr™e_dÚe
;

256 
	mwr™es_³ndšg
;

257 
wa™_queue_h—d_t
 
	mwr™e_wa™
;

258 
li¡_h—d
 
	mwr™e_·ges
;

259 
li¡_h—d
 
	mcom¶‘e_·ges
;

260 
mempoŞ_t
 *
	mwr™e_poŞ
;

266 
b™m­_ü—‹
(
mddev_t
 *
mddev
);

267 
b™m­_de¡roy
(
mddev_t
 *
mddev
);

268 
b™m­_aùive
(
b™m­
 *bitmap);

270 *
fe_·th
(
fe
 *fe, *
buf
, 
couÁ
);

271 
b™m­_´št_sb
(
b™m­
 *bitmap);

272 
b™m­_upd©e_sb
(
b™m­
 *bitmap);

274 
b™m­_£Îb™s
(
b™m­
 *bitmap);

277 
b™m­_¡¬twr™e
(
b™m­
 *b™m­, 
£ùÜ_t
 
off£t
, 
£ùÜs
);

278 
b™m­_’dwr™e
(
b™m­
 *b™m­, 
£ùÜ_t
 
off£t
, 
£ùÜs
,

279 
sucûss
);

280 
b™m­_¡¬t_sync
(
b™m­
 *b™m­, 
£ùÜ_t
 
off£t
, *
blocks
);

281 
b™m­_’d_sync
(
b™m­
 *b™m­, 
£ùÜ_t
 
off£t
, *
blocks
, 
abÜ‹d
);

282 
b™m­_şo£_sync
(
b™m­
 *bitmap);

284 
b™m­_uÅlug
(
b™m­
 *bitmap);

	@libmdadm/crc32.h

5 
loÿl
 cÚ¡ 
FAR
 
	güc_bË
[
TBLS
][256] =

60 #ifdeà
BYFOUR


	@libmdadm/dlink.h

5 
	s__dl_h—d


7 * 
	mdh_´ev
;

8 * 
	mdh_Ãxt
;

11 
	#dl_®loc
(
size
è((*)(((*)
	`xÿÎoc
(1,(size)+(
__dl_h—d
)))+(__dl_h—d)))

	)

12 
	#dl_Ãw
(
t
è(Ñ*)
	`dl_®loc
(Ñ)))

	)

13 
	#dl_Ãwv
(
t
,
n
è(Ñ*)
	`dl_®loc
(Ñ)*n))

	)

15 
	#dl_Ãxt
(
p
è*(&(((
__dl_h—d
*)Õ))[-1].
dh_Ãxt
))

	)

16 
	#dl_´ev
(
p
è*(&(((
__dl_h—d
*)Õ))[-1].
dh_´ev
))

	)

18 *
dl_h—d
();

19 *
dl_¡rdup
(*);

20 *
dl_¡ºdup
(*, );

21 
dl_š£¹
(*, *);

22 
dl_add
(*, *);

23 
dl_d–
(*);

24 
dl_ä“
(*);

25 
dl_š™
(*);

	@libmdadm/md_p.h

15 #iâdeà
_MD_P_H


16 
	#_MD_P_H


	)

44 
	#MD_RESERVED_BYTES
 (64 * 1024)

	)

45 
	#MD_RESERVED_SECTORS
 (
MD_RESERVED_BYTES
 / 512)

	)

46 
	#MD_RESERVED_BLOCKS
 (
MD_RESERVED_BYTES
 / 
BLOCK_SIZE
)

	)

48 
	#MD_NEW_SIZE_SECTORS
(
x
è((x & ~(
MD_RESERVED_SECTORS
 - 1)è- MD_RESERVED_SECTORS)

	)

49 
	#MD_NEW_SIZE_BLOCKS
(
x
è((x & ~(
MD_RESERVED_BLOCKS
 - 1)è- MD_RESERVED_BLOCKS)

	)

51 
	#MD_SB_BYTES
 4096

	)

52 
	#MD_SB_WORDS
 (
MD_SB_BYTES
 / 4)

	)

53 
	#MD_SB_BLOCKS
 (
MD_SB_BYTES
 / 
BLOCK_SIZE
)

	)

54 
	#MD_SB_SECTORS
 (
MD_SB_BYTES
 / 512)

	)

59 
	#MD_SB_GENERIC_OFFSET
 0

	)

60 
	#MD_SB_PERSONALITY_OFFSET
 64

	)

61 
	#MD_SB_DISKS_OFFSET
 128

	)

62 
	#MD_SB_DESCRIPTOR_OFFSET
 992

	)

64 
	#MD_SB_GENERIC_CONSTANT_WORDS
 32

	)

65 
	#MD_SB_GENERIC_STATE_WORDS
 32

	)

66 
	#MD_SB_GENERIC_WORDS
 (
MD_SB_GENERIC_CONSTANT_WORDS
 + 
MD_SB_GENERIC_STATE_WORDS
)

	)

67 
	#MD_SB_PERSONALITY_WORDS
 64

	)

68 
	#MD_SB_DESCRIPTOR_WORDS
 32

	)

69 
	#MD_SB_DISKS
 27

	)

70 
	#MD_SB_DISKS_WORDS
 (
MD_SB_DISKS
*
MD_SB_DESCRIPTOR_WORDS
)

	)

71 
	#MD_SB_RESERVED_WORDS
 (1024 - 
MD_SB_GENERIC_WORDS
 - 
MD_SB_PERSONALITY_WORDS
 - 
MD_SB_DISKS_WORDS
 - 
MD_SB_DESCRIPTOR_WORDS
)

	)

72 
	#MD_SB_EQUAL_WORDS
 (
MD_SB_GENERIC_WORDS
 + 
MD_SB_PERSONALITY_WORDS
 + 
MD_SB_DISKS_WORDS
)

	)

77 
	#MD_DISK_FAULTY
 0

	)

78 
	#MD_DISK_ACTIVE
 1

	)

79 
	#MD_DISK_SYNC
 2

	)

80 
	#MD_DISK_REMOVED
 3

	)

82 
	#MD_DISK_WRITEMOSTLY
 9

	)

87 
	#MD_DISK_REPLACEMENT
 17

	)

89 
	smdp_deviû_desütÜ_s
 {

90 
__u32
 
	mnumb”
;

91 
__u32
 
	mmajÜ
;

92 
__u32
 
	mmšÜ
;

93 
__u32
 
	m¿id_disk
;

94 
__u32
 
	m¡©e
;

95 
__u32
 
	m»£rved
[
MD_SB_DESCRIPTOR_WORDS
 - 5];

96 } 
	tmdp_disk_t
;

98 
	#MD_SB_MAGIC
 0xa92b4efc

	)

103 
	#MD_SB_CLEAN
 0

	)

104 
	#MD_SB_ERRORS
 1

	)

105 
	#MD_SB_BBM_ERRORS
 2

	)

106 
	#MD_SB_BLOCK_CONTAINER_RESHAPE
 3

	)

107 
	#MD_SB_BLOCK_VOLUME
 4

	)

109 
	#MD_SB_BITMAP_PRESENT
 8

	)

111 
	smdp_su³rblock_s
 {

115 
__u32
 
	mmd_magic
;

116 
__u32
 
	mmajÜ_v”siÚ
;

117 
__u32
 
	mmšÜ_v”siÚ
;

118 
__u32
 
	m·tch_v”siÚ
;

119 
__u32
 
	mgv®id_wÜds
;

120 
__u32
 
	m£t_uuid0
;

121 
__u32
 
	mùime
;

122 
__u32
 
	mËv–
;

123 
__u32
 
	msize
;

124 
__u32
 
	mÄ_disks
;

125 
__u32
 
	m¿id_disks
;

126 
__u32
 
	mmd_mšÜ
;

127 
__u32
 
	mnÙ_³rsi¡’t
;

128 
__u32
 
	m£t_uuid1
;

129 
__u32
 
	m£t_uuid2
;

130 
__u32
 
	m£t_uuid3
;

131 
__u32
 
	mg¡©e_üe£rved
[
MD_SB_GENERIC_CONSTANT_WORDS
 - 16];

136 
__u32
 
	mutime
;

137 
__u32
 
	m¡©e
;

138 
__u32
 
	maùive_disks
;

139 
__u32
 
	mwÜkšg_disks
;

140 
__u32
 
	mçed_disks
;

141 
__u32
 
	m¥¬e_disks
;

142 
__u32
 
	msb_csum
;

143 #ià 
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


144 
__u32
 
	mev’ts_hi
;

145 
__u32
 
	mev’ts_lo
;

146 
__u32
 
	mı_ev’ts_hi
;

147 
__u32
 
	mı_ev’ts_lo
;

149 
__u32
 
	mev’ts_lo
;

150 
__u32
 
	mev’ts_hi
;

151 
__u32
 
	mı_ev’ts_lo
;

152 
__u32
 
	mı_ev’ts_hi
;

154 
__u32
 
	m»cov”y_ı
;

156 
__u64
 
	m»sh­e_pos™iÚ
;

157 
__u32
 
	mÃw_Ëv–
;

158 
__u32
 
	md–_disks
;

159 
__u32
 
	mÃw_Ïyout
;

160 
__u32
 
	mÃw_chunk
;

161 
__u32
 
	mg¡©e_¤e£rved
[
MD_SB_GENERIC_STATE_WORDS
 - 18];

166 
__u32
 
	mÏyout
;

167 
__u32
 
	mchunk_size
;

168 
__u32
 
	mroÙ_pv
;

169 
__u32
 
	mroÙ_block
;

170 
__u32
 
	mp¡©e_»£rved
[
MD_SB_PERSONALITY_WORDS
 - 4];

175 
mdp_disk_t
 
	mdisks
[
MD_SB_DISKS
];

180 
__u32
 
	m»£rved
[
MD_SB_RESERVED_WORDS
];

185 
mdp_disk_t
 
	mthis_disk
;

187 } 
	tmdp_su³r_t
;

189 #ifdeà
__TINYC__


190 
	t__u64
;

193 
šlše
 
__u64
 
	$md_ev’t
(
mdp_su³r_t
 *
sb
) {

194 
__u64
 
ev
 = 
sb
->
ev’ts_hi
;

195  (
ev
<<32)| 
sb
->
ev’ts_lo
;

196 
	}
}

	@libmdadm/md_u.h

15 #iâdeà
_MD_U_H


16 
	#_MD_U_H


	)

21 
	#RAID_VERSION
 
	`_IOR
 (
MD_MAJOR
, 0x10, 
mdu_v”siÚ_t
)

	)

22 
	#GET_ARRAY_INFO
 
	`_IOR
 (
MD_MAJOR
, 0x11, 
mdu_¬¿y_šfo_t
)

	)

23 
	#GET_DISK_INFO
 
	`_IOR
 (
MD_MAJOR
, 0x12, 
mdu_disk_šfo_t
)

	)

24 
	#PRINT_RAID_DEBUG
 
	`_IO
 (
MD_MAJOR
, 0x13)

	)

25 
	#RAID_AUTORUN
 
	`_IO
 (
MD_MAJOR
, 0x14)

	)

26 
	#GET_BITMAP_FILE
 
	`_IOR
 (
MD_MAJOR
, 0x15, 
mdu_b™m­_fe_t
)

	)

29 
	#CLEAR_ARRAY
 
	`_IO
 (
MD_MAJOR
, 0x20)

	)

30 
	#ADD_NEW_DISK
 
	`_IOW
 (
MD_MAJOR
, 0x21, 
mdu_disk_šfo_t
)

	)

31 
	#HOT_REMOVE_DISK
 
	`_IO
 (
MD_MAJOR
, 0x22)

	)

32 
	#SET_ARRAY_INFO
 
	`_IOW
 (
MD_MAJOR
, 0x23, 
mdu_¬¿y_šfo_t
)

	)

33 
	#SET_DISK_INFO
 
	`_IO
 (
MD_MAJOR
, 0x24)

	)

34 
	#WRITE_RAID_INFO
 
	`_IO
 (
MD_MAJOR
, 0x25)

	)

35 
	#UNPROTECT_ARRAY
 
	`_IO
 (
MD_MAJOR
, 0x26)

	)

36 
	#PROTECT_ARRAY
 
	`_IO
 (
MD_MAJOR
, 0x27)

	)

37 
	#HOT_ADD_DISK
 
	`_IO
 (
MD_MAJOR
, 0x28)

	)

38 
	#SET_DISK_FAULTY
 
	`_IO
 (
MD_MAJOR
, 0x29)

	)

39 
	#SET_BITMAP_FILE
 
	`_IOW
 (
MD_MAJOR
, 0x2b, )

	)

42 
	#RUN_ARRAY
 
	`_IOW
 (
MD_MAJOR
, 0x30, 
mdu_·¿m_t
)

	)

43 
	#START_ARRAY
 
	`_IO
 (
MD_MAJOR
, 0x31)

	)

44 
	#STOP_ARRAY
 
	`_IO
 (
MD_MAJOR
, 0x32)

	)

45 
	#STOP_ARRAY_RO
 
	`_IO
 (
MD_MAJOR
, 0x33)

	)

46 
	#RESTART_ARRAY_RW
 
	`_IO
 (
MD_MAJOR
, 0x34)

	)

48 
	smdu_v”siÚ_s
 {

49 
	mmajÜ
;

50 
	mmšÜ
;

51 
	m·tchËv–
;

52 } 
	tmdu_v”siÚ_t
;

54 
	smdu_¬¿y_šfo_s
 {

58 
	mmajÜ_v”siÚ
;

59 
	mmšÜ_v”siÚ
;

60 
	m·tch_v”siÚ
;

61 
	mùime
;

62 
	mËv–
;

63 
	msize
;

64 
	mÄ_disks
;

65 
	m¿id_disks
;

66 
	mmd_mšÜ
;

67 
	mnÙ_³rsi¡’t
;

72 
	mutime
;

73 
	m¡©e
;

74 
	maùive_disks
;

75 
	mwÜkšg_disks
;

76 
	mçed_disks
;

77 
	m¥¬e_disks
;

82 
	mÏyout
;

83 
	mchunk_size
;

85 } 
	tmdu_¬¿y_šfo_t
;

87 
	smdu_disk_šfo_s
 {

91 
	mnumb”
;

92 
	mmajÜ
;

93 
	mmšÜ
;

94 
	m¿id_disk
;

95 
	m¡©e
;

97 } 
	tmdu_disk_šfo_t
;

99 
	smdu_¡¬t_šfo_s
 {

103 
	mmajÜ
;

104 
	mmšÜ
;

105 
	m¿id_disk
;

106 
	m¡©e
;

108 } 
	tmdu_¡¬t_šfo_t
;

110 
	smdu_b™m­_fe_s


112 
	m·thÇme
[4096];

113 } 
	tmdu_b™m­_fe_t
;

115 
	smdu_·¿m_s


117 
	m³rsÚ®™y
;

118 
	mchunk_size
;

119 
	mmax_çuÉ
;

120 } 
	tmdu_·¿m_t
;

	@libmdadm/mdadm.h

25 
	#_GNU_SOURCE


	)

26 
	#_FILE_OFFSET_BITS
 64

	)

27 
	~<uni¡d.h
>

28 #ifdeà
__GLIBC__


29 
__off64_t
 
l£ek64
 
__P
 ((
__fd
, __off64_ˆ
__off£t
, 
__wh’û
));

30 #–ià!
defšed
(
l£ek64
)

31 #ià
defšed
(
__NO_STAT64
è|| 
__WORDSIZE
 != 32

32 
	#l£ek64
 
l£ek


	)

36 
	~<sys/ty³s.h
>

37 
	~<sys/¡©.h
>

38 
	~<¡dlib.h
>

39 
	~<time.h
>

40 
	~<sys/time.h
>

41 
	~<g‘İt.h
>

42 
	~<fú.h
>

43 
	~<¡dio.h
>

44 
	~<”ºo.h
>

45 
	~<¡ršg.h
>

46 
	~<sy¦og.h
>

47 #ifdeà
__d›ibc__


48 
	~<¡ršgs.h
>

50 
	#¿ndom
 
¿nd


	)

51 
	#¤ªdom
 
¤ªd


	)

54 
	~<lšux/kdev_t.h
>

56 
	~<sys/mouÁ.h
>

57 
	~<asm/ty³s.h
>

58 
	~<sys/ioùl.h
>

59 
	#MD_MAJOR
 9

	)

60 
	#MdpMšÜShiá
 6

	)

62 #iâdeà
BLKGETSIZE64


63 
	#BLKGETSIZE64
 
	`_IOR
(0x12,114,
size_t
è

	)

66 
	#DEFAULT_CHUNK
 512

	)

67 
	#DEFAULT_BITMAP_CHUNK
 4096

	)

68 
	#DEFAULT_BITMAP_DELAY
 5

	)

69 
	#DEFAULT_MAX_WRITE_BEHIND
 256

	)

75 #iâdeà
MAP_DIR


76 
	#MAP_DIR
 "/run/mdadm"

	)

81 #iâdeà
MAP_FILE


82 
	#MAP_FILE
 "m­"

	)

92 #iâdeà
MDMON_DIR


93 
	#MDMON_DIR
 "/run/mdadm"

	)

100 #iâdeà
FAILED_SLOTS_DIR


101 
	#FAILED_SLOTS_DIR
 "/run/mdadm/çed-¦Ùs"

	)

104 
	~"md_u.h
"

105 
	~"md_p.h
"

106 
	~"b™m­.h
"

107 
	~"msg.h
"

108 
	~"mdadm_”rcode.h
"

109 
	~"mdadm_Ùh”.h
"

111 
	~<’dŸn.h
>

117 
	#bsw­_16
(
x
) (((x) & 0x00ffU) << 8 | \

118 ((
x
è& 0xff00Uè>> 8)

	)

119 
	#bsw­_32
(
x
) (((x) & 0x000000ffU) << 24 | \

120 ((
x
) & 0xff000000U) >> 24 | \

121 ((
x
) & 0x0000ff00U) << 8 | \

122 ((
x
è& 0x00ff0000Uè>> 8)

	)

123 
	#bsw­_64
(
x
) (((x) & 0x00000000000000ffULL) << 56 | \

124 ((
x
) & 0xff00000000000000ULL) >> 56 | \

125 ((
x
) & 0x000000000000ff00ULL) << 40 | \

126 ((
x
) & 0x00ff000000000000ULL) >> 40 | \

127 ((
x
) & 0x0000000000ff0000ULL) << 24 | \

128 ((
x
) & 0x0000ff0000000000ULL) >> 24 | \

129 ((
x
) & 0x00000000ff000000ULL) << 8 | \

130 ((
x
è& 0x000000ff00000000ULLè>> 8)

	)

132 #ià!
defšed
(
__KLIBC__
)

133 #ià
BYTE_ORDER
 =ğ
LITTLE_ENDIAN


134 
	#__ıu_to_Ë16
(
_x
è()(_x)

	)

135 
	#__ıu_to_Ë32
(
_x
è()(_x)

	)

136 
	#__ıu_to_Ë64
(
_x
è()(_x)

	)

137 
	#__Ë16_to_ıu
(
_x
è()(_x)

	)

138 
	#__Ë32_to_ıu
(
_x
è()(_x)

	)

139 
	#__Ë64_to_ıu
(
_x
è()(_x)

	)

141 
	#__ıu_to_be16
(
_x
è
	`bsw­_16
(_x)

	)

142 
	#__ıu_to_be32
(
_x
è
	`bsw­_32
(_x)

	)

143 
	#__ıu_to_be64
(
_x
è
	`bsw­_64
(_x)

	)

144 
	#__be16_to_ıu
(
_x
è
	`bsw­_16
(_x)

	)

145 
	#__be32_to_ıu
(
_x
è
	`bsw­_32
(_x)

	)

146 
	#__be64_to_ıu
(
_x
è
	`bsw­_64
(_x)

	)

147 #–ià
BYTE_ORDER
 =ğ
BIG_ENDIAN


148 
	#__ıu_to_Ë16
(
_x
è
	`bsw­_16
(_x)

	)

149 
	#__ıu_to_Ë32
(
_x
è
	`bsw­_32
(_x)

	)

150 
	#__ıu_to_Ë64
(
_x
è
	`bsw­_64
(_x)

	)

151 
	#__Ë16_to_ıu
(
_x
è
	`bsw­_16
(_x)

	)

152 
	#__Ë32_to_ıu
(
_x
è
	`bsw­_32
(_x)

	)

153 
	#__Ë64_to_ıu
(
_x
è
	`bsw­_64
(_x)

	)

155 
	#__ıu_to_be16
(
_x
è()(_x)

	)

156 
	#__ıu_to_be32
(
_x
è()(_x)

	)

157 
	#__ıu_to_be64
(
_x
è()(_x)

	)

158 
	#__be16_to_ıu
(
_x
è()(_x)

	)

159 
	#__be32_to_ıu
(
_x
è()(_x)

	)

160 
	#__be64_to_ıu
(
_x
è()(_x)

	)

171 
	#mš
(
x
, 
y
) ({ \

172 
	`ty³of
(
x
è
_mš1
 = (x); \

173 
	`ty³of
(
y
è
_mš2
 = (y); \

174 (è(&
_mš1
 =ğ&
_mš2
); \

175 
_mš1
 < 
_mš2
 ? _mš1 : _mš2; })

	)

177 
	#max
(
x
, 
y
) ({ \

178 
	`ty³of
(
x
è
_max1
 = (x); \

179 
	`ty³of
(
y
è
_max2
 = (y); \

180 (è(&
_max1
 =ğ&
_max2
); \

181 
_max1
 > 
_max2
 ? _max1 : _max2; })

	)

183 
	#ARRAY_SIZE
(
x
è((x)/(x[0]))

	)

186 
	smdšfo
 {

187 
mdu_¬¿y_šfo_t
 
	m¬¿y
;

188 
mdu_disk_šfo_t
 
	mdisk
;

189 
__u64
 
	mev’ts
;

190 
	muuid
[4];

191 
	mÇme
[33];

192 
	md©a_off£t
;

193 
	mÃw_d©a_off£t
;

194 
	mcompÚ’t_size
;

197 
	mcu¡om_¬¿y_size
;

200 
	#NO_RESHAPE
 0

	)

201 
	#VOLUME_RESHAPE
 1

	)

202 
	#CONTAINER_RESHAPE
 2

	)

203 
	#RESHAPE_NO_BACKUP
 16

	)

204 
	m»sh­e_aùive
;

205 
	m»sh­e_´og»ss
;

206 
	m»cov”y_blocked
;

218 
	m¥aû_befÜe
, 
	m¥aû_aá”
;

220 
	m»sync_¡¬t
;

221 
	m»cov”y_¡¬t
;

222 
	#MaxSeùÜ
 (~0ULLè

	)

224 
	mb™m­_off£t
;

225 
	m§ã_mode_d–ay
;

226 
	mÃw_Ëv–
, 
	md–_disks
, 
	mÃw_Ïyout
, 
	mÃw_chunk
;

227 
	m”rÜs
;

228 
	mÿche_size
;

229 
	mmism©ch_út
;

230 
	m‹xt_v”siÚ
[50];

232 
	mcÚš”_memb”
;

235 
	mcÚš”_’ough
;

238 
	msys_Çme
[20];

239 
mdšfo
 *
	mdevs
;

240 
mdšfo
 *
	mÃxt
;

243 
	m»cov”y_fd
;

244 
	m¡©e_fd
;

245 
	#DS_FAULTY
 1

	)

246 
	#DS_INSYNC
 2

	)

247 
	#DS_WRITE_MOSTLY
 4

	)

248 
	#DS_SPARE
 8

	)

249 
	#DS_BLOCKED
 16

	)

250 
	#DS_REMOVE
 1024

	)

251 
	#DS_UNBLOCK
 2048

	)

252 
	m´ev_¡©e
, 
	mcu¼_¡©e
, 
	mÃxt_¡©e
;

256 
	sü—‹šfo
 {

257 
	muid
;

258 
	mgid
;

259 
	mautof
;

260 
	mmode
;

261 
	msymlšks
;

262 
	mÇmes
;

263 
	mbbli¡
;

264 
su³¹y³
 *
	msu³¹y³
;

267 
	#Name
 "mdadm"

	)

269 
	emode
 {

270 
	mASSEMBLE
=1,

271 
	mBUILD
,

272 
	mCREATE
,

273 
	mMANAGE
,

274 
	mMISC
,

275 
	mMONITOR
,

276 
	mGROW
,

277 
	mINCREMENTAL
,

278 
	mAUTODETECT
,

279 
	mmode_couÁ


282 
	e´efix_¡ªd¬d
 {

283 
	mJEDEC
,

284 
	mIEC


297 
	#UnS‘
 (0xffã)

	)

298 
	smddev_id’t
 {

299 *
	mdevÇme
;

301 
	muuid_£t
;

302 
	muuid
[4];

303 
	mÇme
[33];

305 
	msu³r_mšÜ
;

307 *
	mdeviûs
;

310 
	mËv–
;

311 
	m¿id_disks
;

312 
	m¥¬e_disks
;

313 
su³¹y³
 *
	m¡
;

314 
	mautof
;

315 *
	m¥¬e_group
;

316 *
	mb™m­_fe
;

317 
	mb™m­_fd
;

319 *
	mcÚš”
;

324 *
	mmemb”
;

326 
mddev_id’t
 *
	mÃxt
;

329 
	mas£mbËd
;

333 
	scÚ‹xt
 {

334 
	m»adÚly
;

335 
	mrun¡İ
;

336 
	mv”bo£
;

337 
	mbr›f
;

338 
	mfÜû
;

339 *
	mhomeho¡
;

340 
	m»quœe_homeho¡
;

341 *
	m´eãr
;

342 
	m_expÜt
;

343 
	m‹¡
;

344 *
	msub¬¿y
;

345 *
	mupd©e
;

346 
	msÿn
;

347 
	mS·rcAdju¡
;

348 
	mautof
;

349 
	md–ay
;

350 
	mä“ze_»sh­e
;

351 *
	mbackup_fe
;

352 
	mšv®id_backup
;

353 *
	maùiÚ
;

356 
	ssh­e
 {

357 
	m¿iddisks
;

358 
	m¥¬edisks
;

359 
	mËv–
;

360 
	mÏyout
;

361 *
	mÏyout_¡r
;

362 
	mchunk
;

363 
	mb™m­_chunk
;

364 *
	mb™m­_fe
;

365 
	massume_ş—n
;

366 
	mwr™e_behšd
;

367 
	msize
;

371 
	smddev_dev
 {

372 *
	mdevÇme
;

373 
	mdi¥os™iÚ
;

377 
	mwr™emo¡ly
;

378 
	mu£d
;

379 
	md©a_off£t
;

380 
mddev_dev
 *
	mÃxt
;

383 
	sm­pšg
 {

384 *
	mÇme
;

385 
	mnum
;

386 } 
	tm­pšg_t
;

388 
	smd¡©_’t
 {

389 *
	mdev
;

390 
	mdevnm
[32];

391 
	maùive
;

392 *
	mËv–
;

393 *
	m·‰”n
;

394 
	m³rûÁ
;

395 
	m»sync
;

396 
	mdevút
;

397 
	m¿id_disks
;

398 * 
	mm‘ad©a_v”siÚ
;

399 
	sdev_memb”
 {

400 *
	mÇme
;

401 
dev_memb”
 *
	mÃxt
;

402 } *
	mmemb”s
;

403 
md¡©_’t
 *
	mÃxt
;

406 
md¡©_’t
 *
md¡©_»ad
(
hŞd
, 
¡¬t
);

407 
md¡©_şo£
();

408 
ä“_md¡©
(
md¡©_’t
 *
ms
);

409 
md¡©_wa™
(
£cÚds
);

410 
md¡©_wa™_fd
(
fd
, cÚ¡ 
sig£t_t
 *
sigmask
);

411 
mddev_busy
(*
devnm
);

412 
md¡©_’t
 *
md¡©_by_compÚ’t
(*
Çme
);

413 
md¡©_’t
 *
md¡©_by_subdev
(*
subdev
, *
cÚš”
);

415 
	sm­_’t
 {

416 
m­_’t
 *
	mÃxt
;

417 
	mdevnm
[32];

418 
	mm‘ad©a
[20];

419 
	muuid
[4];

420 
	mbad
;

421 *
	m·th
;

423 
m­_upd©e
(
m­_’t
 **
mµ
, *
devnm
, *
m‘ad©a
,

424 
uuid
[4], *
·th
);

425 
m­_»move
(
m­_’t
 **
m­
, *
devnm
);

426 
m­_’t
 *
m­_by_uuid
(m­_’ˆ**
m­
, 
uuid
[4]);

427 #ifdeà
MDASSEMBLE


428 
šlše
 
m­_’t
 *
	$m­_by_devnm
(
m­_’t
 **
m­
, *
Çme
)

430  
NULL
;

431 
	}
}

432 
šlše
 
	$m­_ä“
(
m­_’t
 *
m­
)

434 
	}
}

436 
m­_’t
 *
m­_by_devnm
(m­_’ˆ**
m­
, *
devnm
);

437 
m­_ä“
(
m­_’t
 *
m­
);

439 
m­_’t
 *
m­_by_Çme
(m­_’ˆ**
m­
, *
Çme
);

440 
m­_»ad
(
m­_’t
 **
m–p
);

441 
m­_wr™e
(
m­_’t
 *
m–
);

442 
m­_d–‘e
(
m­_’t
 **
m­p
, *
devnm
);

443 
m­_add
(
m­_’t
 **
m–p
,

444 *
devnm
, *
m‘ad©a
, 
uuid
[4], *
·th
);

445 
m­_lock
(
m­_’t
 **
m–p
);

446 
m­_uÆock
(
m­_’t
 **
m–p
);

447 
m­_fÜk
();

450 
	esysfs_»ad_æags
 {

451 
	mGET_LEVEL
 = (1 << 0),

452 
	mGET_LAYOUT
 = (1 << 1),

453 
	mGET_COMPONENT
 = (1 << 2),

454 
	mGET_CHUNK
 = (1 << 3),

455 
	mGET_CACHE
 = (1 << 4),

456 
	mGET_MISMATCH
 = (1 << 5),

457 
	mGET_VERSION
 = (1 << 6),

458 
	mGET_DISKS
 = (1 << 7),

459 
	mGET_DEGRADED
 = (1 << 8),

460 
	mGET_SAFEMODE
 = (1 << 9),

461 
	mGET_BITMAP_LOCATION
 = (1 << 10),

463 
	mGET_DEVS
 = (1 << 20),

464 
	mGET_OFFSET
 = (1 << 21),

465 
	mGET_SIZE
 = (1 << 22),

466 
	mGET_STATE
 = (1 << 23),

467 
	mGET_ERROR
 = (1 << 24),

473 
sysfs_İ’
(*
devnm
, *
devÇme
, *
©Œ
);

474 
sysfs_š™
(
mdšfo
 *
mdi
, 
fd
, *
devnm
);

475 
sysfs_ä“
(
mdšfo
 *
¤a
);

476 
mdšfo
 *
sysfs_»ad
(
fd
, *
devnm
, 
İtiÚs
);

477 
sysfs_©Œ_m©ch
(cÚ¡ *
©Œ
, cÚ¡ *
¡r
);

478 
sysfs_m©ch_wÜd
(cÚ¡ *
wÜd
, **
li¡
);

479 
sysfs_£t_¡r
(
mdšfo
 *
¤a
, mdšfØ*
dev
,

480 *
Çme
, *
v®
);

481 
sysfs_£t_num
(
mdšfo
 *
¤a
, mdšfØ*
dev
,

482 *
Çme
, 
v®
);

483 
sysfs_£t_num_sigÃd
(
mdšfo
 *
¤a
, mdšfØ*
dev
,

484 *
Çme
, 
v®
);

485 
sysfs_uev’t
(
mdšfo
 *
¤a
, *
ev’t
);

486 
sysfs_g‘_fd
(
mdšfo
 *
¤a
, mdšfØ*
dev
,

487 *
Çme
);

488 
sysfs_fd_g‘_Î
(
fd
, *
v®
);

489 
sysfs_g‘_Î
(
mdšfo
 *
¤a
, mdšfØ*
dev
,

490 *
Çme
, *
v®
);

491 
sysfs_fd_g‘_two
(
fd
, *
v1
, *
v2
);

492 
sysfs_g‘_two
(
mdšfo
 *
¤a
, mdšfØ*
dev
,

493 *
Çme
, *
v1
, *
v2
);

494 
sysfs_fd_g‘_¡r
(
fd
, *
v®
, 
size
);

495 
sysfs_©Œibu‹_avaabË
(
mdšfo
 *
¤a
, mdšfØ*
dev
,

496 *
Çme
);

497 
sysfs_g‘_¡r
(
mdšfo
 *
¤a
, mdšfØ*
dev
,

498 *
Çme
, *
v®
, 
size
);

499 
sysfs_£t_§ãmode
(
mdšfo
 *
¤a
, 
ms
);

500 
sysfs_£t_¬¿y
(
mdšfo
 *
šfo
, 
v”s
);

501 
sysfs_add_disk
(
mdšfo
 *
¤a
, mdšfØ*
sd
, 
»sume
);

502 
sysfs_disk_to_scsi_id
(
fd
, 
__u32
 *
id
);

503 
sysfs_unique_hŞd”
(*
devnm
, 
rdev
);

504 
sysfs_ä“ze_¬¿y
(
mdšfo
 *
¤a
);

505 
sysfs_wa™
(
fd
, *
m£c
);

506 
lßd_sys
(*
·th
, *
buf
);

507 
»sh­e_´•¬e_fdli¡
(*
devÇme
,

508 
mdšfo
 *
¤a
,

509 
¿id_disks
,

510 
Ädisks
,

511 
blocks
,

512 *
backup_fe
,

513 *
fdli¡
,

514 *
off£ts
);

515 
»sh­e_ä“_fdli¡
(*
fdli¡
,

516 *
off£ts
,

517 
size
);

518 
»sh­e_İ’_backup_fe
(*
backup
,

519 
fd
,

520 *
devÇme
,

521 
blocks
,

522 *
fdli¡
,

523 *
off£ts
,

524 *
sysfs_Çme
,

525 
»¡¬t
);

526 
compu‹_backup_blocks
(
nchunk
, 
ochunk
,

527 
nd©a
, 
od©a
);

528 *
loÿ‹_backup
(*
Çme
);

529 *
make_backup
(*
Çme
);

531 
§ve_¡res
(*
sourû
, *
off£ts
,

532 
¿id_disks
, 
chunk_size
, 
Ëv–
, 
Ïyout
,

533 
nwr™es
, *
de¡
,

534 
¡¬t
, 
Ëngth
,

535 *
buf
);

536 
»¡Üe_¡res
(*
de¡
, *
off£ts
,

537 
¿id_disks
, 
chunk_size
, 
Ëv–
, 
Ïyout
,

538 
sourû
, 
»ad_off£t
,

539 
¡¬t
, 
Ëngth
,

540 *
¤c_buf
);

542 #iâdeà
S’dma


543 
	#S’dma
 "/u¤/lib/£ndma -t"

	)

546 
	#SYSLOG_FACILITY
 
LOG_DAEMON


	)

548 *
m­_num
(
m­pšg_t
 *
m­
, 
num
);

549 
m­_Çme
(
m­pšg_t
 *
m­
, *
Çme
);

550 
m­pšg_t
 
r5Ïyout
[], 
r6Ïyout
[], 
³rs
[], 
modes
[], 
çuÉyÏyout
[];

552 *
m­_dev_´eã¼ed
(
majÜ
, 
mšÜ
, 
ü—‹
,

553 *
´eãr
);

554 
šlše
 *
	$m­_dev
(
majÜ
, 
mšÜ
, 
ü—‹
)

556  
	`m­_dev_´eã¼ed
(
majÜ
, 
mšÜ
, 
ü—‹
, 
NULL
);

557 
	}
}

559 
	gaùive_¬¿y
;

560 
	gm‘ad©a_upd©e
;

578 
	s»sh­e
 {

579 
	mËv–
;

580 
	m·r™y
;

582 
	mÏyout
;

583 
	md©a_disks
;

584 } 
	mbefÜe
, 
	maá”
;

585 
	mbackup_blocks
;

586 
	mmš_off£t_chªge
;

587 
	m¡res
;

588 
	mÃw_size
;

618 
	ssu³rsw™ch
 {

623 (*
examše_su³r
)(
su³¹y³
 *
¡
, *
homeho¡
);

624 (*
examše_su³r_»suÉ
)(
su³¹y³
 *
¡
, *
homeho¡
, 
examše_»suÉ
 *
»suÉli¡
);

625 (*
br›f_examše_su³r
)(
su³¹y³
 *
¡
, 
v”bo£
);

626 (*
br›f_examše_sub¬¿ys
)(
su³¹y³
 *
¡
, 
v”bo£
);

627 (*
expÜt_examše_su³r
)(
su³¹y³
 *
¡
);

628 (*
examše_badblocks
)(
su³¹y³
 *
¡
, 
fd
, *
devÇme
);

629 (*
cİy_m‘ad©a
)(
su³¹y³
 *
¡
, 
äom
, 
to
);

634 (*
d‘a_su³r
)(
su³¹y³
 *
¡
, *
homeho¡
);

635 (*
br›f_d‘a_su³r
)(
su³¹y³
 *
¡
);

636 (*
expÜt_d‘a_su³r
)(
su³¹y³
 *
¡
);

639 (*
d‘a_¶©fÜm
)(
v”bo£
, 
’um”©e_Úly
, *
cÚŒŞËr_·th
);

640 (*
expÜt_d‘a_¶©fÜm
)(
v”bo£
, *
cÚŒŞËr_·th
);

647 (*
uuid_äom_su³r
)(
su³¹y³
 *
¡
, 
uuid
[4]);

664 (*
g‘šfo_su³r
)(
su³¹y³
 *
¡
, 
mdšfo
 *
šfo
, *
m­
);

665 
mdšfo
 *(*
g‘šfo_su³r_disks
)(
su³¹y³
 *
¡
);

669 (*
m©ch_home
)(
su³¹y³
 *
¡
, *
homeho¡
);

699 (*
upd©e_su³r
)(
su³¹y³
 *
¡
, 
mdšfo
 *
šfo
,

700 *
upd©e
,

701 *
devÇme
, 
v”bo£
,

702 
uuid_£t
, *
homeho¡
);

709 (*
š™_su³r
)(
su³¹y³
 *
¡
, 
mdu_¬¿y_šfo_t
 *
šfo
,

710 
size
, *
Çme
,

711 *
homeho¡
, *
uuid
,

712 
d©a_off£t
);

717 (*
add_to_su³r
)(
su³¹y³
 *
¡
, 
mdu_disk_šfo_t
 *
dšfo
,

718 
fd
, *
devÇme
,

719 
d©a_off£t
);

723 (*
»move_äom_su³r
)(
su³¹y³
 *
¡
, 
mdu_disk_šfo_t
 *
dšfo
);

728 (*
¡Üe_su³r
)(
su³¹y³
 *
¡
, 
fd
);

732 (*
wr™e_š™_su³r
)(
su³¹y³
 *
¡
);

740 (*
com·»_su³r
)(
su³¹y³
 *
¡
, su³¹y³ *
t¡
);

743 (*
lßd_su³r
)(
su³¹y³
 *
¡
, 
fd
, *
devÇme
);

747 (*
lßd_cÚš”
)(
su³¹y³
 *
¡
, 
fd
, *
devÇme
);

750 
su³¹y³
 * (*
m©ch_m‘ad©a_desc
)(*
¬g
);

759 
__u64
 (*
ava_size
)(
su³¹y³
 *
¡
, __u64 
size
,

760 
d©a_off£t
);

765 (*
mš_acû±abË_¥¬e_size
)(
su³¹y³
 *
¡
);

772 (*
add_š‹º®_b™m­
)(
su³¹y³
 *
¡
, *
chunkp
,

773 
d–ay
, 
wr™e_behšd
,

774 
size
, 
may_chªge
, 
majÜ
);

778 (*
loÿ‹_b™m­
)(
su³¹y³
 *
¡
, 
fd
);

782 (*
wr™e_b™m­
)(
su³¹y³
 *
¡
, 
fd
);

784 (*
ä“_su³r
)(
su³¹y³
 *
¡
);

801 (*
v®id©e_geom‘ry
)(
su³¹y³
 *
¡
, 
Ëv–
, 
Ïyout
,

802 
¿iddisks
,

803 *
chunk
, 
size
,

804 
d©a_off£t
,

805 *
subdev
, *
ä“size
,

806 
v”bo£
);

811 
mdšfo
 *(*
cÚš”_cÚ‹Á
)(
su³¹y³
 *
¡
, *
sub¬¿y
);

813 (*
deçuÉ_geom‘ry
)(
su³¹y³
 *
¡
, *
Ëv–
, *
Ïyout
, *
chunk
);

815 (*
kl_sub¬¿y
)(
su³¹y³
 *
¡
);

817 (*
upd©e_sub¬¿y
)(
su³¹y³
 *
¡
, *
sub¬¿y
,

818 *
upd©e
, 
mddev_id’t
 *
id’t
);

824 
	#APPLY_METADATA_CHANGES
 1

	)

825 
	#ROLLBACK_METADATA_CHANGES
 0

	)

827 (*
»sh­e_su³r
)(
su³¹y³
 *
¡
,

828 
size
, 
Ëv–
,

829 
Ïyout
, 
chunksize
, 
¿id_disks
,

830 
d–_disks
, *
backup
, *
dev
,

831 
dœeùiÚ
,

832 
v”bo£
);

833 (*
mªage_»sh­e
)(

834 
afd
, 
mdšfo
 *
¤a
, 
»sh­e
 *reshape,

835 
su³¹y³
 *
¡
, 
blocks
,

836 *
fds
, *
off£ts
,

837 
de¡s
, *
de¡fd
, *
de¡off£ts
);

840 (*
İ’_Ãw
)(
su³¹y³
 *
c
, 
aùive_¬¿y
 *
a
,

841 *
š¡
);

854 (*
£t_¬¿y_¡©e
)(
aùive_¬¿y
 *
a
, 
cÚsi¡’t
);

863 (*
£t_disk
)(
aùive_¬¿y
 *
a
, 
n
, 
¡©e
);

864 (*
sync_m‘ad©a
)(
su³¹y³
 *
¡
);

865 (*
´oûss_upd©e
)(
su³¹y³
 *
¡
,

866 
m‘ad©a_upd©e
 *
upd©e
);

870 (*
´•¬e_upd©e
)(
su³¹y³
 *
¡
,

871 
m‘ad©a_upd©e
 *
upd©e
);

880 
mdšfo
 *(*
aùiv©e_¥¬e
)(
aùive_¬¿y
 *
a
,

881 
m‘ad©a_upd©e
 **
upd©es
);

896 cÚ¡ *(*
g‘_disk_cÚŒŞËr_domaš
)(cÚ¡ *
·th
);

899 (*
»cov”_backup
)(
su³¹y³
 *
¡
, 
mdšfo
 *
šfo
);

902 (*
v®id©e_cÚš”
)(
mdšfo
 *
šfo
);

904 
sw­uuid
;

905 
ex‹º®
;

906 cÚ¡ *
Çme
;

907 } *
su³¾i¡
[];

909 
su³rsw™ch
 
su³r0
, 
su³r1
;

910 
su³rsw™ch
 
su³r_imsm
, 
su³r_ddf
;

911 
su³rsw™ch
 
mbr
, 
g±
;

913 
	sm‘ad©a_upd©e
 {

914 
	mËn
;

915 *
	mbuf
;

916 *
	m¥aû
;

917 **
	m¥aû_li¡
;

920 
m‘ad©a_upd©e
 *
	mÃxt
;

940 
	ssu³¹y³
 {

941 
su³rsw™ch
 *
	mss
;

942 
	mmšÜ_v”siÚ
;

943 
	mmax_devs
;

944 
	mcÚš”_devnm
[32];

945 *
	msb
;

946 *
	mšfo
;

947 *
	mÙh”
;

948 
	mdevsize
;

949 
	md©a_off£t
;

950 
	mignÜe_hw_com·t
;

955 
m‘ad©a_upd©e
 *
	mupd©es
;

956 
m‘ad©a_upd©e
 **
	mupd©e_
;

959 
aùive_¬¿y
 *
	m¬¿ys
;

960 
	msock
;

961 
	mdevnm
[32];

964 
	mdevút
;

965 
	m»Œy_soÚ
;

967 
mdšfo
 *
	mdevs
;

971 
su³¹y³
 *
su³r_by_fd
(
fd
, **
sub¬¿y
);

972 
	eguess_ty³s
 { 
	mguess_ªy
, 
	mguess_¬¿y
, 
	mguess_·¹™iÚs
 };

973 
su³¹y³
 *
guess_su³r_ty³
(
fd
, 
guess_ty³s
 
guess_ty³
);

974 
šlše
 
su³¹y³
 *
	$guess_su³r
(
fd
) {

975  
	`guess_su³r_ty³
(
fd
, 
guess_ªy
);

976 
	}
}

977 
su³¹y³
 *
dup_su³r
(su³¹y³ *
¡
);

978 
g‘_dev_size
(
fd
, *
dÇme
, *
siz•
);

979 
mu¡_be_cÚš”
(
fd
);

980 
dev_size_äom_id
(
dev_t
 
id
, *
size
);

981 
wa™_fÜ
(*
dev
, 
fd
);

989 
	sdev_pŞicy
 {

990 
dev_pŞicy
 *
	mÃxt
;

991 *
	mÇme
;

996 cÚ¡ *
	mm‘ad©a
;

997 cÚ¡ *
	mv®ue
;

1000 
pŞ_aù
[], 
pŞ_domaš
[], 
pŞ_m‘ad©a
[], 
pŞ_auto
[];

1006 
	#pŞ_fÜ_—ch
(
™em
, 
li¡
, 
_m‘ad©a
) \

1007 
™em
 = 
li¡
; \

1008 
™em
 && i‹m->
Çme
 =ğ
li¡
->name; \

1009 
™em
 = i‹m->
Ãxt
) \

1010 ià(!(!
_m‘ad©a
 || !
™em
->
m‘ad©a
 || _metadata == item->metadata)) \

1011 ; 

	)

1017 
	spŞ_ruË
 {

1018 
pŞ_ruË
 *
	mÃxt
;

1019 *
	mty³
;

1020 
	sruË
 {

1021 
ruË
 *
	mÃxt
;

1022 *
	mÇme
;

1023 *
	mv®ue
;

1024 *
	mdups
;

1025 } *
	mruË
;

1028 
ruË_pŞicy
[], 
ruË_·¹
[];

1029 
ruË_·th
[], 
ruË_ty³
[];

1030 
ty³_·¹
[], 
ty³_disk
[];

1032 
pŞicylše
(*
lše
, *
ty³
);

1033 
pŞicy_add
(*
ty³
, ...);

1034 
pŞicy_ä“
();

1036 
dev_pŞicy
 *
·th_pŞicy
(*
·th
, *
ty³
);

1037 
dev_pŞicy
 *
disk_pŞicy
(
mdšfo
 *
disk
);

1038 
dev_pŞicy
 *
devid_pŞicy
(
devid
);

1039 
dev_pŞicy_ä“
(
dev_pŞicy
 *
p
);

1042 
pŞ_add
(
dev_pŞicy
 **
pŞ
, *
Çme
, *
v®
, *
m‘ad©a
);

1043 
dev_pŞicy
 *
pŞ_fšd
(dev_pŞicy *
pŞ
, *
Çme
);

1045 
	epŞicy_aùiÚ
 {

1046 
	maù_deçuÉ
,

1047 
	maù_šşude
,

1048 
	maù_»_add
,

1049 
	maù_¥¬e
,

1050 
	maù_¥¬e_§me_¦Ù
,

1052 
	maù_fÜû_¥¬e
,

1053 
	maù_”r


1056 
pŞicy_aùiÚ_®lows
(
dev_pŞicy
 *
¶i¡
, cÚ¡ *
m‘ad©a
,

1057 
pŞicy_aùiÚ
 
wªt
);

1058 
disk_aùiÚ_®lows
(
mdšfo
 *
disk
, cÚ¡ *
m‘ad©a
,

1059 
pŞicy_aùiÚ
 
wªt
);

1061 
	sdomašli¡
 {

1062 
domašli¡
 *
	mÃxt
;

1063 cÚ¡ *
	mdom
;

1066 
domaš_‹¡
(
domašli¡
 *
dom
, 
dev_pŞicy
 *
pŞ
,

1067 cÚ¡ *
m‘ad©a
);

1068 
domašli¡
 *
domaš_äom_¬¿y
(
mdšfo
 *
mdi
,

1069 cÚ¡ *
m‘ad©a
);

1070 
domašli¡_add_dev
(
domašli¡
 **
dom
, 
devid
,

1071 cÚ¡ *
m‘ad©a
);

1072 
domaš_ä“
(
domašli¡
 *
dl
);

1073 
domaš_m”ge
(
domašli¡
 **
domp
, 
dev_pŞicy
 *
pŞ
,

1074 cÚ¡ *
m‘ad©a
);

1075 
domaš_add
(
domašli¡
 **
domp
, *
domaš
);

1077 
pŞicy_§ve_·th
(*
id_·th
, 
m­_’t
 *
¬¿y
);

1078 
pŞicy_check_·th
(
mdšfo
 *
disk
, 
m­_’t
 *
¬¿y
);

1080 #ià
__GNUC__
 < 3

1081 
	g¡©64
;

1084 
	#HAVE_NFTW
 
we
 
assume


	)

1085 
	#HAVE_FTW


	)

1087 #ifdeà
__UCLIBC__


1088 
	~<ã©u»s.h
>

1089 #iâdeà
__UCLIBC_HAS_LFS__


1090 
	#l£ek64
 
l£ek


	)

1092 #iâdeà 
__UCLIBC_HAS_FTW__


1093 #undeà
HAVE_FTW


1094 #undeà
HAVE_NFTW


1098 #ifdeà
__d›ibc__


1099 #undeà
HAVE_NFTW


1102 #ià
defšed
(
__KLIBC__
)

1103 #undeà
HAVE_NFTW


1104 #undeà
HAVE_FTW


1107 #iâdeà
HAVE_NFTW


1108 
	#FTW_PHYS
 1

	)

1109 #iâdeà
HAVE_FTW


1110 
	sFTW
 {};

1114 #ifdeà
HAVE_FTW


1115 
	~<áw.h
>

1118 
add_dev
(cÚ¡ *
Çme
, cÚ¡ 
¡©
 *
¡b
, 
æag
, 
FTW
 *
s
);

1120 
Mªage_ro
(*
devÇme
, 
fd
, 
»adÚly
);

1121 
Mªage_run
(*
devÇme
, 
fd
, 
cÚ‹xt
 *
c
);

1122 
Mªage_¡İ
(*
devÇme
, 
fd
, 
qu›t
,

1123 
wl_»Œy
);

1124 
Mªage_subdevs
(*
devÇme
, 
fd
,

1125 
mddev_dev
 *
devli¡
, 
v”bo£
, 
‹¡
,

1126 *
upd©e
, 
fÜû
);

1127 
autod‘eù
();

1128 
Grow_Add_deviû
(*
devÇme
, 
fd
, *
Ãwdev
);

1129 
Grow_addb™m­
(*
devÇme
, 
fd
,

1130 
cÚ‹xt
 *
c
, 
sh­e
 *
s
);

1131 
Grow_»sh­e
(*
devÇme
, 
fd
,

1132 
mddev_dev
 *
devli¡
,

1133 
d©a_off£t
,

1134 
cÚ‹xt
 *
c
, 
sh­e
 *
s
);

1135 
Grow_»¡¬t
(
su³¹y³
 *
¡
, 
mdšfo
 *
šfo
,

1136 *
fdli¡
, 
út
, *
backup_fe
, 
v”bo£
);

1137 
Grow_cÚtšue
(
mdfd
, 
su³¹y³
 *
¡
,

1138 
mdšfo
 *
šfo
, *
backup_fe
,

1139 
fÜked
, 
ä“ze_»sh­e
);

1141 
»¡Üe_backup
(
su³¹y³
 *
¡
,

1142 
mdšfo
 *
cÚ‹Á
,

1143 
wÜkšg_disks
,

1144 
¥¬es
,

1145 **
backup_f•
,

1146 
v”bo£
);

1147 
Grow_cÚtšue_commªd
(*
devÇme
, 
fd
,

1148 *
backup_fe
, 
v”bo£
);

1150 
As£mbË
(
su³¹y³
 *
¡
, *
mddev
,

1151 
mddev_id’t
 *
id’t
,

1152 
mddev_dev
 *
devli¡
,

1153 
cÚ‹xt
 *
c
);

1155 
Bud
(*
mddev
, 
mddev_dev
 *
devli¡
,

1156 
sh­e
 *
s
, 
cÚ‹xt
 *
c
);

1158 
C»©e
(
su³¹y³
 *
¡
, *
mddev
,

1159 *
Çme
, *
uuid
,

1160 
subdevs
, 
mddev_dev
 *
devli¡
,

1161 
sh­e
 *
s
,

1162 
cÚ‹xt
 *
c
,

1163 
d©a_off£t
);

1165 
D‘a
(*
dev
, 
cÚ‹xt
 *
c
);

1166 
D‘a_PÏtfÜm
(
su³rsw™ch
 *
ss
, 
sÿn
, 
v”bo£
, 
_expÜt
, *
cÚŒŞËr_·th
);

1167 
D‘a_ToA¼ayD‘a
(cÚ¡ *
dev
, 
cÚ‹xt
 *
c
, 
¬¿y_d‘a
 *
ad
);

1168 
Qu”y
(*
dev
);

1169 
ExamšeBadblocks
(*
devÇme
, 
br›f
, 
su³¹y³
 *
fÜû¡
);

1170 
Examše
(
mddev_dev
 *
devli¡
, 
cÚ‹xt
 *
c
,

1171 
su³¹y³
 *
fÜû¡
);

1172 
Examše_ToResuÉ
(
mddev_dev
 *
devli¡
,

1173 
cÚ‹xt
 *
c
,

1174 
su³¹y³
 *
fÜû¡
,

1175 
examše_»suÉ
 *
»suÉ
);

1176 
MÚ™Ü
(
mddev_dev
 *
devli¡
,

1177 *
maaddr
, *
®”t_cmd
,

1178 
cÚ‹xt
 *
c
,

1179 
d«mÚi£
, 
ÚeshÙ
,

1180 
dosy¦og
, *
pidfe
, 
šüem’ts
,

1181 
sh¬e
);

1183 
Kl
(*
dev
, 
su³¹y³
 *
¡
, 
fÜû
, 
v”bo£
, 
nÛxş
);

1184 
Kl_sub¬¿y
(*
dev
, *
sub¬¿y
, 
v”bo£
);

1185 
Upd©e_sub¬¿y
(*
dev
, *
sub¬¿y
, *
upd©e
, 
mddev_id’t
 *
id’t
, 
qu›t
);

1186 
Wa™
(*
dev
);

1187 
Wa™CËª
(*
dev
, 
sock
, 
v”bo£
);

1188 
S‘AùiÚ
(*
dev
, *
aùiÚ
);

1190 
Inüem’l
(
mddev_dev
 *
devli¡
, 
cÚ‹xt
 *
c
,

1191 
su³¹y³
 *
¡
);

1192 
RebudM­
();

1193 
Inüem’lSÿn
(
cÚ‹xt
 *
c
, *
devnm
);

1194 
Inüem’lRemove
(*
devÇme
, *
·th
, 
v”bo£
);

1195 
C»©eB™m­
(*
f’ame
, 
fÜû
, 
uuid
[16],

1196 
chunksize
, 
d«mÚ_¦“p
,

1197 
wr™e_behšd
,

1198 
¬¿y_size
,

1199 
majÜ
);

1200 
ExamšeB™m­
(*
f’ame
, 
br›f
, 
su³¹y³
 *
¡
);

1201 
Wr™e_ruËs
(*
ruË_Çme
);

1202 
b™m­_upd©e_uuid
(
fd
, *
uuid
, 
sw­
);

1203 
b™m­_£ùÜs
(
b™m­_su³r_s
 *
bsb
);

1204 
Dump_m‘ad©a
(*
dev
, *
dœ
, 
cÚ‹xt
 *
c
,

1205 
su³¹y³
 *
¡
);

1206 
Re¡Üe_m‘ad©a
(*
dev
, *
dœ
, 
cÚ‹xt
 *
c
,

1207 
su³¹y³
 *
¡
, 
Úly
);

1209 
md_g‘_v”siÚ
(
fd
);

1210 
g‘_lšux_v”siÚ
();

1211 
mdadm_v”siÚ
(*
v”siÚ
);

1212 
·r£_size
(*
size
);

1213 
·r£_uuid
(*
¡r
, 
uuid
[4]);

1214 
·r£_Ïyout_10
(*
Ïyout
);

1215 
·r£_Ïyout_çuÉy
(*
Ïyout
);

1216 
·r£_num
(*
num
);

1217 
check_ext2
(
fd
, *
Çme
);

1218 
check_»i£r
(
fd
, *
Çme
);

1219 
check_¿id
(
fd
, *
Çme
);

1220 
check_·¹™iÚs
(
fd
, *
dÇme
,

1221 
ä“size
,

1222 
size
);

1224 
g‘_mdp_majÜ
();

1225 
g‘_maj_mš
(*
dev
, *
majÜ
, *
mšÜ
);

1226 
dev_İ’
(*
dev
, 
æags
);

1227 
İ’_dev
(*
devnm
);

1228 
»İ’_mddev
(
mdfd
);

1229 
İ’_dev_æags
(*
devnm
, 
æags
);

1230 
İ’_dev_exş
(*
devnm
);

1231 
is_¡ªd¬d
(*
dev
, *
nump
);

1232 
§me_dev
(*
Úe
, *
two
);

1233 
com·»_·ths
 (* 
·th1
,* 
·th2
);

1234 
’abË_fds
(
deviûs
);

1236 
·r£_auto
(*
¡r
, *
msg
, 
cÚfig
);

1237 
mddev_id’t
 *
cÚf_g‘_id’t
(*
dev
);

1238 
mddev_dev
 *
cÚf_g‘_devs
();

1239 
cÚf_‹¡_dev
(*
devÇme
);

1240 
cÚf_‹¡_m‘ad©a
(cÚ¡ *
v”siÚ
, 
dev_pŞicy
 *
pŞ
, 
is_homeho¡
);

1241 
ü—‹šfo
 *
cÚf_g‘_ü—‹_šfo
();

1242 
£t_cÚffe
(*
fe
);

1243 *
cÚf_g‘_maaddr
();

1244 *
cÚf_g‘_maäom
();

1245 *
cÚf_g‘_´og¿m
();

1246 *
cÚf_g‘_homeho¡
(*
»quœe_homeho¡p
);

1247 *
cÚf_lše
(
FILE
 *
fe
);

1248 *
cÚf_wÜd
(
FILE
 *
fe
, 
®low_key
);

1249 
´št_quÙed
(*
¡r
);

1250 
´št_esÿ³
(*
¡r
);

1251 
u£_udev
();

1252 
GCD
(
a
, 
b
);

1253 
cÚf_Çme_is_ä“
(*
Çme
);

1254 
cÚf_v”ify_devÇmes
(
mddev_id’t
 *
¬¿y_li¡
);

1255 
devÇme_m©ches
(*
Çme
, *
m©ch
);

1256 
mddev_id’t
 *
cÚf_m©ch
(
su³¹y³
 *
¡
,

1257 
mdšfo
 *
šfo
,

1258 *
devÇme
,

1259 
v”bo£
, *
rvp
);

1260 
ex³rim’l
();

1262 
ä“_lše
(*
lše
);

1263 
m©ch_Úeof
(*
deviûs
, *
devÇme
);

1264 
uuid_äom_su³r
(
uuid
[4], 
mdp_su³r_t
 *
su³r
);

1265 cÚ¡ 
uuid_z”o
[4];

1266 
§me_uuid
(
a
[4], 
b
[4], 
sw­uuid
);

1267 
cİy_uuid
(*
a
, 
b
[4], 
sw­uuid
);

1268 *
__âame_äom_uuid
(
id
[4], 
sw­
, *
buf
, 
£p
);

1269 *
âame_äom_uuid
(
su³¹y³
 *
¡
,

1270 
mdšfo
 *
šfo
, *
buf
, 
£p
);

1271 
ÿlc_csum
(*
su³r
, 
by‹s
);

1272 
’ough
(
Ëv–
, 
¿id_disks
, 
Ïyout
, 
ş—n
,

1273 *
ava
);

1274 
’ough_fd
(
fd
);

1275 
ask
(*
mesg
);

1276 
g‘_compÚ’t_size
(
fd
);

1277 
»move_·¹™iÚs
(
fd
);

1278 
‹¡_·¹™iÚ
(
fd
);

1279 
‹¡_·¹™iÚ_äom_id
(
dev_t
 
id
);

1280 
g‘_d©a_disks
(
Ëv–
, 
Ïyout
, 
¿id_disks
);

1281 
ÿlc_¬¿y_size
(
Ëv–
, 
¿id_disks
, 
Ïyout
,

1282 
chunksize
, 
devsize
);

1283 
æush_m‘ad©a_upd©es
(
su³¹y³
 *
¡
);

1284 
­³nd_m‘ad©a_upd©e
(
su³¹y³
 *
¡
, *
buf
, 
Ën
);

1285 
as£mbË_cÚš”_cÚ‹Á
(
su³¹y³
 *
¡
, 
mdfd
,

1286 
mdšfo
 *
cÚ‹Á
,

1287 
cÚ‹xt
 *
c
,

1288 *
cho£n_Çme
, *
»suÉ
);

1289 
	#INCR_NO
 1

	)

1290 
	#INCR_UNSAFE
 2

	)

1291 
	#INCR_ALREADY
 4

	)

1292 
	#INCR_YES
 8

	)

1293 
mdšfo
 *
cÚš”_choo£_¥¬es
(
su³¹y³
 *
¡
,

1294 
mš_size
,

1295 
domašli¡
 *
domli¡
,

1296 *
¥¬e_group
,

1297 cÚ¡ *
m‘ad©a
, 
g‘_Úe
);

1298 
move_¥¬e
(*
äom_devÇme
, *
to_devÇme
, 
dev_t
 
devid
);

1299 
add_disk
(
mdfd
, 
su³¹y³
 *
¡
,

1300 
mdšfo
 *
¤a
, mdšfØ*
šfo
);

1301 
»move_disk
(
mdfd
, 
su³¹y³
 *
¡
,

1302 
mdšfo
 *
¤a
, mdšfØ*
šfo
);

1303 
£t_¬¿y_šfo
(
mdfd
, 
su³¹y³
 *
¡
, 
mdšfo
 *
šfo
);

1304 
mš_»cov”y_¡¬t
(
mdšfo
 *
¬¿y
);

1306 *
humª_size
(
by‹s
);

1307 *
humª_size_br›f
(
by‹s
, 
´efix
);

1308 
´št_r10_Ïyout
(
Ïyout
);

1310 *
fšd_ä“_devnm
(
u£_·¹™iÚs
);

1312 
put_md_Çme
(*
Çme
);

1313 *
devid2kÇme
(
devid
);

1314 *
devid2devnm
(
devid
);

1315 
devnm2devid
(*
devnm
);

1316 *
g‘_md_Çme
(*
devnm
);

1318 
DeçuÉCÚfFe
[];

1320 
ü—‹_mddev
(*
dev
, *
Çme
, 
autof
, 
Œu¡wÜthy
,

1321 *
cho£n
);

1323 
	#LOCAL
 1

	)

1324 
	#LOCAL_ANY
 10

	)

1325 
	#FOREIGN
 2

	)

1326 
	#METADATA
 3

	)

1327 
İ’_mddev
(*
dev
, 
»pÜt_”rÜs
);

1328 
İ’_cÚš”
(
fd
);

1329 
m‘ad©a_cÚš”_m©ches
(*
m‘ad©a
, *
devnm
);

1330 
m‘ad©a_subdev_m©ches
(*
m‘ad©a
, *
devnm
);

1331 
is_cÚš”_memb”
(
md¡©_’t
 *
’t
, *
devÇme
);

1332 
is_sub¬¿y_aùive
(*
sub¬¿y
, *
devÇme
);

1333 
İ’_sub¬¿y
(*
dev
, *
sub¬¿y
, 
su³¹y³
 *
¡
, 
qu›t
);

1334 
su³rsw™ch
 *
v”siÚ_to_su³rsw™ch
(*
v”s
);

1336 
mdmÚ_ruÂšg
(*
devnm
);

1337 
mdmÚ_pid
(*
devnm
);

1338 
check_’v
(*
Çme
);

1339 
__u32
 
¿ndom32
();

1340 
¡¬t_mdmÚ
(*
devnm
);

1342 
chd_mÚ™Ü
(
afd
, 
mdšfo
 *
¤a
, 
»sh­e
 *reshape,

1343 
su³¹y³
 *
¡
, 
¡res
,

1344 *
fds
, *
off£ts
,

1345 
de¡s
, *
de¡fd
, *
de¡off£ts
);

1346 
abÜt_»sh­e
(
mdšfo
 *
¤a
);

1348 *
su³r1_make_v0
(
su³¹y³
 *
¡
, 
mdšfo
 *
šfo
, 
mdp_su³r_t
 *
sb0
);

1350 
fmt_devÇme
(*
Çme
, 
num
);

1351 *
¡©2devnm
(
¡©
 *
¡
);

1352 *
fd2devnm
(
fd
);

1354 
š_š™rd
();

1356 
	#_ROUND_UP
(
v®
, 
ba£
è(((v®è+ (ba£è- 1è& ~(ba£ - 1))

	)

1357 
	#ROUND_UP
(
v®
, 
ba£
è
	`_ROUND_UP
(v®, (
	`ty³of
(v®))(ba£))

	)

1358 
	#ROUND_UP_PTR
(
±r
, 
ba£
è((
	`ty³of
(ptr)) \

1359 (
	`ROUND_UP
(()(
±r
), 
ba£
)))

	)

1361 
šlše
 
	$is_sub¬¿y
(*
v”s
)

1372  (*
v”s
 == '/' || *vers == '-');

1373 
	}
}

1375 
šlše
 *
	$to_sub¬¿y
(
md¡©_’t
 *
’t
, *
cÚš”
)

1377  &
’t
->
m‘ad©a_v”siÚ
[10+
	`¡¾’
(
cÚš”
)+1];

1378 
	}
}

1380 #ifdeà
DEBUG


1381 
	#d´štf
(
fmt
, 
¬g
...) \

1382 
	`årštf
(
¡d”r
, 
fmt
, ##
¬g
)

	)

1384 
	#d´štf
(
fmt
, 
¬g
...) \

1385 ({ ià(0è
	`årštf
(
¡d”r
, 
fmt
, ##
¬g
); 0; })

	)

1387 
	~<as£¹.h
>

1388 
	~<¡d¬g.h
>

1389 
šlše
 
	$xa¥rštf
(**
¡½
, cÚ¡ *
fmt
, ...) {

1390 
va_li¡
 
­
;

1391 
»t
;

1392 
	`va_¡¬t
(
­
, 
fmt
);

1393 
»t
 = 
	`va¥rštf
(
¡½
, 
fmt
, 
­
);

1394 
	`va_’d
(
­
);

1395 
	`as£¹
(
»t
 >= 0);

1396  
»t
;

1397 
	}
}

1399 #ifdeà
DEBUG


1400 
	#´_”r
(
fmt
 ...è
	`årštf
(
¡d”r
, 
Name
 ": " fmt)

	)

1401 
	#cÚt_”r
(
fmt
 ...è
	`årštf
(
¡d”r
, " " fmt)

	)

1403 
	#´_”r
(
fmt
 ...è({ ià(0è
	`årštf
(
¡d”r
, 
Name
 ": " fmt); })

	)

1404 
	#cÚt_”r
(
fmt
 ...è({ ià(0è
	`årštf
(
¡d”r
, " " fmt); })

	)

1407 *
xm®loc
(
size_t
 
Ën
);

1408 *
x»®loc
(*
±r
, 
size_t
 
Ën
);

1409 *
xÿÎoc
(
size_t
 
num
, size_ˆ
size
);

1410 *
x¡rdup
(cÚ¡ *
¡r
);

1412 
	#LEVEL_MULTIPATH
 (-4)

	)

1413 
	#LEVEL_LINEAR
 (-1)

	)

1414 
	#LEVEL_FAULTY
 (-5)

	)

1417 
	#LEVEL_CONTAINER
 (-100)

	)

1418 
	#LEVEL_UNSUPPORTED
 (-200)

	)

1421 
	#LEVEL_NONE
 (-1000000)

	)

1425 
	#Wr™eT¿ns›Á
 0

	)

1426 
	#R—dT¿ns›Á
 1

	)

1427 
	#Wr™eP”si¡’t
 2

	)

1428 
	#R—dP”si¡’t
 3

	)

1429 
	#Wr™eAÎ
 4

	)

1430 
	#R—dFixabË
 5

	)

1431 
	#Modes
 6

	)

1433 
	#CË¬E¼Üs
 31

	)

1434 
	#CË¬FauÉs
 30

	)

1436 
	#AÎP”si¡
 100

	)

1437 
	#NoP”si¡
 101

	)

1439 
	#ModeMask
 0x1f

	)

1440 
	#ModeShiá
 5

	)

1442 #ifdeà
__TINYC__


1443 #undeà
mšÜ


1444 #undeà
majÜ


1445 #undeà
makedev


1446 
	#mšÜ
(
x
è((x)&0xff)

	)

1447 
	#majÜ
(
x
è(((x)>>8)&0xff)

	)

1448 
	#makedev
(
M
,
m
è(((M)<<8è| (m))

	)

1452 
	#ALGORITHM_LEFT_ASYMMETRIC
 0

	)

1453 
	#ALGORITHM_RIGHT_ASYMMETRIC
 1

	)

1454 
	#ALGORITHM_LEFT_SYMMETRIC
 2

	)

1455 
	#ALGORITHM_RIGHT_SYMMETRIC
 3

	)

1460 
	#ALGORITHM_PARITY_0
 4

	)

1461 
	#ALGORITHM_PARITY_N
 5

	)

1475 
	#ALGORITHM_ROTATING_ZERO_RESTART
 8

	)

1476 
	#ALGORITHM_ROTATING_N_RESTART
 9

	)

1477 
	#ALGORITHM_ROTATING_N_CONTINUE
 10

	)

1484 
	#ALGORITHM_LEFT_ASYMMETRIC_6
 16

	)

1485 
	#ALGORITHM_RIGHT_ASYMMETRIC_6
 17

	)

1486 
	#ALGORITHM_LEFT_SYMMETRIC_6
 18

	)

1487 
	#ALGORITHM_RIGHT_SYMMETRIC_6
 19

	)

1488 
	#ALGORITHM_PARITY_0_6
 20

	)

1489 
	#ALGORITHM_PARITY_N_6
 
ALGORITHM_PARITY_N


	)

1494 #iâdeà
PATH_MAX


1495 
	#PATH_MAX
 4096

	)

1498 
	#RESYNC_NONE
 -1

	)

1499 
	#RESYNC_DELAYED
 -2

	)

1500 
	#RESYNC_PENDING
 -3

	)

1501 
	#RESYNC_UNKNOWN
 -4

	)

1509 
	#MAX_DISKS
 4096

	)

1514 
	#MAX_SIZE
 1

	)

1519 
	#INVALID_SECTORS
 1

	)

1521 
	#VARIABLE_OFFSET
 3

	)

1523 
	#V”siÚ
 "NUUO"

	)

	@libmdadm/mdadm_errcode.h

1 #iâdeà
__MDADM_ERRORCODE__


2 
	#__MDADM_ERRORCODE__


	)

5 
	mSUCCESS
 = 0,

7 
	mCREATE_RAID_LEVEL_UNSET
 = 1,

8 
	mCREATE_RAID_DEVS_NOT_ENOUGH
,

9 
	mCREATE_RAID_DEVS_OVER_256
,

10 
	mCREATE_RAID_DEVS_NOT_EXIST_IN_LIST
,

11 
	mCREATE_SPARE_DEVS_NOT_SUPPORT
,

12 
	mCREATE_LIST_DEVS_MORE_THAN_ARRAY_NEEDED
,

13 
	mCREATE_BITMAP_NOT_MEANINGFUL
,

14 
	mCREATE_RAID_LEVEL_UNKNOWN
,

15 
	mCREATE_GEOMETRY_INVALID
,

16 
	mCREATE_RAID_DEV_CANNOT_OPEN
,

17 
	mCREATE_NOT_BLOCK_DEVICE
,

18 
	mCREATE_UNSUITABLE_STYLE
,

19 
	mCREATE_TOO_MANY_DEVS
,

20 
	mCREATE_NO_FREE_SPACE
,

21 
	mCREATE_FREE_SPACE_SMALL_THAN_GIVEN
,

22 
	mCREATE_WITHOUT_GIVEN_SIZE_DRIVES
,

23 
	mCREATE_DEVS_TOO_LARGE
,

24 
	mCREATE_ABORTED
,

25 
	mCREATE_MISSING_DEVS_NOT_SUPPORT
,

26 
	mCREATE_MDDEV_FAIL
,

27 
	mCREATE_MDDEV_INUSE
,

28 
	mCREATE_MDDEV_UNSET
,

29 
	mCREATE_MDNUM_ILLEGAL
,

30 
	mCREATE_REQUIRE_NEWER_VERSION
,

31 
	mCREATE_INIT_SUPER_FAIL
,

32 
	mCREATE_BITMAP_NOT_SUPPORT
,

33 
	mCREATE_BITMAP_CHUNK_NOT_SUPPORT
,

34 
	mCREATE_OPEN_CONTAINER_FAIL
,

35 
	mCREATE_SET_ARRAY_INFO_FAIL
,

36 
	mCREATE_BITMAP_FAIL
,

37 
	mCREATE_OPEN_BITMAP_FILE_FAIL
,

38 
	mCREATE_SET_BITMAP_FILE_FAIL
,

39 
	mCREATE_ADD_TO_SUPER_FAIL
,

40 
	mCREATE_ADD_NEW_DISK_FAIL
,

41 
	mCREATE_FREE_SUPER_TYPE_OBJ_FAIL
,

42 
	mCREATE_RAID_ACTIVATION_FAIL
,

45 
	mDETAIL_MDDEV_OPEN_FAIL
 = 101,

46 
	mDETAIL_MDDEV_ILLEGAL
,

47 
	mDETAIL_MDDEV_REQUIRE_NEWER_DRIVER
,

48 
	mDETAIL_MDDEV_CANNOT_GET_DETAIL
,

50 
	mMANAGE_STOP_MD_FAIL
 = 201,

51 
	mMANAGE_MD_IN_USE
,

52 
	mMANAGE_DEVICE_BUSY
,

53 
	mMANAGE_STOP_CONTAINER_FAIL
,

54 
	mMANAGE_GET_ARRAY_INFO_FAIL
,

55 
	mMANAGE_UNSUPPORTED_ARRAY
,

56 
	mMANAGE_NEED_MEANINGFUL_DISPOSITION
,

57 
	mMANAGE_NOT_MEANINGFUL_FOR_R10
,

58 
	mMANAGE_NOT_MEANINGFUL_FOR_ARRAY
,

59 
	mMANAGE_OPEN_SYSFD_FAIL
,

60 
	mMANAGE_CANNOT_FIND_DEV
,

61 
	mMANAGE_NOT_BLOCK_DEV
,

62 
	mMANAGE_CANNOT_OPEN_DEV
,

63 
	mMANAGE_CANNOT_ADD_DISKS_TO_MEMBER_ARRAY
,

64 
	mMANAGE_SET_FAULTY_FAIL
,

65 
	mMANAGE_NO_MATCHING_DEV
,

66 
	mMANAGE_WITH_ARG_FAIL
,

67 
	mMANAGE_CANNOT_REMOVE_DISKS_FROM_MEMBER_ARRAY
,

68 
	mMANAGE_ADD_GET_DEV_SIZE_FAIL
 = 251,

69 
	mMANAGE_ADD_WASTED_DEV_SIZE
,

70 
	mMANAGE_ADD_HOT_ADD_FAIL
,

71 
	mMANAGE_ADD_CANNOT_LOAD_ARRAY_METADATA
,

72 
	mMANAGE_ADD_DEV_SIZE_NOT_LARGE_ENOUGH
,

73 
	mMANAGE_ADD_READD_IMPOSSIBLE
,

74 
	mMANAGE_ADD_ARRAY_FAILED
,

75 
	mMANAGE_ADD_UPDATE_SUPERBLOCK_FAIL
,

76 
	mMANAGE_ADD_WRITE_INIT_SUPERBLOCK_FAIL
,

77 
	mMANAGE_ADD_CANNOT_GET_EXCLUSIVE_ACCESS
,

78 
	mMANAGE_ADD_READ_SYSFS_FAIL
,

79 
	mMANAGE_ADD_ADD_NEW_DEVS_FAIL
,

80 
	mMANAGE_REMOVE_CANNOT_GET_EXCLUSIVE_ACCESS
 = 271,

81 
	mMANAGE_REMOVE_NOT_MEMBER
,

82 
	mMANAGE_REMOVE_IN_USE
,

83 
	mMANAGE_REMOVE_HOT_REMOVE_FAIL
,

84 
	mMANAGE_REMOVE_GET_CONTAINER_NAME_FAIL
,

85 
	mMANAGE_REPLACE_UNSUPPORTED_METADATA_VER
 = 291,

86 
	mMANAGE_REPLACE_CANNOT_FIND_MD_INFO
,

87 
	mMANAGE_REPLACE_DISK_NOT_ACTIVE
,

88 
	mMANAGE_REPLACE_REQUEST_REPLACEMENT_FAIL
,

89 
	mMANAGE_REPLACE_MD_NOT_FOUND
,

90 
	mMANAGE_WITH_CANNOT_FOUND_MD_INFO
 = 311,

91 
	mMANAGE_WITH_FAULTY_DISK
,

92 
	mMANAGE_WITH_ACTIVE_DISK
,

93 
	mMANAGE_WITH_PREFER_REPLACEMENT_FAIL
,

94 
	mMANAGE_WITH_MD_NOT_FOUND
,

97 
	mASSEMBLE_NO_IDENTITY_INFO
 = 401,

98 
	mASSEMBLE_RAID_DEVS_NOT_ENOUGH
,

99 
	mASSEMBLE_NEGATIVE_NUM_DEVICES
,

100 
	mASSEMBLE_SUPER_INFO_IS_NULL
,

101 
	mASSEMBLE_DRIVE_IS_ACTIVE
,

102 
	mASSEMBLE_INVALID_MDFD
,

103 
	mASSEMBLE_KERNEL_UNSUPPORT
,

104 
	mASSEMBLE_MD_ALREADY_ACTIVE
,

105 
	mASSEMBLE_CONTAINER_CONTENT_FAIL
,

106 
	mASSEMBLE_NEGATIVE_DEV_CNT
,

107 
	mASSEMBLE_NO_DEVS_FOR_MD
,

108 
	mASSEMBLE_OPEN_DEV_FAIL
,

109 
	mASSEMBLE_SUPERBLOCK_DISAPPEARED
,

110 
	mASSEMBLE_NO_SUITABLE_DRIVES
,

111 
	mASSEMBLE_REWRITE_SUPERBLOCK_FAIL
,

112 
	mASSEMBLE_FAIL
,

113 
	mASSEMBLE_MDDEV_UNSET
,

114 
	mASSEMBLE_RAID_DEVS_NOT_EXIST_IN_LIST
,

115 
	mASSEMBLE_INVALID_UUID
,

116 
	mASSEMBLE_MDDEV_INUSE
,

117 
	mASSEMBLE_MDNUM_ILLEGAL
,

118 
	mASSEMBLE_INITIALIZE_DEV_LIST_FAIL
,

119 
	mASSEMBLE_FAIL_TO_SET_ARRAY_INFO
,

120 
	mASSEMBLE_FAIL_TO_SET_BITMAP_FILE
,

121 
	mASSEMBLE_FAIL_TO_OPEN_BITMAP_FILE
,

122 
	mASSEMBLE_NEED_BACKUP_FILE
,

123 
	mASSEMBLE_UNDEFINED_ERROR
,

125 
	mKILL_OPEN_DEV_FAIL
 = 501,

126 
	mKILL_NOT_MD_COMPONENT
,

127 
	mKILL_ZERO_SUPERBLOCK_FAIL
,

129 
	mQUERY_OPEN_DEV_FAIL
 = 551,

130 
	mQUERY_NULL_POINTER
,

131 
	mEXAMINE_OPEN_DEV_FAIL
 = 601,

132 
	mEXAMINE_NO_MD_SUPERBLOCK
,

133 
	mEXAMINE_MEM_ALLOC_FAIL
,

134 
	mEXAMINE_NULL_POINTER


	@libmdadm/mdadm_other.h

1 #iâdeà
__MDADM_OTHER_H__


2 
	#__MDAMM_OTHER_H__


	)

4 
	#MAX_DISK_NUM
 64

	)

8 
	mRAID_STATUS_BIT_FUNCTIONAL
 = 0,

9 
	mRAID_STATUS_BIT_DEGRADE
,

10 
	mRAID_STATUS_BIT_FAILED
,

11 
	mRAID_STATUS_BIT_RECOVERING
,

12 
	mRAID_STATUS_BIT_UNMOUNTED
,

13 
	mRAID_STATUS_BIT_UNFORMATED
,

14 
	mRAID_STATUS_BIT_FILESYS_ERR
,

17 
	s¬¿y_disk_šfo
 {

18 
mdu_disk_šfo_t
 
	mdiskInfo
;

19 
	m¡rS‹
[256];

20 
	m¡rDevName
[64];

23 
	s¬¿y_d‘a
 {

24 
mdu_¬¿y_šfo_t
 
	m¬¿yInfo
;

25 
¬¿y_disk_šfo
 
	m¬¿yDisks
[
MAX_DISK_NUM
];

27 
	m¡rA¼ayS‹
[128];

28 
	m¡rA¼ayDevName
[32];

29 
	m¡rRaidLev–
[16];

30 
	m¡rRaidLayout
[32];

31 
	m¡rA¼aySize
[32];

32 
	m¡rU£dSize
[32];

33 
	m¡rRebudO³¿tiÚ
[16];

34 
	muÎA¼aySize
;

35 
	muÎU£dSize
;

36 
	muuid
[4];

37 
	mbIsSu³rBlockP”si¡’t
;

38 
	mbIÇùive
;

39 
	mbIsRebudšg
;

40 
	miRebudProg»ss
;

42 
	m¡rCÚš”
[32];

43 
	m¡rMemb”
[32];

46 
	mbResh­eAùive
;

47 
	miD–Disks
;

48 
	miRaidNewLev–
;

49 
	miNewChunkSize
;

50 
	muÎResh­eProg»ss
;

51 
	m¡rRaidNewLayout
[32];

54 
	squ”y_»suÉ
 {

55 
	mbIsMD
;

56 
	mbIsMDAùive
;

57 
	mbHasMDD‘a
;

58 
	mbHasMDE¼Ü
;

59 
	miMDRaidDiskNum
;

60 
	miMDS·»DiskNum
;

61 
	miMDRaidLev–
;

62 
	m¡rMDSize
[32];

63 
	m¡rMDLev–
[16];

64 
	m¡rMDDevName
[32];

65 
	m¡rMDE¼Ü
[128];

67 
	miDiskNumb”
;

68 
	m¡rDiskAùiv™y
[32];

69 
	m¡rDiskDevName
[32];

72 
	sexamše_»suÉ
 {

73 
	mcS‹
;

74 
	m¡rDevName
[32];

75 
	m¬¿yUUID
[4];

76 
	muRaidLev–
;

77 
	muRaidDiskNum
;

78 
	mbHasBadblock
;

79 
	mbSBChkSumE¼Ü
;

80 
	mbIsV®id
;

81 
	muChkSum
;

82 
	muEx³ùedChkSum
;

83 
	muDevRŞe
;

84 
examše_»suÉ
* 
	mÃxt
;

	@libmdadm/mdmon.h

21 #undeà
´_”r


22 
	#´_”r
(
fmt
 ...è
	`årštf
(
¡d”r
, "mdmÚ: " fmt)

	)

24 
	e¬¿y_¡©e
 { 
	mş—r
, 
	mšaùive
, 
	msu¥’ded
, 
	m»adÚly
, 
	m»ad_auto
,

25 
	mş—n
, 
	maùive
, 
	mwr™e_³ndšg
, 
	maùive_idË
, 
	mbad_wÜd
};

27 
	esync_aùiÚ
 { 
	midË
, 
	m»sh­e
, 
	m»sync
, 
	m»cov”
, 
	mcheck
, 
	m»·œ
, 
	mbad_aùiÚ
 };

29 
	saùive_¬¿y
 {

30 
mdšfo
 
	mšfo
;

31 
su³¹y³
 *
	mcÚš”
;

32 
aùive_¬¿y
 *
	mÃxt
, *
	m»¶aûs
;

33 
	mto_»move
;

35 
	maùiÚ_fd
;

36 
	m»sync_¡¬t_fd
;

37 
	mm‘ad©a_fd
;

38 
	msync_com¶‘ed_fd
;

39 
	mÏ¡_checkpošt
;

48 
¬¿y_¡©e
 
	m´ev_¡©e
, 
	mcu¼_¡©e
, 
	mÃxt_¡©e
;

49 
sync_aùiÚ
 
	m´ev_aùiÚ
, 
	mcu¼_aùiÚ
, 
	mÃxt_aùiÚ
;

51 
	mcheck_deg¿ded
;

52 
	mcheck_»sh­e
;

66 
m‘ad©a_upd©e
 *
upd©e_queue
, *
upd©e_queue_hªdËd
;

68 
	#MD_MAJOR
 9

	)

70 
aùive_¬¿y
 *
cÚš”
;

71 
aùive_¬¿y
 *
disÿrd_this
;

72 
aùive_¬¿y
 *
³ndšg_disÿrd
;

73 
md_g’”ic_cmd
 *
aùive_cmd
;

75 
»move_pidfe
(*
devÇme
);

76 
do_mÚ™Ü
(
su³¹y³
 *
cÚš”
);

77 
do_mªag”
(
su³¹y³
 *
cÚš”
);

78 
sig‹rm
;

80 
»ad_dev_¡©e
(
fd
);

81 
is_cÚš”_memb”
(
md¡©_’t
 *
md¡©
, *
cÚš”
);

83 
md¡©_’t
 *
md¡©_»ad
(
hŞd
, 
¡¬t
);

85 
ex™_now
, 
mªag”_»ady
;

86 
mÚ_tid
, 
mgr_tid
;

87 
mÚ™Ü_loİ_út
;

92 
šlše
 
	$is_»sync_com¶‘e
(
mdšfo
 *
¬¿y
)

94 
sync_size
 = 0;

95 
ncİ›s
, 
l
;

96 
¬¿y
->¬¿y.
Ëv–
) {

101 
sync_size
 = 
¬¿y
->
compÚ’t_size
;

104 
l
 = 
¬¿y
->¬¿y.
Ïyout
;

105 
ncİ›s
 = (
l
 & 0xff) * ((l >> 8) && 0xff);

106 
sync_size
 = 
¬¿y
->
compÚ’t_size
 *‡¼ay->¬¿y.
¿id_disks
;

107 
sync_size
 /ğ
ncİ›s
;

110  
¬¿y
->
»sync_¡¬t
 >ğ
sync_size
;

111 
	}
}

	@libmdadm/msg.h

20 
	gmdšfo
;

21 
	gm‘ad©a_upd©e
;

23 
»ûive_mes§ge
(
fd
, 
m‘ad©a_upd©e
 *
msg
, 
tmo
);

24 
£nd_mes§ge
(
fd
, 
m‘ad©a_upd©e
 *
msg
, 
tmo
);

25 
ack
(
fd
, 
tmo
);

26 
wa™_»¶y
(
fd
, 
tmo
);

27 
cÚÃù_mÚ™Ü
(*
devÇme
);

28 
pšg_mÚ™Ü
(*
devÇme
);

29 
block_sub¬¿y
(
mdšfo
 *
¤a
);

30 
unblock_sub¬¿y
(
mdšfo
 *
¤a
, cÚ¡ 
unä“ze
);

31 
block_mÚ™Ü
(*
cÚš”
, cÚ¡ 
ä“ze
);

32 
unblock_mÚ™Ü
(*
cÚš”
, cÚ¡ 
unä“ze
);

33 
åšg_mÚ™Ü
(
sock
);

34 
pšg_mªag”
(*
devÇme
);

35 
æush_mdmÚ
(*
cÚš”
);

37 
	#MSG_MAX_LEN
 (4*1024*1024)

	)

	@libmdadm/part.h

29 
	#MBR_SIGNATURE_MAGIC
 
	`__ıu_to_Ë16
(0xAA55)

	)

30 
	#MBR_PARTITIONS
 4

	)

32 
	sMBR_·¹_»cÜd
 {

33 
__u8
 
	mboÙabË
;

34 
__u8
 
	mfœ¡_h—d
;

35 
__u8
 
	mfœ¡_£ùÜ
;

36 
__u8
 
	mfœ¡_cyl
;

37 
__u8
 
	m·¹_ty³
;

38 
__u8
 
	mÏ¡_h—d
;

39 
__u8
 
	mÏ¡_£ùÜ
;

40 
__u8
 
	mÏ¡_cyl
;

41 
__u32
 
	mfœ¡_£ù_lba
;

42 
__u32
 
	mblocks_num
;

45 
	sMBR
 {

46 
__u8
 
	m·d
[446];

47 
MBR_·¹_»cÜd
 
	m·¹s
[
MBR_PARTITIONS
];

48 
__u16
 
	mmagic
;

49 } 
__©Œibu‹__
((
·cked
));

51 
	#GPT_SIGNATURE_MAGIC
 
	`__ıu_to_Ë64
(0x5452415020494645ULL)

	)

52 
	#MBR_GPT_PARTITION_TYPE
 0xEE

	)

54 
	sGPT_·¹_’Œy
 {

55 
	mty³_guid
[16];

56 
	m·¹™iÚ_guid
[16];

57 
__u64
 
	m¡¬tšg_lba
;

58 
__u64
 
	m’dšg_lba
;

59 
	m©Œ_b™s
[8];

60 
	mÇme
[72];

61 } 
__©Œibu‹__
((
·cked
));

63 
	sGPT
 {

64 
__u64
 
	mmagic
;

65 
__u32
 
	m»visiÚ
;

66 
__u32
 
	mh—d”_size
;

67 
__u32
 
	müc
;

68 
__u32
 
	m·d1
;

69 
__u64
 
	mcu¼’t_lba
;

70 
__u64
 
	mbackup_lba
;

71 
__u64
 
	mfœ¡_lba
;

72 
__u64
 
	mÏ¡_lba
;

73 
__u8
 
	mguid
[16];

74 
__u64
 
	m·¹_¡¬t
;

75 
__u32
 
	m·¹_út
;

76 
__u32
 
	m·¹_size
;

77 
__u32
 
	m·¹_üc
;

78 
__u8
 
	m·d2
[420];

79 } 
__©Œibu‹__
((
·cked
));

	@libmdadm/platform-intel.h

19 
	~<asm/ty³s.h
>

20 
	~<¡ršgs.h
>

23 
	simsm_Üom
 {

24 
__u8
 
	msigÇtu»
[4];

25 
__u8
 
	mbË_v”_majÜ
;

26 
__u8
 
	mbË_v”_mšÜ
;

27 
__u16
 
	mmajÜ_v”
;

28 
__u16
 
	mmšÜ_v”
;

29 
__u16
 
	mhÙfix_v”
;

30 
__u16
 
	mbud
;

31 
__u8
 
	mËn
;

32 
__u8
 
	mchecksum
;

33 
__u16
 
	m¾c
;

37 
	#IMSM_OROM_RLC_RAID0
 (1 << 0)

	)

38 
	#IMSM_OROM_RLC_RAID1
 (1 << 1)

	)

39 
	#IMSM_OROM_RLC_RAID10
 (1 << 2)

	)

40 
	#IMSM_OROM_RLC_RAID1E
 (1 << 3)

	)

41 
	#IMSM_OROM_RLC_RAID5
 (1 << 4)

	)

42 
	#IMSM_OROM_RLC_RAID_CNG
 (1 << 5)

	)

43 
__u16
 
	msss
;

44 
	#IMSM_OROM_SSS_2kB
 (1 << 0)

	)

45 
	#IMSM_OROM_SSS_4kB
 (1 << 1)

	)

46 
	#IMSM_OROM_SSS_8kB
 (1 << 2)

	)

47 
	#IMSM_OROM_SSS_16kB
 (1 << 3)

	)

48 
	#IMSM_OROM_SSS_32kB
 (1 << 4)

	)

49 
	#IMSM_OROM_SSS_64kB
 (1 << 5)

	)

50 
	#IMSM_OROM_SSS_128kB
 (1 << 6)

	)

51 
	#IMSM_OROM_SSS_256kB
 (1 << 7)

	)

52 
	#IMSM_OROM_SSS_512kB
 (1 << 8)

	)

53 
	#IMSM_OROM_SSS_1MB
 (1 << 9)

	)

54 
	#IMSM_OROM_SSS_2MB
 (1 << 10)

	)

55 
	#IMSM_OROM_SSS_4MB
 (1 << 11)

	)

56 
	#IMSM_OROM_SSS_8MB
 (1 << 12)

	)

57 
	#IMSM_OROM_SSS_16MB
 (1 << 13)

	)

58 
	#IMSM_OROM_SSS_32MB
 (1 << 14)

	)

59 
	#IMSM_OROM_SSS_64MB
 (1 << 15)

	)

60 
__u16
 
	md·
;

61 
	#IMSM_OROM_DISKS_PER_ARRAY
 6

	)

62 
__u16
 
	mtds
;

63 
	#IMSM_OROM_TOTAL_DISKS
 6

	)

64 
__u8
 
	mv·
;

65 
	#IMSM_OROM_VOLUMES_PER_ARRAY
 2

	)

66 
__u8
 
	mvphba
;

67 
	#IMSM_OROM_VOLUMES_PER_HBA
 4

	)

72 
__u32
 
	m©Œ
;

73 
	#IMSM_OROM_ATTR_RAID0
 
IMSM_OROM_RLC_RAID0


	)

74 
	#IMSM_OROM_ATTR_RAID1
 
IMSM_OROM_RLC_RAID1


	)

75 
	#IMSM_OROM_ATTR_RAID10
 
IMSM_OROM_RLC_RAID10


	)

76 
	#IMSM_OROM_ATTR_RAID1E
 
IMSM_OROM_RLC_RAID1E


	)

77 
	#IMSM_OROM_ATTR_RAID5
 
IMSM_OROM_RLC_RAID5


	)

78 
	#IMSM_OROM_ATTR_RAID_CNG
 
IMSM_OROM_RLC_RAID_CNG


	)

79 
	#IMSM_OROM_ATTR_2TB_DISK
 (1 << 26)

	)

80 
	#IMSM_OROM_ATTR_2TB
 (1 << 29)

	)

81 
	#IMSM_OROM_ATTR_PM
 (1 << 30)

	)

82 
	#IMSM_OROM_ATTR_ChecksumV”ify
 (1 << 31)

	)

83 
__u32
 
	mÿ·b™›s
;

84 
	#IMSM_OROM_CAPABILITIES_Ext_SATA
 (1 << 0)

	)

85 
	#IMSM_OROM_CAPABILITIES_TurboMemÜy
 (1 << 1)

	)

86 
	#IMSM_OROM_CAPABILITIES_HddPasswÜd
 (1 << 2)

	)

87 
	#IMSM_OROM_CAPABILITIES_DiskCÛrciÚ
 (1 << 3)

	)

88 
__u32
 
	mdriv”_ã©u»s
;

89 
	#IMSM_OROM_CAPABILITIES_HDDUÆock
 (1 << 0)

	)

90 
	#IMSM_OROM_CAPABILITIES_LEDLoc
 (1 << 1)

	)

91 
	#IMSM_OROM_CAPABILITIES_EÁ”´i£Sy¡em
 (1 << 2)

	)

92 
	#IMSM_OROM_CAPABILITIES_Zpodd
 (1 << 3)

	)

93 
	#IMSM_OROM_CAPABILITIES_L¬geD¿mCache
 (1 << 4)

	)

94 
	#IMSM_OROM_CAPABILITIES_Rohi
 (1 << 5)

	)

95 
	#IMSM_OROM_CAPABILITIES_R—dP©rŞ
 (1 << 6)

	)

96 
	#IMSM_OROM_CAPABILITIES_XÜHw
 (1 << 7)

	)

97 } 
__©Œibu‹__
((
·cked
));

99 
šlše
 
	$imsm_Üom_has_¿id0
(cÚ¡ 
imsm_Üom
 *
Üom
)

101  !!(
Üom
->
¾c
 & 
IMSM_OROM_RLC_RAID0
);

102 
	}
}

103 
šlše
 
	$imsm_Üom_has_¿id1
(cÚ¡ 
imsm_Üom
 *
Üom
)

105  !!(
Üom
->
¾c
 & 
IMSM_OROM_RLC_RAID1
);

106 
	}
}

107 
šlše
 
	$imsm_Üom_has_¿id1e
(cÚ¡ 
imsm_Üom
 *
Üom
)

109  !!(
Üom
->
¾c
 & 
IMSM_OROM_RLC_RAID1E
);

110 
	}
}

111 
šlše
 
	$imsm_Üom_has_¿id10
(cÚ¡ 
imsm_Üom
 *
Üom
)

113  !!(
Üom
->
¾c
 & 
IMSM_OROM_RLC_RAID10
);

114 
	}
}

115 
šlše
 
	$imsm_Üom_has_¿id5
(cÚ¡ 
imsm_Üom
 *
Üom
)

117  !!(
Üom
->
¾c
 & 
IMSM_OROM_RLC_RAID5
);

118 
	}
}

125 
šlše
 
	$imsm_Üom_has_chunk
(cÚ¡ 
imsm_Üom
 *
Üom
, 
chunk
)

127 
fs
 = 
	`ffs
(
chunk
);

128 ià(!
fs
)

130 
fs
--;

131 ià(
chunk
 & (chunk-1))

133  !!(
Üom
->
sss
 & (1 << (
fs
 - 1)));

134 
	}
}

142 
šlše
 
	$æs
(
x
)

144 
r
 = 32;

146 ià(!
x
)

148 ià(!(
x
 & 0xffff0000u)) {

149 
x
 <<= 16;

150 
r
 -= 16;

152 ià(!(
x
 & 0xff000000u)) {

153 
x
 <<= 8;

154 
r
 -= 8;

156 ià(!(
x
 & 0xf0000000u)) {

157 
x
 <<= 4;

158 
r
 -= 4;

160 ià(!(
x
 & 0xc0000000u)) {

161 
x
 <<= 2;

162 
r
 -= 2;

164 ià(!(
x
 & 0x80000000u)) {

165 
x
 <<= 1;

166 
r
 -= 1;

168  
r
;

169 
	}
}

171 
	esys_dev_ty³
 {

172 
	mSYS_DEV_UNKNOWN
 = 0,

173 
	mSYS_DEV_SAS
,

174 
	mSYS_DEV_SATA
,

175 
	mSYS_DEV_MAX


178 
	ssys_dev
 {

179 
sys_dev_ty³
 
	mty³
;

180 *
	m·th
;

181 *
	mpci_id
;

182 
__u16
 
	mdev_id
;

183 
sys_dev
 *
	mÃxt
;

186 
	sefi_guid
 {

187 
__u8
 
	mb
[16];

190 
šlše
 *
	$guid_¡r
(*
buf
, 
efi_guid
 
guid
)

192 
	`¥rštf
(
buf
, "%02x%02x%02x%02x-%02x%02x-%02x%02x-"

194 
guid
.
b
[3], guid.b[2], guid.b[1], guid.b[0],

195 
guid
.
b
[5], guid.b[4], guid.b[7], guid.b[6],

196 
guid
.
b
[8], guid.b[9], guid.b[10], guid.b[11],

197 
guid
.
b
[12], guid.b[13], guid.b[14], guid.b[15]);

198  
buf
;

199 
	}
}

201 *
diskfd_to_dev·th
(
fd
);

202 
sys_dev
 *
fšd_driv”_deviûs
(cÚ¡ *
bus
, cÚ¡ *
driv”
);

203 
sys_dev
 *
fšd_š‹l_deviûs
();

204 cÚ¡ 
imsm_Üom
 *
fšd_imsm_ÿ·b™y
(
sys_dev_ty³
 
hba_id
);

205 cÚ¡ 
imsm_Üom
 *
fšd_imsm_Üom
();

206 
disk_©ched_to_hba
(
fd
, cÚ¡ *
hba_·th
);

207 
devt_©ched_to_hba
(
dev_t
 
dev
, cÚ¡ *
hba_·th
);

208 *
devt_to_dev·th
(
dev_t
 
dev
);

209 
·th_©ched_to_hba
(cÚ¡ *
disk_·th
, cÚ¡ *
hba_·th
);

210 cÚ¡ *
g‘_sys_dev_ty³
(
sys_dev_ty³
);

	@libmdadm/probe_roms.h

20 
´obe_roms_ex™
();

21 
´obe_roms_š™
(
®ign
);

22 (*
	tsÿn_â
)(cÚ¡ *
	t¡¬t
, cÚ¡ *
	t’d
, cÚ¡ *
	td©a
);

23 
	`sÿn_ad­‹r_roms
(
sÿn_â
 
â
);

24 
	`´obe_roms
();

	@libmdadm/sha1.h

20 #iâdeà
SHA1_H


21 
	#SHA1_H
 1

	)

23 
	~<¡dio.h
>

25 #ià
defšed
 
HAVE_LIMITS_H
 || 
_LIBC


26 
	~<lim™s.h
>

36 #ifdeà
_LIBC


37 
	~<sys/ty³s.h
>

38 
u_št32_t
 
	tsha1_ušt32
;

39 
ušŒ_t
 
	tsha1_ušŒ
;

41 
	#INT_MAX_32_BITS
 2147483647

	)

48 #iâdeà
INT_MAX


49 
	#INT_MAX
 
INT_MAX_32_BITS


	)

52 #ià
INT_MAX
 =ğ
INT_MAX_32_BITS


53 
	tsha1_ušt32
;

55 #ià
SHRT_MAX
 =ğ
INT_MAX_32_BITS


56 
	tsha1_ušt32
;

58 #ià
LONG_MAX
 =ğ
INT_MAX_32_BITS


59 
	tsha1_ušt32
;

69 #ifdeà
__ılu¥lus


74 
	ssha1_ùx


76 
sha1_ušt32
 
A
;

77 
sha1_ušt32
 
B
;

78 
sha1_ušt32
 
C
;

79 
sha1_ušt32
 
D
;

80 
sha1_ušt32
 
E
;

82 
sha1_ušt32
 
tÙ®
[2];

83 
sha1_ušt32
 
buæ’
;

84 
sha1_ušt32
 
bufãr
[32];

88 
sha1_š™_ùx
 (
sha1_ùx
 *
ùx
);

94 
sha1_´oûss_block
 (cÚ¡ *
bufãr
, 
size_t
 
Ën
,

95 
sha1_ùx
 *
ùx
);

101 
sha1_´oûss_by‹s
 (cÚ¡ *
bufãr
, 
size_t
 
Ën
,

102 
sha1_ùx
 *
ùx
);

111 *
sha1_fšish_ùx
 (
sha1_ùx
 *
ùx
, *
»sbuf
);

119 *
sha1_»ad_ùx
 (cÚ¡ 
sha1_ùx
 *
ùx
, *
»sbuf
);

124 
sha1_¡»am
 (
FILE
 *
¡»am
, *
»sblock
);

130 *
sha1_bufãr
 (cÚ¡ *
bufãr
, 
size_t
 
Ën
, *
»sblock
);

132 #ifdeà
__ılu¥lus


	@libmke2fs/ext2fs.h

12 #iâdeà
_EXT2FS_EXT2FS_H


13 
	#_EXT2FS_EXT2FS_H


	)

15 #ifdeà
__GNUC__


16 
	#EXT2FS_ATTR
(
x
è
	`__©Œibu‹__
(x)

	)

18 
	#EXT2FS_ATTR
(
x
)

	)

21 #ifdeà
__ılu¥lus


28 #ià(!
defšed
(
__GNUC__
è&& !defšed(
__WATCOMC__
))

29 
	#NO_INLINE_FUNCS


	)

39 
	#SUPERBLOCK_OFFSET
 1024

	)

40 
	#SUPERBLOCK_SIZE
 1024

	)

46 
	#EXT2_LIB_CURRENT_REV
 
EXT2_DYNAMIC_REV


	)

48 #ifdeà
HAVE_SYS_TYPES_H


49 
	~<sys/ty³s.h
>

52 
	~<¡dio.h
>

53 
	~<¡dlib.h
>

54 
	~<¡ršg.h
>

55 
	~<”ºo.h
>

57 #ià
EXT2_FLAT_INCLUDES


58 
	~"e2_ty³s.h
"

59 
	~"ext2_fs.h
"

60 
	~"ext3_ex‹Ás.h
"

62 
	~<ext2fs/ext2_ty³s.h
>

63 
	~<ext2fs/ext2_fs.h
>

64 
	~<ext2fs/ext3_ex‹Ás.h
>

67 #ifdeà
__CHECK_ENDIAN__


68 
	#__b™wi£
 
	`__©Œibu‹__
((
b™wi£
))

	)

70 
	#__b™wi£


	)

73 
__u32
 
	t__b™wi£
 
	text2_šo_t
;

74 
__u32
 
	t__b™wi£
 
	tblk_t
;

75 
__u64
 
	t__b™wi£
 
	tblk64_t
;

76 
__u32
 
	t__b™wi£
 
	tdg½_t
;

77 
__u32
 
	t__b™wi£
 
	text2_off_t
;

78 
__u64
 
	t__b™wi£
 
	text2_off64_t
;

79 
__s64
 
	t__b™wi£
 
	te2_blkút_t
;

80 
__u32
 
	t__b™wi£
 
	text2_dœhash_t
;

82 #ià
EXT2_FLAT_INCLUDES


83 
	~"com_”r.h
"

84 
	~"ext2_io.h
"

85 
	~"ext2_”r.h
"

86 
	~"ext2_ext_©Œ.h
"

88 
	~<‘/com_”r.h
>

89 
	~<ext2fs/ext2_io.h
>

90 
	~<ext2fs/ext2_”r.h
>

91 
	~<ext2fs/ext2_ext_©Œ.h
>

97 #ifdeà
_MSC_VER


98 
	#EXT2_QSORT_TYPE
 
__cdeş


	)

100 
	#EXT2_QSORT_TYPE
 

	)

103 
¡ruù_ext2_fsys
 *
	text2_fsys
;

105 
	#EXT2FS_MARK_ERROR
 0

	)

106 
	#EXT2FS_UNMARK_ERROR
 1

	)

107 
	#EXT2FS_TEST_ERROR
 2

	)

109 
ext2fs_¡ruù_g’”ic_b™m­
 *
	text2fs_g’”ic_b™m­
;

110 
ext2fs_¡ruù_g’”ic_b™m­
 *
	text2fs_šode_b™m­
;

111 
ext2fs_¡ruù_g’”ic_b™m­
 *
	text2fs_block_b™m­
;

113 
	#EXT2_FIRST_INODE
(
s
è
	`EXT2_FIRST_INO
(s)

	)

120 
ext2_¡ruù_u32_li¡
 *
	text2_badblocks_li¡
;

121 
ext2_¡ruù_u32_™”©e
 *
	text2_badblocks_™”©e
;

123 
ext2_¡ruù_u32_li¡
 *
	text2_u32_li¡
;

124 
ext2_¡ruù_u32_™”©e
 *
	text2_u32_™”©e
;

127 
ext2_¡ruù_u32_li¡
 *
	tbadblocks_li¡
;

128 
ext2_¡ruù_u32_™”©e
 *
	tbadblocks_™”©e
;

130 
	#BADBLOCKS_FLAG_DIRTY
 1

	)

135 
	sext2_db_’Œy2
 {

136 
ext2_šo_t
 
šo
;

137 
blk64_t
 
blk
;

138 
e2_blkút_t
 
blockút
;

142 
	sext2_db_’Œy
 {

143 
ext2_šo_t
 
šo
;

144 
blk_t
 
blk
;

145 
blockút
;

148 
ext2_¡ruù_dbli¡
 *
	text2_dbli¡
;

150 
	#DBLIST_ABORT
 1

	)

156 
	#EXT2_FILE_WRITE
 0x0001

	)

157 
	#EXT2_FILE_CREATE
 0x0002

	)

159 
	#EXT2_FILE_MASK
 0x00FF

	)

161 
	#EXT2_FILE_BUF_DIRTY
 0x4000

	)

162 
	#EXT2_FILE_BUF_VALID
 0x2000

	)

164 
ext2_fe
 *
	text2_fe_t
;

166 
	#EXT2_SEEK_SET
 0

	)

167 
	#EXT2_SEEK_CUR
 1

	)

168 
	#EXT2_SEEK_END
 2

	)

173 
	#EXT2_FLAG_RW
 0x01

	)

174 
	#EXT2_FLAG_CHANGED
 0x02

	)

175 
	#EXT2_FLAG_DIRTY
 0x04

	)

176 
	#EXT2_FLAG_VALID
 0x08

	)

177 
	#EXT2_FLAG_IB_DIRTY
 0x10

	)

178 
	#EXT2_FLAG_BB_DIRTY
 0x20

	)

179 
	#EXT2_FLAG_SWAP_BYTES
 0x40

	)

180 
	#EXT2_FLAG_SWAP_BYTES_READ
 0x80

	)

181 
	#EXT2_FLAG_SWAP_BYTES_WRITE
 0x100

	)

182 
	#EXT2_FLAG_MASTER_SB_ONLY
 0x200

	)

183 
	#EXT2_FLAG_FORCE
 0x400

	)

184 
	#EXT2_FLAG_SUPER_ONLY
 0x800

	)

185 
	#EXT2_FLAG_JOURNAL_DEV_OK
 0x1000

	)

186 
	#EXT2_FLAG_IMAGE_FILE
 0x2000

	)

187 
	#EXT2_FLAG_EXCLUSIVE
 0x4000

	)

188 
	#EXT2_FLAG_SOFTSUPP_FEATURES
 0x8000

	)

189 
	#EXT2_FLAG_NOFREE_ON_ERROR
 0x10000

	)

190 
	#EXT2_FLAG_64BITS
 0x20000

	)

191 
	#EXT2_FLAG_PRINT_PROGRESS
 0x40000

	)

192 
	#EXT2_FLAG_DIRECT_IO
 0x80000

	)

193 
	#EXT2_FLAG_SKIP_MMP
 0x100000

	)

199 
	#EXT2_NEW_INODE_FL
 0x80000000

	)

204 
	#EXT2_MKJOURNAL_V1_SUPER
 0x0000001

	)

205 
	#EXT2_MKJOURNAL_LAZYINIT
 0x0000002

	)

206 
	#EXT2_MKJOURNAL_NO_MNT_CHECK
 0x0000004

	)

208 
İaque_ext2_group_desc
;

210 
	s¡ruù_ext2_fsys
 {

211 
”rcode_t
 
magic
;

212 
io_chªÃl
 
io
;

213 
æags
;

214 * 
deviû_Çme
;

215 
ext2_su³r_block
 * 
su³r
;

216 
blocksize
;

217 
äagsize
;

218 
dg½_t
 
group_desc_couÁ
;

219 
desc_blocks
;

220 
İaque_ext2_group_desc
 * 
group_desc
;

221 
šode_blocks_³r_group
;

222 
ext2fs_šode_b™m­
 
šode_m­
;

223 
ext2fs_block_b™m­
 
block_m­
;

225 
”rcode_t
 (*
g‘_blocks
)(
ext2_fsys
 
fs
, 
ext2_šo_t
 
šo
, 
blk_t
 *
blocks
);

226 
”rcode_t
 (*
check_dœeùÜy
)(
ext2_fsys
 
fs
, 
ext2_šo_t
 
šo
);

227 
”rcode_t
 (*
wr™e_b™m­s
)(
ext2_fsys
 
fs
);

228 
”rcode_t
 (*
»ad_šode
)(
ext2_fsys
 
fs
, 
ext2_šo_t
 
šo
,

229 
ext2_šode
 *
šode
);

230 
”rcode_t
 (*
wr™e_šode
)(
ext2_fsys
 
fs
, 
ext2_šo_t
 
šo
,

231 
ext2_šode
 *
šode
);

232 
ext2_badblocks_li¡
 
badblocks
;

233 
ext2_dbli¡
 
dbli¡
;

234 
__u32
 
¡ride
;

235 
ext2_su³r_block
 * 
Üig_su³r
;

236 
ext2_image_hdr
 * 
image_h—d”
;

237 
__u32
 
umask
;

238 
time_t
 
now
;

239 
şu¡”_¿tio_b™s
;

240 
__u16
 
deçuÉ_b™m­_ty³
;

241 
__u16
 
·d
;

245 
__u32
 
»£rved
[5];

250 * 
´iv_d©a
;

255 
ext2_šode_ÿche
 *
iÿche
;

256 
io_chªÃl
 
image_io
;

261 
”rcode_t
 (*
g‘_®loc_block
)(
ext2_fsys
 
fs
, 
blk64_t
 
gßl
,

262 
blk64_t
 *
»t
);

263 (*
block_®loc_¡©s
)(
ext2_fsys
 
fs
, 
blk64_t
 
blk
, 
šu£
);

268 *
mmp_buf
;

269 *
mmp_cmp
;

270 
mmp_fd
;

275 
mmp_Ï¡_wr™‹n
;

278 #ià
EXT2_FLAT_INCLUDES


279 
	~"e2_b™İs.h
"

281 
	~<ext2fs/b™İs.h
>

287 
	#EXT2FS_BMAP64_BITARRAY
 1

	)

288 
	#EXT2FS_BMAP64_RBTREE
 2

	)

289 
	#EXT2FS_BMAP64_AUTODIR
 3

	)

294 
	#BLOCK_CHANGED
 1

	)

295 
	#BLOCK_ABORT
 2

	)

296 
	#BLOCK_ERROR
 4

	)

322 
	#BLOCK_FLAG_APPEND
 1

	)

323 
	#BLOCK_FLAG_HOLE
 1

	)

324 
	#BLOCK_FLAG_DEPTH_TRAVERSE
 2

	)

325 
	#BLOCK_FLAG_DATA_ONLY
 4

	)

326 
	#BLOCK_FLAG_READ_ONLY
 8

	)

328 
	#BLOCK_FLAG_NO_LARGE
 0x1000

	)

333 
	#BLOCK_COUNT_IND
 (-1)

	)

334 
	#BLOCK_COUNT_DIND
 (-2)

	)

335 
	#BLOCK_COUNT_TIND
 (-3)

	)

336 
	#BLOCK_COUNT_TRANSLATOR
 (-4)

	)

342 
	#EXT2_BMOVE_GET_DBLIST
 0x0001

	)

343 
	#EXT2_BMOVE_DEBUG
 0x0002

	)

350 
	#EXT2_EXTENT_FLAGS_LEAF
 0x0001

	)

351 
	#EXT2_EXTENT_FLAGS_UNINIT
 0x0002

	)

352 
	#EXT2_EXTENT_FLAGS_SECOND_VISIT
 0x0004

	)

354 
	sext2fs_ex‹Á
 {

355 
blk64_t
 
e_pblk
;

356 
blk64_t
 
e_lblk
;

357 
__u32
 
e_Ën
;

358 
__u32
 
e_æags
;

361 
ext2_ex‹Á_hªdË
 *
	text2_ex‹Á_hªdË_t
;

362 
ext2_ex‹Á_·th
 *
	text2_ex‹Á_·th_t
;

367 
	#EXT2_EXTENT_CURRENT
 0x0000

	)

368 
	#EXT2_EXTENT_MOVE_MASK
 0x000F

	)

369 
	#EXT2_EXTENT_ROOT
 0x0001

	)

370 
	#EXT2_EXTENT_LAST_LEAF
 0x0002

	)

371 
	#EXT2_EXTENT_FIRST_SIB
 0x0003

	)

372 
	#EXT2_EXTENT_LAST_SIB
 0x0004

	)

373 
	#EXT2_EXTENT_NEXT_SIB
 0x0005

	)

374 
	#EXT2_EXTENT_PREV_SIB
 0x0006

	)

375 
	#EXT2_EXTENT_NEXT_LEAF
 0x0007

	)

376 
	#EXT2_EXTENT_PREV_LEAF
 0x0008

	)

377 
	#EXT2_EXTENT_NEXT
 0x0009

	)

378 
	#EXT2_EXTENT_PREV
 0x000A

	)

379 
	#EXT2_EXTENT_UP
 0x000B

	)

380 
	#EXT2_EXTENT_DOWN
 0x000C

	)

381 
	#EXT2_EXTENT_DOWN_AND_LAST
 0x000D

	)

386 
	#EXT2_EXTENT_INSERT_AFTER
 0x0001

	)

387 
	#EXT2_EXTENT_INSERT_NOSPLIT
 0x0002

	)

392 
	#EXT2_EXTENT_DELETE_KEEP_EMPTY
 0x001

	)

397 
	#EXT2_EXTENT_SET_BMAP_UNINIT
 0x0001

	)

402 
	sext2_ex‹Á_šfo
 {

403 
cu¼_’Œy
;

404 
cu¼_Ëv–
;

405 
num_’Œ›s
;

406 
max_’Œ›s
;

407 
max_d•th
;

408 
by‹s_ava
;

409 
blk64_t
 
max_lblk
;

410 
blk64_t
 
max_pblk
;

411 
__u32
 
max_Ën
;

412 
__u32
 
max_unš™_Ën
;

418 
	#EXT2_DIRBLOCK_V2_STRUCT
 0x0001

	)

423 
	#DIRENT_CHANGED
 1

	)

424 
	#DIRENT_ABORT
 2

	)

425 
	#DIRENT_ERROR
 3

	)

431 
	#DIRENT_FLAG_INCLUDE_EMPTY
 1

	)

432 
	#DIRENT_FLAG_INCLUDE_REMOVED
 2

	)

434 
	#DIRENT_DOT_FILE
 1

	)

435 
	#DIRENT_DOT_DOT_FILE
 2

	)

436 
	#DIRENT_OTHER_FILE
 3

	)

437 
	#DIRENT_DELETED_FILE
 4

	)

442 
ext2_¡ruù_šode_sÿn
 *
	text2_šode_sÿn
;

447 
	#EXT2_SF_CHK_BADBLOCKS
 0x0001

	)

448 
	#EXT2_SF_BAD_INODE_BLK
 0x0002

	)

449 
	#EXT2_SF_BAD_EXTRA_BYTES
 0x0004

	)

450 
	#EXT2_SF_SKIP_MISSING_ITABLE
 0x0008

	)

451 
	#EXT2_SF_DO_LAZY
 0x0010

	)

456 
	#EXT2_MF_MOUNTED
 1

	)

457 
	#EXT2_MF_ISROOT
 2

	)

458 
	#EXT2_MF_READONLY
 4

	)

459 
	#EXT2_MF_SWAP
 8

	)

460 
	#EXT2_MF_BUSY
 16

	)

467 
	#LINUX_S_IFMT
 00170000

	)

468 
	#LINUX_S_IFSOCK
 0140000

	)

469 
	#LINUX_S_IFLNK
 0120000

	)

470 
	#LINUX_S_IFREG
 0100000

	)

471 
	#LINUX_S_IFBLK
 0060000

	)

472 
	#LINUX_S_IFDIR
 0040000

	)

473 
	#LINUX_S_IFCHR
 0020000

	)

474 
	#LINUX_S_IFIFO
 0010000

	)

475 
	#LINUX_S_ISUID
 0004000

	)

476 
	#LINUX_S_ISGID
 0002000

	)

477 
	#LINUX_S_ISVTX
 0001000

	)

479 
	#LINUX_S_IRWXU
 00700

	)

480 
	#LINUX_S_IRUSR
 00400

	)

481 
	#LINUX_S_IWUSR
 00200

	)

482 
	#LINUX_S_IXUSR
 00100

	)

484 
	#LINUX_S_IRWXG
 00070

	)

485 
	#LINUX_S_IRGRP
 00040

	)

486 
	#LINUX_S_IWGRP
 00020

	)

487 
	#LINUX_S_IXGRP
 00010

	)

489 
	#LINUX_S_IRWXO
 00007

	)

490 
	#LINUX_S_IROTH
 00004

	)

491 
	#LINUX_S_IWOTH
 00002

	)

492 
	#LINUX_S_IXOTH
 00001

	)

494 
	#LINUX_S_ISLNK
(
m
è(((mè& 
LINUX_S_IFMT
è=ğ
LINUX_S_IFLNK
)

	)

495 
	#LINUX_S_ISREG
(
m
è(((mè& 
LINUX_S_IFMT
è=ğ
LINUX_S_IFREG
)

	)

496 
	#LINUX_S_ISDIR
(
m
è(((mè& 
LINUX_S_IFMT
è=ğ
LINUX_S_IFDIR
)

	)

497 
	#LINUX_S_ISCHR
(
m
è(((mè& 
LINUX_S_IFMT
è=ğ
LINUX_S_IFCHR
)

	)

498 
	#LINUX_S_ISBLK
(
m
è(((mè& 
LINUX_S_IFMT
è=ğ
LINUX_S_IFBLK
)

	)

499 
	#LINUX_S_ISFIFO
(
m
è(((mè& 
LINUX_S_IFMT
è=ğ
LINUX_S_IFIFO
)

	)

500 
	#LINUX_S_ISSOCK
(
m
è(((mè& 
LINUX_S_IFMT
è=ğ
LINUX_S_IFSOCK
)

	)

505 
	#EXT2_I_SIZE
(
i
è((i)->
i_size
 | ((
__u64
è(i)->
i_size_high
 << 32))

	)

510 
	#EXT2_ICOUNT_OPT_INCREMENT
 0x01

	)

512 
ext2_icouÁ
 *
	text2_icouÁ_t
;

517 
	#BMAP_ALLOC
 0x0001

	)

518 
	#BMAP_SET
 0x0002

	)

523 
	#BMAP_RET_UNINIT
 0x0001

	)

528 
	#IMAGER_FLAG_INODEMAP
 1

	)

529 
	#IMAGER_FLAG_SPARSEWRITE
 2

	)

535 
	#EXT2_CHECK_MAGIC
(, 
code
) \

536 ià(()->
magic
 !ğ(
code
)è (code)

	)

542 
	#EXT2FS_COMPRESSED_BLKADDR
 ((
blk_t
è-1)

	)

543 
	#HOLE_BLKADDR
(
_b
è((_bè=ğ0 || (_bè=ğ
EXT2FS_COMPRESSED_BLKADDR
)

	)

548 
	#EXT2_LIB_FEATURE_COMPAT_SUPP
 (
EXT2_FEATURE_COMPAT_DIR_PREALLOC
|\

549 
EXT2_FEATURE_COMPAT_IMAGIC_INODES
|\

550 
EXT3_FEATURE_COMPAT_HAS_JOURNAL
|\

551 
EXT2_FEATURE_COMPAT_RESIZE_INODE
|\

552 
EXT2_FEATURE_COMPAT_DIR_INDEX
|\

553 
EXT2_FEATURE_COMPAT_EXT_ATTR
)

	)

556 #ifdeà
ENABLE_COMPRESSION


557 #iâdeà
I_KNOW_THAT_COMPRESSION_IS_EXPERIMENTAL


563 
	#EXT2_LIB_FEATURE_INCOMPAT_SUPP
 (
EXT2_FEATURE_INCOMPAT_FILETYPE
|\

564 
EXT2_FEATURE_INCOMPAT_COMPRESSION
|\

565 
EXT3_FEATURE_INCOMPAT_JOURNAL_DEV
|\

566 
EXT2_FEATURE_INCOMPAT_META_BG
|\

567 
EXT3_FEATURE_INCOMPAT_RECOVER
|\

568 
EXT3_FEATURE_INCOMPAT_EXTENTS
|\

569 
EXT4_FEATURE_INCOMPAT_FLEX_BG
|\

570 
EXT4_FEATURE_INCOMPAT_MMP
|\

571 
EXT4_FEATURE_INCOMPAT_64BIT
)

	)

573 
	#EXT2_LIB_FEATURE_INCOMPAT_SUPP
 (
EXT2_FEATURE_INCOMPAT_FILETYPE
|\

574 
EXT3_FEATURE_INCOMPAT_JOURNAL_DEV
|\

575 
EXT2_FEATURE_INCOMPAT_META_BG
|\

576 
EXT3_FEATURE_INCOMPAT_RECOVER
|\

577 
EXT3_FEATURE_INCOMPAT_EXTENTS
|\

578 
EXT4_FEATURE_INCOMPAT_FLEX_BG
|\

579 
EXT4_FEATURE_INCOMPAT_MMP
|\

580 
EXT4_FEATURE_INCOMPAT_64BIT
)

	)

582 #ifdeà
CONFIG_QUOTA


583 
	#EXT2_LIB_FEATURE_RO_COMPAT_SUPP
 (
EXT2_FEATURE_RO_COMPAT_SPARSE_SUPER
|\

584 
EXT4_FEATURE_RO_COMPAT_HUGE_FILE
|\

585 
EXT2_FEATURE_RO_COMPAT_LARGE_FILE
|\

586 
EXT4_FEATURE_RO_COMPAT_DIR_NLINK
|\

587 
EXT4_FEATURE_RO_COMPAT_EXTRA_ISIZE
|\

588 
EXT4_FEATURE_RO_COMPAT_GDT_CSUM
|\

589 
EXT4_FEATURE_RO_COMPAT_BIGALLOC
|\

590 
EXT4_FEATURE_RO_COMPAT_QUOTA
)

	)

592 
	#EXT2_LIB_FEATURE_RO_COMPAT_SUPP
 (
EXT2_FEATURE_RO_COMPAT_SPARSE_SUPER
|\

593 
EXT4_FEATURE_RO_COMPAT_HUGE_FILE
|\

594 
EXT2_FEATURE_RO_COMPAT_LARGE_FILE
|\

595 
EXT4_FEATURE_RO_COMPAT_DIR_NLINK
|\

596 
EXT4_FEATURE_RO_COMPAT_EXTRA_ISIZE
|\

597 
EXT4_FEATURE_RO_COMPAT_GDT_CSUM
|\

598 
EXT4_FEATURE_RO_COMPAT_BIGALLOC
)

	)

605 
	#EXT2_LIB_SOFTSUPP_INCOMPAT
 (0)

	)

606 
	#EXT2_LIB_SOFTSUPP_RO_COMPAT
 (
EXT4_FEATURE_RO_COMPAT_REPLICA
)

	)

610 
	#EXT2FS_CLUSTER_RATIO
(
fs
è(1 << (fs)->
şu¡”_¿tio_b™s
)

	)

611 
	#EXT2FS_CLUSTER_MASK
(
fs
è(
	`EXT2FS_CLUSTER_RATIO
(fsè- 1)

	)

612 
	#EXT2FS_B2C
(
fs
, 
blk
è((blkè>> (fs)->
şu¡”_¿tio_b™s
)

	)

614 
	#EXT2FS_C2B
(
fs
, 
şu¡”
è((şu¡”è<< (fs)->
şu¡”_¿tio_b™s
)

	)

616 
	#EXT2FS_NUM_B2C
(
fs
, 
blks
è(((blksè+ 
	`EXT2FS_CLUSTER_MASK
(fs)) >> \

617 (
fs
)->
şu¡”_¿tio_b™s
)

	)

619 #ià
defšed
(
HAVE_FSTAT64
è&& !defšed(
__OSX_AVAILABLE_BUT_DEPRECATED
)

620 
¡©64
 
	text2fs_¡ruù_¡©
;

622 
¡©
 
	text2fs_¡ruù_¡©
;

629 
	#EXT2_FLAG_FLUSH_NO_SYNC
 1

	)

636 
šlše
 
ext2fs_Ãeds_Ïrge_fe_ã©u»
(
fe_size
)

638  
fe_size
 >= 0x80000000ULL;

642 
”rcode_t
 
ext2fs_Ãw_šode
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
dœ
, 
mode
,

643 
ext2fs_šode_b™m­
 
m­
, 
ext2_šo_t
 *
»t
);

644 
”rcode_t
 
ext2fs_Ãw_block
(
ext2_fsys
 
fs
, 
blk_t
 
gßl
,

645 
ext2fs_block_b™m­
 
m­
, 
blk_t
 *
»t
);

646 
”rcode_t
 
ext2fs_Ãw_block2
(
ext2_fsys
 
fs
, 
blk64_t
 
gßl
,

647 
ext2fs_block_b™m­
 
m­
, 
blk64_t
 *
»t
);

648 
”rcode_t
 
ext2fs_g‘_ä“_blocks
(
ext2_fsys
 
fs
, 
blk_t
 
¡¬t
,

649 
blk_t
 
fšish
, 
num
,

650 
ext2fs_block_b™m­
 
m­
,

651 
blk_t
 *
»t
);

652 
”rcode_t
 
ext2fs_g‘_ä“_blocks2
(
ext2_fsys
 
fs
, 
blk64_t
 
¡¬t
,

653 
blk64_t
 
fšish
, 
num
,

654 
ext2fs_block_b™m­
 
m­
,

655 
blk64_t
 *
»t
);

656 
”rcode_t
 
ext2fs_®loc_block
(
ext2_fsys
 
fs
, 
blk_t
 
gßl
,

657 *
block_buf
, 
blk_t
 *
»t
);

658 
”rcode_t
 
ext2fs_®loc_block2
(
ext2_fsys
 
fs
, 
blk64_t
 
gßl
,

659 *
block_buf
, 
blk64_t
 *
»t
);

660 
ext2fs_£t_®loc_block_ÿÎback
(
ext2_fsys
 
fs
,

661 
”rcode_t
 (*
func
)(
ext2_fsys
 
fs
,

662 
blk64_t
 
gßl
,

663 
blk64_t
 *
»t
),

664 
”rcode_t
 (**
Şd
)(
ext2_fsys
 
fs
,

665 
blk64_t
 
gßl
,

666 
blk64_t
 *
»t
));

669 
ext2fs_»£rve_su³r_ªd_bgd
(
ext2_fsys
 
fs
,

670 
dg½_t
 
group
,

671 
ext2fs_block_b™m­
 
bm­
);

672 
ext2fs_£t_block_®loc_¡©s_ÿÎback
(
ext2_fsys
 
fs
,

673 (*
func
)(
ext2_fsys
 
fs
,

674 
blk64_t
 
blk
,

675 
šu£
),

676 (**
Şd
)(
ext2_fsys
 
fs
,

677 
blk64_t
 
blk
,

678 
šu£
));

681 
ext2fs_šode_®loc_¡©s
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
šo
, 
šu£
);

682 
ext2fs_šode_®loc_¡©s2
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
šo
,

683 
šu£
, 
isdœ
);

684 
ext2fs_block_®loc_¡©s
(
ext2_fsys
 
fs
, 
blk_t
 
blk
, 
šu£
);

685 
ext2fs_block_®loc_¡©s2
(
ext2_fsys
 
fs
, 
blk64_t
 
blk
, 
šu£
);

688 
”rcode_t
 
ext2fs_®loÿ‹_bËs
(
ext2_fsys
 
fs
);

689 
”rcode_t
 
ext2fs_®loÿ‹_group_bË
(
ext2_fsys
 
fs
, 
dg½_t
 
group
,

690 
ext2fs_block_b™m­
 
bm­
);

693 
”rcode_t
 
ext2fs_u32_li¡_ü—‹
(
ext2_u32_li¡
 *
»t
, 
size
);

694 
”rcode_t
 
ext2fs_u32_li¡_add
(
ext2_u32_li¡
 
bb
, 
__u32
 
blk
);

695 
ext2fs_u32_li¡_fšd
(
ext2_u32_li¡
 
bb
, 
__u32
 
blk
);

696 
ext2fs_u32_li¡_‹¡
(
ext2_u32_li¡
 
bb
, 
blk_t
 
blk
);

697 
”rcode_t
 
ext2fs_u32_li¡_™”©e_begš
(
ext2_u32_li¡
 
bb
,

698 
ext2_u32_™”©e
 *
»t
);

699 
ext2fs_u32_li¡_™”©e
(
ext2_u32_™”©e
 
™”
, 
blk_t
 *
blk
);

700 
ext2fs_u32_li¡_™”©e_’d
(
ext2_u32_™”©e
 
™”
);

701 
”rcode_t
 
ext2fs_u32_cİy
(
ext2_u32_li¡
 
¤c
,ƒxt2_u32_li¡ *
de¡
);

702 
ext2fs_u32_li¡_equ®
(
ext2_u32_li¡
 
bb1
,ƒxt2_u32_li¡ 
bb2
);

704 
”rcode_t
 
ext2fs_badblocks_li¡_ü—‹
(
ext2_badblocks_li¡
 *
»t
,

705 
size
);

706 
”rcode_t
 
ext2fs_badblocks_li¡_add
(
ext2_badblocks_li¡
 
bb
,

707 
blk_t
 
blk
);

708 
ext2fs_badblocks_li¡_‹¡
(
ext2_badblocks_li¡
 
bb
,

709 
blk_t
 
blk
);

710 
ext2fs_u32_li¡_d–
(
ext2_u32_li¡
 
bb
, 
__u32
 
blk
);

711 
ext2fs_badblocks_li¡_d–
(
ext2_u32_li¡
 
bb
, 
__u32
 
blk
);

712 
”rcode_t


713 
ext2fs_badblocks_li¡_™”©e_begš
(
ext2_badblocks_li¡
 
bb
,

714 
ext2_badblocks_™”©e
 *
»t
);

715 
ext2fs_badblocks_li¡_™”©e
(
ext2_badblocks_™”©e
 
™”
,

716 
blk_t
 *
blk
);

717 
ext2fs_badblocks_li¡_™”©e_’d
(
ext2_badblocks_™”©e
 
™”
);

718 
”rcode_t
 
ext2fs_badblocks_cİy
(
ext2_badblocks_li¡
 
¤c
,

719 
ext2_badblocks_li¡
 *
de¡
);

720 
ext2fs_badblocks_equ®
(
ext2_badblocks_li¡
 
bb1
,

721 
ext2_badblocks_li¡
 
bb2
);

722 
ext2fs_u32_li¡_couÁ
(
ext2_u32_li¡
 
bb
);

725 
”rcode_t
 
badblocks_li¡_ü—‹
(
badblocks_li¡
 *
»t
, 
size
);

726 
”rcode_t
 
badblocks_li¡_add
(
badblocks_li¡
 
bb
, 
blk_t
 
blk
);

727 
badblocks_li¡_‹¡
(
badblocks_li¡
 
bb
, 
blk_t
 
blk
);

728 
”rcode_t
 
badblocks_li¡_™”©e_begš
(
badblocks_li¡
 
bb
,

729 
badblocks_™”©e
 *
»t
);

730 
badblocks_li¡_™”©e
(
badblocks_™”©e
 
™”
, 
blk_t
 *
blk
);

731 
badblocks_li¡_™”©e_’d
(
badblocks_™”©e
 
™”
);

732 
badblocks_li¡_ä“
(
badblocks_li¡
 
bb
);

735 
”rcode_t
 
ext2fs_upd©e_bb_šode
(
ext2_fsys
 
fs
,

736 
ext2_badblocks_li¡
 
bb_li¡
);

739 
ext2fs_ä“_block_b™m­
(
ext2fs_block_b™m­
 
b™m­
);

740 
ext2fs_ä“_šode_b™m­
(
ext2fs_šode_b™m­
 
b™m­
);

741 
”rcode_t
 
ext2fs_cİy_b™m­
(
ext2fs_g’”ic_b™m­
 
¤c
,

742 
ext2fs_g’”ic_b™m­
 *
de¡
);

743 
”rcode_t
 
ext2fs_wr™e_šode_b™m­
(
ext2_fsys
 
fs
);

744 
”rcode_t
 
ext2fs_wr™e_block_b™m­
 (
ext2_fsys
 
fs
);

745 
”rcode_t
 
ext2fs_»ad_šode_b™m­
 (
ext2_fsys
 
fs
);

746 
”rcode_t
 
ext2fs_»ad_block_b™m­
(
ext2_fsys
 
fs
);

747 
”rcode_t
 
ext2fs_®loÿ‹_block_b™m­
(
ext2_fsys
 
fs
,

748 cÚ¡ *
desü
,

749 
ext2fs_block_b™m­
 *
»t
);

750 
”rcode_t
 
ext2fs_®loÿ‹_subşu¡”_b™m­
(
ext2_fsys
 
fs
,

751 cÚ¡ *
desü
,

752 
ext2fs_block_b™m­
 *
»t
);

753 
ext2fs_g‘_b™m­_g¿nuÏr™y
(
ext2fs_block_b™m­
 
b™m­
);

754 
”rcode_t
 
ext2fs_®loÿ‹_šode_b™m­
(
ext2_fsys
 
fs
,

755 cÚ¡ *
desü
,

756 
ext2fs_šode_b™m­
 *
»t
);

757 
”rcode_t
 
ext2fs_fudge_šode_b™m­_’d
(
ext2fs_šode_b™m­
 
b™m­
,

758 
ext2_šo_t
 
’d
,ƒxt2_šo_ˆ*
Ûnd
);

759 
”rcode_t
 
ext2fs_fudge_block_b™m­_’d
(
ext2fs_block_b™m­
 
b™m­
,

760 
blk_t
 
’d
, blk_ˆ*
Ûnd
);

761 
”rcode_t
 
ext2fs_fudge_block_b™m­_’d2
(
ext2fs_block_b™m­
 
b™m­
,

762 
blk64_t
 
’d
, blk64_ˆ*
Ûnd
);

763 
ext2fs_ş—r_šode_b™m­
(
ext2fs_šode_b™m­
 
b™m­
);

764 
ext2fs_ş—r_block_b™m­
(
ext2fs_block_b™m­
 
b™m­
);

765 
”rcode_t
 
ext2fs_»ad_b™m­s
(
ext2_fsys
 
fs
);

766 
”rcode_t
 
ext2fs_wr™e_b™m­s
(
ext2_fsys
 
fs
);

767 
”rcode_t
 
ext2fs_»size_šode_b™m­
(
__u32
 
Ãw_’d
, __u32 
Ãw_»®_’d
,

768 
ext2fs_šode_b™m­
 
bm­
);

769 
”rcode_t
 
ext2fs_»size_šode_b™m­2
(
__u64
 
Ãw_’d
,

770 
__u64
 
Ãw_»®_’d
,

771 
ext2fs_šode_b™m­
 
bm­
);

772 
”rcode_t
 
ext2fs_»size_block_b™m­
(
__u32
 
Ãw_’d
, __u32 
Ãw_»®_’d
,

773 
ext2fs_block_b™m­
 
bm­
);

774 
”rcode_t
 
ext2fs_»size_block_b™m­2
(
__u64
 
Ãw_’d
,

775 
__u64
 
Ãw_»®_’d
,

776 
ext2fs_block_b™m­
 
bm­
);

777 
”rcode_t
 
ext2fs_com·»_block_b™m­
(
ext2fs_block_b™m­
 
bm1
,

778 
ext2fs_block_b™m­
 
bm2
);

779 
”rcode_t
 
ext2fs_com·»_šode_b™m­
(
ext2fs_šode_b™m­
 
bm1
,

780 
ext2fs_šode_b™m­
 
bm2
);

781 
”rcode_t
 
ext2fs_£t_šode_b™m­_¿nge
(
ext2fs_šode_b™m­
 
bm­
,

782 
ext2_šo_t
 
¡¬t
, 
num
,

783 *
š
);

784 
”rcode_t
 
ext2fs_£t_šode_b™m­_¿nge2
(
ext2fs_šode_b™m­
 
bm­
,

785 
__u64
 
¡¬t
, 
size_t
 
num
,

786 *
š
);

787 
”rcode_t
 
ext2fs_g‘_šode_b™m­_¿nge
(
ext2fs_šode_b™m­
 
bm­
,

788 
ext2_šo_t
 
¡¬t
, 
num
,

789 *
out
);

790 
”rcode_t
 
ext2fs_g‘_šode_b™m­_¿nge2
(
ext2fs_šode_b™m­
 
bm­
,

791 
__u64
 
¡¬t
, 
size_t
 
num
,

792 *
out
);

793 
”rcode_t
 
ext2fs_£t_block_b™m­_¿nge
(
ext2fs_block_b™m­
 
bm­
,

794 
blk_t
 
¡¬t
, 
num
,

795 *
š
);

796 
”rcode_t
 
ext2fs_£t_block_b™m­_¿nge2
(
ext2fs_block_b™m­
 
bm­
,

797 
blk64_t
 
¡¬t
, 
size_t
 
num
,

798 *
š
);

799 
”rcode_t
 
ext2fs_g‘_block_b™m­_¿nge
(
ext2fs_block_b™m­
 
bm­
,

800 
blk_t
 
¡¬t
, 
num
,

801 *
out
);

802 
”rcode_t
 
ext2fs_g‘_block_b™m­_¿nge2
(
ext2fs_block_b™m­
 
bm­
,

803 
blk64_t
 
¡¬t
, 
size_t
 
num
,

804 *
out
);

807 
dg½_t
 
ext2fs_group_of_blk2
(
ext2_fsys
 
fs
, 
blk64_t
);

808 
blk64_t
 
ext2fs_group_fœ¡_block2
(
ext2_fsys
 
fs
, 
dg½_t
 
group
);

809 
blk64_t
 
ext2fs_group_Ï¡_block2
(
ext2_fsys
 
fs
, 
dg½_t
 
group
);

810 
ext2fs_group_blocks_couÁ
(
ext2_fsys
 
fs
, 
dg½_t
 
group
);

811 
blk64_t
 
ext2fs_šode_d©a_blocks2
(
ext2_fsys
 
fs
,

812 
ext2_šode
 *
šode
);

813 
blk64_t
 
ext2fs_šode_i_blocks
(
ext2_fsys
 
fs
,

814 
ext2_šode
 *
šode
);

815 
blk64_t
 
ext2fs_blocks_couÁ
(
ext2_su³r_block
 *
su³r
);

816 
ext2fs_blocks_couÁ_£t
(
ext2_su³r_block
 *
su³r
,

817 
blk64_t
 
blk
);

818 
ext2fs_blocks_couÁ_add
(
ext2_su³r_block
 *
su³r
,

819 
blk64_t
 
blk
);

820 
blk64_t
 
ext2fs_r_blocks_couÁ
(
ext2_su³r_block
 *
su³r
);

821 
ext2fs_r_blocks_couÁ_£t
(
ext2_su³r_block
 *
su³r
,

822 
blk64_t
 
blk
);

823 
ext2fs_r_blocks_couÁ_add
(
ext2_su³r_block
 *
su³r
,

824 
blk64_t
 
blk
);

825 
blk64_t
 
ext2fs_ä“_blocks_couÁ
(
ext2_su³r_block
 *
su³r
);

826 
ext2fs_ä“_blocks_couÁ_£t
(
ext2_su³r_block
 *
su³r
,

827 
blk64_t
 
blk
);

828 
ext2fs_ä“_blocks_couÁ_add
(
ext2_su³r_block
 *
su³r
,

829 
blk64_t
 
blk
);

831 
ext2_group_desc
 *
ext2fs_group_desc
(
ext2_fsys
 
fs
,

832 
İaque_ext2_group_desc
 *
gdp
,

833 
dg½_t
 
group
);

834 
blk64_t
 
ext2fs_block_b™m­_loc
(
ext2_fsys
 
fs
, 
dg½_t
 
group
);

835 
ext2fs_block_b™m­_loc_£t
(
ext2_fsys
 
fs
, 
dg½_t
 
group
,

836 
blk64_t
 
blk
);

837 
blk64_t
 
ext2fs_šode_b™m­_loc
(
ext2_fsys
 
fs
, 
dg½_t
 
group
);

838 
ext2fs_šode_b™m­_loc_£t
(
ext2_fsys
 
fs
, 
dg½_t
 
group
,

839 
blk64_t
 
blk
);

840 
blk64_t
 
ext2fs_šode_bË_loc
(
ext2_fsys
 
fs
, 
dg½_t
 
group
);

841 
ext2fs_šode_bË_loc_£t
(
ext2_fsys
 
fs
, 
dg½_t
 
group
,

842 
blk64_t
 
blk
);

843 
__u32
 
ext2fs_bg_ä“_blocks_couÁ
(
ext2_fsys
 
fs
, 
dg½_t
 
group
);

844 
ext2fs_bg_ä“_blocks_couÁ_£t
(
ext2_fsys
 
fs
, 
dg½_t
 
group
,

845 
__u32
 
n
);

846 
__u32
 
ext2fs_bg_ä“_šodes_couÁ
(
ext2_fsys
 
fs
, 
dg½_t
 
group
);

847 
ext2fs_bg_ä“_šodes_couÁ_£t
(
ext2_fsys
 
fs
, 
dg½_t
 
group
,

848 
__u32
 
n
);

849 
__u32
 
ext2fs_bg_u£d_dœs_couÁ
(
ext2_fsys
 
fs
, 
dg½_t
 
group
);

850 
ext2fs_bg_u£d_dœs_couÁ_£t
(
ext2_fsys
 
fs
, 
dg½_t
 
group
,

851 
__u32
 
n
);

852 
__u32
 
ext2fs_bg_™abË_unu£d
(
ext2_fsys
 
fs
, 
dg½_t
 
group
);

853 
ext2fs_bg_™abË_unu£d_£t
(
ext2_fsys
 
fs
, 
dg½_t
 
group
,

854 
__u32
 
n
);

855 
__u16
 
ext2fs_bg_æags
(
ext2_fsys
 
fs
, 
dg½_t
 
group
);

856 
ext2fs_bg_æags_z­
(
ext2_fsys
 
fs
, 
dg½_t
 
group
);

857 
ext2fs_bg_æags_‹¡
(
ext2_fsys
 
fs
, 
dg½_t
 
group
, 
__u16
 
bg_æag
);

858 
ext2fs_bg_æags_£t
(
ext2_fsys
 
fs
, 
dg½_t
 
group
, 
__u16
 
bg_æags
);

859 
ext2fs_bg_æags_ş—r
(
ext2_fsys
 
fs
, 
dg½_t
 
group
, 
__u16
 
bg_æags
);

860 
__u16
 
ext2fs_bg_checksum
(
ext2_fsys
 
fs
, 
dg½_t
 
group
);

861 
ext2fs_bg_checksum_£t
(
ext2_fsys
 
fs
, 
dg½_t
 
group
, 
__u16
 
checksum
);

862 
blk64_t
 
ext2fs_fe_aş_block
(
ext2_fsys
 
fs
,

863 cÚ¡ 
ext2_šode
 *
šode
);

864 
ext2fs_fe_aş_block_£t
(
ext2_fsys
 
fs
,

865 
ext2_šode
 *
šode
, 
blk64_t
 
blk
);

868 
”rcode_t
 
ext2fs_block_™”©e
(
ext2_fsys
 
fs
,

869 
ext2_šo_t
 
šo
,

870 
æags
,

871 *
block_buf
,

872 (*
func
)(
ext2_fsys
 
fs
,

873 
blk_t
 *
blockÄ
,

874 
blockút
,

875 *
´iv_d©a
),

876 *
´iv_d©a
);

877 
”rcode_t
 
ext2fs_block_™”©e2
(
ext2_fsys
 
fs
,

878 
ext2_šo_t
 
šo
,

879 
æags
,

880 *
block_buf
,

881 (*
func
)(
ext2_fsys
 
fs
,

882 
blk_t
 *
blockÄ
,

883 
e2_blkút_t
 
blockút
,

884 
blk_t
 
»f_blk
,

885 
»f_off£t
,

886 *
´iv_d©a
),

887 *
´iv_d©a
);

888 
”rcode_t
 
ext2fs_block_™”©e3
(
ext2_fsys
 
fs
,

889 
ext2_šo_t
 
šo
,

890 
æags
,

891 *
block_buf
,

892 (*
func
)(
ext2_fsys
 
fs
,

893 
blk64_t
 *
blockÄ
,

894 
e2_blkút_t
 
blockút
,

895 
blk64_t
 
»f_blk
,

896 
»f_off£t
,

897 *
´iv_d©a
),

898 *
´iv_d©a
);

901 
”rcode_t
 
ext2fs_bm­
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
šo
,

902 
ext2_šode
 *
šode
,

903 *
block_buf
, 
bm­_æags
,

904 
blk_t
 
block
, blk_ˆ*
phys_blk
);

905 
”rcode_t
 
ext2fs_bm­2
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
šo
,

906 
ext2_šode
 *
šode
,

907 *
block_buf
, 
bm­_æags
, 
blk64_t
 
block
,

908 *
»t_æags
, 
blk64_t
 *
phys_blk
);

909 
”rcode_t
 
ext2fs_m­_şu¡”_block
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
šo
,

910 
ext2_šode
 *
šode
, 
blk64_t
 
lblk
,

911 
blk64_t
 *
pblk
);

915 
”rcode_t
 
ext2fs_move_blocks
(
ext2_fsys
 
fs
,

916 
ext2fs_block_b™m­
 
»£rve
,

917 
ext2fs_block_b™m­
 
®loc_m­
,

918 
æags
);

922 
”rcode_t
 
ext2fs_check_desc
(
ext2_fsys
 
fs
);

925 
”rcode_t
 
ext2fs_şo£
(
ext2_fsys
 
fs
);

926 
”rcode_t
 
ext2fs_şo£2
(
ext2_fsys
 
fs
, 
æags
);

927 
”rcode_t
 
ext2fs_æush
(
ext2_fsys
 
fs
);

928 
”rcode_t
 
ext2fs_æush2
(
ext2_fsys
 
fs
, 
æags
);

929 
ext2fs_bg_has_su³r
(
ext2_fsys
 
fs
, 
dg½_t
 
group_block
);

930 
”rcode_t
 
ext2fs_su³r_ªd_bgd_loc2
(
ext2_fsys
 
fs
,

931 
dg½_t
 
group
,

932 
blk64_t
 *
»t_su³r_blk
,

933 
blk64_t
 *
»t_Şd_desc_blk
,

934 
blk64_t
 *
»t_Ãw_desc_blk
,

935 
blk_t
 *
»t_u£d_blks
);

936 
ext2fs_su³r_ªd_bgd_loc
(
ext2_fsys
 
fs
,

937 
dg½_t
 
group
,

938 
blk_t
 *
»t_su³r_blk
,

939 
blk_t
 *
»t_Şd_desc_blk
,

940 
blk_t
 *
»t_Ãw_desc_blk
,

941 *
»t_m‘a_bg
);

942 
ext2fs_upd©e_dyÇmic_»v
(
ext2_fsys
 
fs
);

945 
__u32
 
ext2fs_üc32c_be
(__u32 
üc
, cÚ¡ *
p
, 
size_t
 
Ën
);

946 
__u32
 
ext2fs_üc32c_Ë
(__u32 
üc
, cÚ¡ *
p
, 
size_t
 
Ën
);

949 
ext2fs_group_desc_csum_£t
(
ext2_fsys
 
fs
, 
dg½_t
 
group
);

950 
ext2fs_group_desc_csum_v”ify
(
ext2_fsys
 
fs
, 
dg½_t
 
group
);

951 
”rcode_t
 
ext2fs_£t_gdt_csum
(
ext2_fsys
 
fs
);

952 
__u16
 
ext2fs_group_desc_csum
(
ext2_fsys
 
fs
, 
dg½_t
 
group
);

956 
”rcode_t
 
ext2fs_g‘_num_dœs
(
ext2_fsys
 
fs
, 
ext2_šo_t
 *
»t_num_dœs
);

957 
”rcode_t
 
ext2fs_š™_dbli¡
(
ext2_fsys
 
fs
, 
ext2_dbli¡
 *
»t_dbli¡
);

958 
”rcode_t
 
ext2fs_add_dœ_block
(
ext2_dbli¡
 
dbli¡
, 
ext2_šo_t
 
šo
,

959 
blk_t
 
blk
, 
blockút
);

960 
”rcode_t
 
ext2fs_add_dœ_block2
(
ext2_dbli¡
 
dbli¡
, 
ext2_šo_t
 
šo
,

961 
blk64_t
 
blk
, 
e2_blkút_t
 
blockút
);

962 
ext2fs_dbli¡_sÜt
(
ext2_dbli¡
 
dbli¡
,

963 
EXT2_QSORT_TYPE
 (*
sÜtfunc
)(const *,

965 
ext2fs_dbli¡_sÜt2
(
ext2_dbli¡
 
dbli¡
,

966 
EXT2_QSORT_TYPE
 (*
sÜtfunc
)(const *,

968 
”rcode_t
 
ext2fs_dbli¡_™”©e
(
ext2_dbli¡
 
dbli¡
,

969 (*
func
)(
ext2_fsys
 
fs
, 
ext2_db_’Œy
 *
db_šfo
,

970 *
´iv_d©a
),

971 *
´iv_d©a
);

972 
”rcode_t
 
ext2fs_dbli¡_™”©e2
(
ext2_dbli¡
 
dbli¡
,

973 (*
func
)(
ext2_fsys
 
fs
, 
ext2_db_’Œy2
 *
db_šfo
,

974 *
´iv_d©a
),

975 *
´iv_d©a
);

976 
”rcode_t
 
ext2fs_£t_dœ_block
(
ext2_dbli¡
 
dbli¡
, 
ext2_šo_t
 
šo
,

977 
blk_t
 
blk
, 
blockút
);

978 
”rcode_t
 
ext2fs_£t_dœ_block2
(
ext2_dbli¡
 
dbli¡
, 
ext2_šo_t
 
šo
,

979 
blk64_t
 
blk
, 
e2_blkút_t
 
blockút
);

980 
”rcode_t
 
ext2fs_cİy_dbli¡
(
ext2_dbli¡
 
¤c
,

981 
ext2_dbli¡
 *
de¡
);

982 
ext2fs_dbli¡_couÁ
(
ext2_dbli¡
 
dbli¡
);

983 
blk64_t
 
ext2fs_dbli¡_couÁ2
(
ext2_dbli¡
 
dbli¡
);

984 
”rcode_t
 
ext2fs_dbli¡_g‘_Ï¡
(
ext2_dbli¡
 
dbli¡
,

985 
ext2_db_’Œy
 **
’Œy
);

986 
”rcode_t
 
ext2fs_dbli¡_g‘_Ï¡2
(
ext2_dbli¡
 
dbli¡
,

987 
ext2_db_’Œy2
 **
’Œy
);

988 
”rcode_t
 
ext2fs_dbli¡_drİ_Ï¡
(
ext2_dbli¡
 
dbli¡
);

991 
”rcode_t


992 
ext2fs_dbli¡_dœ_™”©e
(
ext2_dbli¡
 
dbli¡
,

993 
æags
,

994 *
block_buf
,

995 (*
func
)(
ext2_šo_t
 
dœ
,

996 
’Œy
,

997 
ext2_dœ_’Œy
 *
dœ’t
,

998 
off£t
,

999 
blocksize
,

1000 *
buf
,

1001 *
´iv_d©a
),

1002 *
´iv_d©a
);

1005 
”rcode_t
 
ext2fs_»ad_dœ_block
(
ext2_fsys
 
fs
, 
blk_t
 
block
,

1006 *
buf
);

1007 
”rcode_t
 
ext2fs_»ad_dœ_block2
(
ext2_fsys
 
fs
, 
blk_t
 
block
,

1008 *
buf
, 
æags
);

1009 
”rcode_t
 
ext2fs_»ad_dœ_block3
(
ext2_fsys
 
fs
, 
blk64_t
 
block
,

1010 *
buf
, 
æags
);

1011 
”rcode_t
 
ext2fs_wr™e_dœ_block
(
ext2_fsys
 
fs
, 
blk_t
 
block
,

1012 *
buf
);

1013 
”rcode_t
 
ext2fs_wr™e_dœ_block2
(
ext2_fsys
 
fs
, 
blk_t
 
block
,

1014 *
buf
, 
æags
);

1015 
”rcode_t
 
ext2fs_wr™e_dœ_block3
(
ext2_fsys
 
fs
, 
blk64_t
 
block
,

1016 *
buf
, 
æags
);

1019 
”rcode_t
 
ext2fs_dœhash
(
v”siÚ
, cÚ¡ *
Çme
, 
Ën
,

1020 cÚ¡ 
__u32
 *
£ed
,

1021 
ext2_dœhash_t
 *
»t_hash
,

1022 
ext2_dœhash_t
 *
»t_mšÜ_hash
);

1026 
”rcode_t
 
ext2fs_g‘_»c_Ën
(
ext2_fsys
 
fs
,

1027 
ext2_dœ_’Œy
 *
dœ’t
,

1028 *
»c_Ën
);

1029 
”rcode_t
 
ext2fs_£t_»c_Ën
(
ext2_fsys
 
fs
,

1030 
Ën
,

1031 
ext2_dœ_’Œy
 *
dœ’t
);

1032 
”rcode_t
 
ext2fs_dœ_™”©e
(
ext2_fsys
 
fs
,

1033 
ext2_šo_t
 
dœ
,

1034 
æags
,

1035 *
block_buf
,

1036 (*
func
)(
ext2_dœ_’Œy
 *
dœ’t
,

1037 
off£t
,

1038 
blocksize
,

1039 *
buf
,

1040 *
´iv_d©a
),

1041 *
´iv_d©a
);

1042 
”rcode_t
 
ext2fs_dœ_™”©e2
(
ext2_fsys
 
fs
,

1043 
ext2_šo_t
 
dœ
,

1044 
æags
,

1045 *
block_buf
,

1046 (*
func
)(
ext2_šo_t
 
dœ
,

1047 
’Œy
,

1048 
ext2_dœ_’Œy
 *
dœ’t
,

1049 
off£t
,

1050 
blocksize
,

1051 *
buf
,

1052 *
´iv_d©a
),

1053 *
´iv_d©a
);

1056 
”rcode_t
 
ext2fs_dup_hªdË
(
ext2_fsys
 
¤c
,ƒxt2_fsy *
de¡
);

1059 
”rcode_t
 
ext2fs_ex·nd_dœ
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
dœ
);

1062 
__u32
 
ext2fs_ext_©Œ_hash_’Œy
(
ext2_ext_©Œ_’Œy
 *
’Œy
,

1063 *
d©a
);

1064 
”rcode_t
 
ext2fs_»ad_ext_©Œ
(
ext2_fsys
 
fs
, 
blk_t
 
block
, *
buf
);

1065 
”rcode_t
 
ext2fs_»ad_ext_©Œ2
(
ext2_fsys
 
fs
, 
blk64_t
 
block
,

1066 *
buf
);

1067 
”rcode_t
 
ext2fs_wr™e_ext_©Œ
(
ext2_fsys
 
fs
, 
blk_t
 
block
,

1068 *
buf
);

1069 
”rcode_t
 
ext2fs_wr™e_ext_©Œ2
(
ext2_fsys
 
fs
, 
blk64_t
 
block
,

1070 *
buf
);

1071 
”rcode_t
 
ext2fs_adju¡_—_»fcouÁ
(
ext2_fsys
 
fs
, 
blk_t
 
blk
,

1072 *
block_buf
,

1073 
adju¡
, 
__u32
 *
ÃwcouÁ
);

1074 
”rcode_t
 
ext2fs_adju¡_—_»fcouÁ2
(
ext2_fsys
 
fs
, 
blk64_t
 
blk
,

1075 *
block_buf
,

1076 
adju¡
, 
__u32
 *
ÃwcouÁ
);

1079 
”rcode_t
 
ext2fs_ex‹Á_h—d”_v”ify
(*
±r
, 
size
);

1080 
”rcode_t
 
ext2fs_ex‹Á_İ’
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
šo
,

1081 
ext2_ex‹Á_hªdË_t
 *
hªdË
);

1082 
”rcode_t
 
ext2fs_ex‹Á_İ’2
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
šo
,

1083 
ext2_šode
 *
šode
,

1084 
ext2_ex‹Á_hªdË_t
 *
»t_hªdË
);

1085 
ext2fs_ex‹Á_ä“
(
ext2_ex‹Á_hªdË_t
 
hªdË
);

1086 
”rcode_t
 
ext2fs_ex‹Á_g‘
(
ext2_ex‹Á_hªdË_t
 
hªdË
,

1087 
æags
, 
ext2fs_ex‹Á
 *
ex‹Á
);

1088 
”rcode_t
 
ext2fs_ex‹Á_node_¥l™
(
ext2_ex‹Á_hªdË_t
 
hªdË
);

1089 
”rcode_t
 
ext2fs_ex‹Á_»¶aû
(
ext2_ex‹Á_hªdË_t
 
hªdË
, 
æags
,

1090 
ext2fs_ex‹Á
 *
ex‹Á
);

1091 
”rcode_t
 
ext2fs_ex‹Á_š£¹
(
ext2_ex‹Á_hªdË_t
 
hªdË
, 
æags
,

1092 
ext2fs_ex‹Á
 *
ex‹Á
);

1093 
”rcode_t
 
ext2fs_ex‹Á_£t_bm­
(
ext2_ex‹Á_hªdË_t
 
hªdË
,

1094 
blk64_t
 
logiÿl
, blk64_ˆ
physiÿl
,

1095 
æags
);

1096 
”rcode_t
 
ext2fs_ex‹Á_d–‘e
(
ext2_ex‹Á_hªdË_t
 
hªdË
, 
æags
);

1097 
”rcode_t
 
ext2fs_ex‹Á_g‘_šfo
(
ext2_ex‹Á_hªdË_t
 
hªdË
,

1098 
ext2_ex‹Á_šfo
 *
šfo
);

1099 
”rcode_t
 
ext2fs_ex‹Á_gÙo
(
ext2_ex‹Á_hªdË_t
 
hªdË
,

1100 
blk64_t
 
blk
);

1101 
”rcode_t
 
ext2fs_ex‹Á_gÙo2
(
ext2_ex‹Á_hªdË_t
 
hªdË
,

1102 
Ëaf_Ëv–
, 
blk64_t
 
blk
);

1103 
”rcode_t
 
ext2fs_ex‹Á_fix_·»Ás
(
ext2_ex‹Á_hªdË_t
 
hªdË
);

1106 
”rcode_t
 
ext2fs_fe_İ’2
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
šo
,

1107 
ext2_šode
 *
šode
,

1108 
æags
, 
ext2_fe_t
 *
»t
);

1109 
”rcode_t
 
ext2fs_fe_İ’
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
šo
,

1110 
æags
, 
ext2_fe_t
 *
»t
);

1111 
ext2_fsys
 
ext2fs_fe_g‘_fs
(
ext2_fe_t
 
fe
);

1112 
ext2_šode
 *
ext2fs_fe_g‘_šode
(
ext2_fe_t
 
fe
);

1113 
ext2_šo_t
 
ext2fs_fe_g‘_šode_num
(
ext2_fe_t
 
fe
);

1114 
”rcode_t
 
ext2fs_fe_şo£
(
ext2_fe_t
 
fe
);

1115 
”rcode_t
 
ext2fs_fe_æush
(
ext2_fe_t
 
fe
);

1116 
”rcode_t
 
ext2fs_fe_»ad
(
ext2_fe_t
 
fe
, *
buf
,

1117 
wª‹d
, *
gÙ
);

1118 
”rcode_t
 
ext2fs_fe_wr™e
(
ext2_fe_t
 
fe
, cÚ¡ *
buf
,

1119 
nby‹s
, *
wr™‹n
);

1120 
”rcode_t
 
ext2fs_fe_Î£ek
(
ext2_fe_t
 
fe
, 
__u64
 
off£t
,

1121 
wh’û
, 
__u64
 *
»t_pos
);

1122 
”rcode_t
 
ext2fs_fe_l£ek
(
ext2_fe_t
 
fe
, 
ext2_off_t
 
off£t
,

1123 
wh’û
, 
ext2_off_t
 *
»t_pos
);

1124 
”rcode_t
 
ext2fs_fe_g‘_lsize
(
ext2_fe_t
 
fe
, 
__u64
 *
»t_size
);

1125 
ext2_off_t
 
ext2fs_fe_g‘_size
(
ext2_fe_t
 
fe
);

1126 
”rcode_t
 
ext2fs_fe_£t_size
(
ext2_fe_t
 
fe
, 
ext2_off_t
 
size
);

1127 
”rcode_t
 
ext2fs_fe_£t_size2
(
ext2_fe_t
 
fe
, 
ext2_off64_t
 
size
);

1130 *
ext2fs_fšd_block_deviû
(
dev_t
 
deviû
);

1133 
”rcode_t
 
ext2fs_sync_deviû
(
fd
, 
æushb
);

1136 
ext2fs_ä“
(
ext2_fsys
 
fs
);

1137 
ext2fs_ä“_dbli¡
(
ext2_dbli¡
 
dbli¡
);

1138 
ext2fs_badblocks_li¡_ä“
(
ext2_badblocks_li¡
 
bb
);

1139 
ext2fs_u32_li¡_ä“
(
ext2_u32_li¡
 
bb
);

1142 
ext2fs_ä“_g’”ic_b™m­
(
ext2fs_šode_b™m­
 
b™m­
);

1143 
”rcode_t
 
ext2fs_make_g’”ic_b™m­
Ó¼code_ˆ
magic
, 
ext2_fsys
 
fs
,

1144 
__u32
 
¡¬t
, __u32 
’d
,

1145 
__u32
 
»®_’d
,

1146 cÚ¡ *
desü
, *
š™_m­
,

1147 
ext2fs_g’”ic_b™m­
 *
»t
);

1148 
”rcode_t
 
ext2fs_®loÿ‹_g’”ic_b™m­
(
__u32
 
¡¬t
,

1149 
__u32
 
’d
,

1150 
__u32
 
»®_’d
,

1151 cÚ¡ *
desü
,

1152 
ext2fs_g’”ic_b™m­
 *
»t
);

1153 
”rcode_t
 
ext2fs_cİy_g’”ic_b™m­
(
ext2fs_g’”ic_b™m­
 
¤c
,

1154 
ext2fs_g’”ic_b™m­
 *
de¡
);

1155 
ext2fs_ş—r_g’”ic_b™m­
(
ext2fs_g’”ic_b™m­
 
b™m­
);

1156 
”rcode_t
 
ext2fs_fudge_g’”ic_b™m­_’d
(
ext2fs_šode_b™m­
 
b™m­
,

1157 
”rcode_t
 
magic
,

1158 
”rcode_t
 
Ãq
,

1159 
ext2_šo_t
 
’d
,

1160 
ext2_šo_t
 *
Ûnd
);

1161 
ext2fs_£t_g’”ic_b™m­_·ddšg
(
ext2fs_g’”ic_b™m­
 
m­
);

1162 
”rcode_t
 
ext2fs_»size_g’”ic_b™m­
Ó¼code_ˆ
magic
,

1163 
__u32
 
Ãw_’d
,

1164 
__u32
 
Ãw_»®_’d
,

1165 
ext2fs_g’”ic_b™m­
 
bm­
);

1166 
”rcode_t
 
ext2fs_com·»_g’”ic_b™m­
Ó¼code_ˆ
magic
,ƒ¼code_ˆ
Ãq
,

1167 
ext2fs_g’”ic_b™m­
 
bm1
,

1168 
ext2fs_g’”ic_b™m­
 
bm2
);

1169 
”rcode_t
 
ext2fs_g‘_g’”ic_b™m­_¿nge
(
ext2fs_g’”ic_b™m­
 
bm­
,

1170 
”rcode_t
 
magic
,

1171 
__u32
 
¡¬t
, __u32 
num
,

1172 *
out
);

1173 
”rcode_t
 
ext2fs_£t_g’”ic_b™m­_¿nge
(
ext2fs_g’”ic_b™m­
 
bm­
,

1174 
”rcode_t
 
magic
,

1175 
__u32
 
¡¬t
, __u32 
num
,

1176 *
š
);

1177 
”rcode_t
 
ext2fs_fšd_fœ¡_z”o_g’”ic_b™m­
(
ext2fs_g’”ic_b™m­
 
b™m­
,

1178 
__u32
 
¡¬t
, __u32 
’d
,

1179 
__u32
 *
out
);

1184 
	#BMAP_STATS


	)

1186 
ext2fs_ä“_g’”ic_bm­
(
ext2fs_g’”ic_b™m­
 
bm­
);

1187 
”rcode_t
 
ext2fs_®loc_g’”ic_bm­
(
ext2_fsys
 
fs
,ƒ¼code_ˆ
magic
,

1188 
ty³
, 
__u64
 
¡¬t
, __u64 
’d
,

1189 
__u64
 
»®_’d
,

1190 cÚ¡ *
desü
,

1191 
ext2fs_g’”ic_b™m­
 *
»t
);

1192 
”rcode_t
 
ext2fs_cİy_g’”ic_bm­
(
ext2fs_g’”ic_b™m­
 
¤c
,

1193 
ext2fs_g’”ic_b™m­
 *
de¡
);

1194 
ext2fs_ş—r_g’”ic_bm­
(
ext2fs_g’”ic_b™m­
 
b™m­
);

1195 
”rcode_t
 
ext2fs_fudge_g’”ic_bm­_’d
(
ext2fs_g’”ic_b™m­
 
b™m­
,

1196 
”rcode_t
 
Ãq
,

1197 
__u64
 
’d
, __u64 *
Ûnd
);

1198 
ext2fs_£t_g’”ic_bm­_·ddšg
(
ext2fs_g’”ic_b™m­
 
bm­
);

1199 
”rcode_t
 
ext2fs_»size_g’”ic_bm­
(
ext2fs_g’”ic_b™m­
 
bm­
,

1200 
__u64
 
Ãw_’d
,

1201 
__u64
 
Ãw_»®_’d
);

1202 
”rcode_t
 
ext2fs_com·»_g’”ic_bm­
Ó¼code_ˆ
Ãq
,

1203 
ext2fs_g’”ic_b™m­
 
bm1
,

1204 
ext2fs_g’”ic_b™m­
 
bm2
);

1205 
”rcode_t
 
ext2fs_g‘_g’”ic_bm­_¿nge
(
ext2fs_g’”ic_b™m­
 
bm­
,

1206 
__u64
 
¡¬t
, 
num
,

1207 *
out
);

1208 
”rcode_t
 
ext2fs_£t_g’”ic_bm­_¿nge
(
ext2fs_g’”ic_b™m­
 
bm­
,

1209 
__u64
 
¡¬t
, 
num
,

1210 *
š
);

1211 
”rcode_t
 
ext2fs_cÚv”t_subşu¡”_b™m­
(
ext2_fsys
 
fs
,

1212 
ext2fs_block_b™m­
 *
b™m­
);

1215 
”rcode_t
 
ext2fs_g‘_deviû_size
(cÚ¡ *
fe
, 
blocksize
,

1216 
blk_t
 *
»tblocks
);

1217 
”rcode_t
 
ext2fs_g‘_deviû_size2
(cÚ¡ *
fe
, 
blocksize
,

1218 
blk64_t
 *
»tblocks
);

1221 
ext2fs_g‘_dio_®ignm’t
(
fd
);

1222 
”rcode_t
 
ext2fs_g‘_deviû_£ùsize
(cÚ¡ *
fe
, *
£ùsize
);

1223 
”rcode_t
 
ext2fs_g‘_deviû_phys_£ùsize
(cÚ¡ *
fe
, *
£ùsize
);

1226 
”rcode_t
 
ext2fs_iblk_add_blocks
(
ext2_fsys
 
fs
, 
ext2_šode
 *
šode
,

1227 
blk64_t
 
num_blocks
);

1228 
”rcode_t
 
ext2fs_iblk_sub_blocks
(
ext2_fsys
 
fs
, 
ext2_šode
 *
šode
,

1229 
blk64_t
 
num_blocks
);

1230 
”rcode_t
 
ext2fs_iblk_£t
(
ext2_fsys
 
fs
, 
ext2_šode
 *
šode
, 
blk64_t
 
b
);

1233 
”rcode_t
 
ext2fs_image_šode_wr™e
(
ext2_fsys
 
fs
, 
fd
, 
æags
);

1234 
”rcode_t
 
ext2fs_image_šode_»ad
(
ext2_fsys
 
fs
, 
fd
, 
æags
);

1235 
”rcode_t
 
ext2fs_image_su³r_wr™e
(
ext2_fsys
 
fs
, 
fd
, 
æags
);

1236 
”rcode_t
 
ext2fs_image_su³r_»ad
(
ext2_fsys
 
fs
, 
fd
, 
æags
);

1237 
”rcode_t
 
ext2fs_image_b™m­_wr™e
(
ext2_fsys
 
fs
, 
fd
, 
æags
);

1238 
”rcode_t
 
ext2fs_image_b™m­_»ad
(
ext2_fsys
 
fs
, 
fd
, 
æags
);

1241 
”rcode_t
 
ext2fs_»ad_šd_block
(
ext2_fsys
 
fs
, 
blk_t
 
blk
, *
buf
);

1242 
”rcode_t
 
ext2fs_wr™e_šd_block
(
ext2_fsys
 
fs
, 
blk_t
 
blk
, *
buf
);

1245 
”rcode_t
 
ext2fs_š™Ÿlize
(cÚ¡ *
Çme
, 
æags
,

1246 
ext2_su³r_block
 *
·¿m
,

1247 
io_mªag”
 
mªag”
, 
ext2_fsys
 *
»t_fs
);

1250 
ext2fs_ä“_icouÁ
(
ext2_icouÁ_t
 
icouÁ
);

1251 
”rcode_t
 
ext2fs_ü—‹_icouÁ_tdb
(
ext2_fsys
 
fs
, *
tdb_dœ
,

1252 
æags
, 
ext2_icouÁ_t
 *
»t
);

1253 
”rcode_t
 
ext2fs_ü—‹_icouÁ2
(
ext2_fsys
 
fs
, 
æags
,

1254 
size
,

1255 
ext2_icouÁ_t
 
hšt
,ƒxt2_icouÁ_ˆ*
»t
);

1256 
”rcode_t
 
ext2fs_ü—‹_icouÁ
(
ext2_fsys
 
fs
, 
æags
,

1257 
size
,

1258 
ext2_icouÁ_t
 *
»t
);

1259 
”rcode_t
 
ext2fs_icouÁ_ãtch
(
ext2_icouÁ_t
 
icouÁ
, 
ext2_šo_t
 
šo
,

1260 
__u16
 *
»t
);

1261 
”rcode_t
 
ext2fs_icouÁ_šüem’t
(
ext2_icouÁ_t
 
icouÁ
, 
ext2_šo_t
 
šo
,

1262 
__u16
 *
»t
);

1263 
”rcode_t
 
ext2fs_icouÁ_deüem’t
(
ext2_icouÁ_t
 
icouÁ
, 
ext2_šo_t
 
šo
,

1264 
__u16
 *
»t
);

1265 
”rcode_t
 
ext2fs_icouÁ_¡Üe
(
ext2_icouÁ_t
 
icouÁ
, 
ext2_šo_t
 
šo
,

1266 
__u16
 
couÁ
);

1267 
ext2_šo_t
 
ext2fs_g‘_icouÁ_size
(
ext2_icouÁ_t
 
icouÁ
);

1268 
”rcode_t
 
ext2fs_icouÁ_v®id©e
(
ext2_icouÁ_t
 
icouÁ
, 
FILE
 *);

1272 
”rcode_t
 
ext2fs_g‘_mem®ign
(
size
,

1273 
®ign
, *
±r
);

1276 
”rcode_t
 
ext2fs_æush_iÿche
(
ext2_fsys
 
fs
);

1277 
”rcode_t
 
ext2fs_g‘_Ãxt_šode_fuÎ
(
ext2_šode_sÿn
 
sÿn
,

1278 
ext2_šo_t
 *
šo
,

1279 
ext2_šode
 *
šode
,

1280 
bufsize
);

1281 
”rcode_t
 
ext2fs_İ’_šode_sÿn
(
ext2_fsys
 
fs
, 
bufãr_blocks
,

1282 
ext2_šode_sÿn
 *
»t_sÿn
);

1283 
ext2fs_şo£_šode_sÿn
(
ext2_šode_sÿn
 
sÿn
);

1284 
”rcode_t
 
ext2fs_g‘_Ãxt_šode
(
ext2_šode_sÿn
 
sÿn
, 
ext2_šo_t
 *
šo
,

1285 
ext2_šode
 *
šode
);

1286 
”rcode_t
 
ext2fs_šode_sÿn_gÙo_blockgroup
(
ext2_šode_sÿn
 
sÿn
,

1287 
group
);

1288 
ext2fs_£t_šode_ÿÎback


1289 (
ext2_šode_sÿn
 
sÿn
,

1290 
”rcode_t
 (*
dÚe_group
)(
ext2_fsys
 
fs
,

1291 
ext2_šode_sÿn
 
sÿn
,

1292 
dg½_t
 
group
,

1293 * 
´iv_d©a
),

1294 *
dÚe_group_d©a
);

1295 
ext2fs_šode_sÿn_æags
(
ext2_šode_sÿn
 
sÿn
, 
£t_æags
,

1296 
ş—r_æags
);

1297 
”rcode_t
 
ext2fs_»ad_šode_fuÎ
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
šo
,

1298 
ext2_šode
 * 
šode
,

1299 
bufsize
);

1300 
”rcode_t
 
ext2fs_»ad_šode
 (
ext2_fsys
 
fs
, 
ext2_šo_t
 
šo
,

1301 
ext2_šode
 * 
šode
);

1302 
”rcode_t
 
ext2fs_wr™e_šode_fuÎ
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
šo
,

1303 
ext2_šode
 * 
šode
,

1304 
bufsize
);

1305 
”rcode_t
 
ext2fs_wr™e_šode
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
šo
,

1306 
ext2_šode
 * 
šode
);

1307 
”rcode_t
 
ext2fs_wr™e_Ãw_šode
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
šo
,

1308 
ext2_šode
 * 
šode
);

1309 
”rcode_t
 
ext2fs_g‘_blocks
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
šo
, 
blk_t
 *
blocks
);

1310 
”rcode_t
 
ext2fs_check_dœeùÜy
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
šo
);

1313 
io_mªag”
 
šode_io_mªag”
;

1314 
”rcode_t
 
ext2fs_šode_io_š‹º
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
šo
,

1315 **
Çme
);

1316 
”rcode_t
 
ext2fs_šode_io_š‹º2
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
šo
,

1317 
ext2_šode
 *
šode
,

1318 **
Çme
);

1321 
”rcode_t
 
ext2fs_check_if_mouÁed
(cÚ¡ *
fe
, *
mouÁ_æags
);

1322 
”rcode_t
 
ext2fs_check_mouÁ_pošt
(cÚ¡ *
deviû
, *
mouÁ_æags
,

1323 *
mt
, 
m’
);

1330 
”rcode_t
 
ext2fs_punch
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
šo
,

1331 
ext2_šode
 *
šode
,

1332 *
block_buf
, 
blk64_t
 
¡¬t
,

1333 
blk64_t
 
’d
);

1336 
”rcode_t
 
ext2fs_lookup
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
dœ
, cÚ¡ *
Çme
,

1337 
Çm–’
, *
buf
, 
ext2_šo_t
 *
šode
);

1338 
”rcode_t
 
ext2fs_Çmei
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
roÙ
,ƒxt2_šo_ˆ
cwd
,

1339 cÚ¡ *
Çme
, 
ext2_šo_t
 *
šode
);

1340 
”rcode_t
 
ext2fs_Çmei_fŞlow
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
roÙ
,ƒxt2_šo_ˆ
cwd
,

1341 cÚ¡ *
Çme
, 
ext2_šo_t
 *
šode
);

1342 
”rcode_t
 
ext2fs_fŞlow_lšk
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
roÙ
,ƒxt2_šo_ˆ
cwd
,

1343 
ext2_šo_t
 
šode
,ƒxt2_šo_ˆ*
»s_šode
);

1346 
ext2fs_Çtive_æag
();

1349 
”rcode_t
 
ext2fs_Ãw_dœ_block
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
dœ_šo
,

1350 
ext2_šo_t
 
·»Á_šo
, **
block
);

1353 
”rcode_t
 
ext2fs_mkdœ
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
·»Á
,ƒxt2_šo_ˆ
šum
,

1354 cÚ¡ *
Çme
);

1357 
”rcode_t
 
ext2fs_z”o_blocks
(
ext2_fsys
 
fs
, 
blk_t
 
blk
, 
num
,

1358 
blk_t
 *
»t_blk
, *
»t_couÁ
);

1359 
”rcode_t
 
ext2fs_z”o_blocks2
(
ext2_fsys
 
fs
, 
blk64_t
 
blk
, 
num
,

1360 
blk64_t
 *
»t_blk
, *
»t_couÁ
);

1361 
”rcode_t
 
ext2fs_ü—‹_jouº®_su³rblock
(
ext2_fsys
 
fs
,

1362 
__u32
 
num_blocks
, 
æags
,

1363 **
»t_jsb
);

1364 
”rcode_t
 
ext2fs_add_jouº®_deviû
(
ext2_fsys
 
fs
,

1365 
ext2_fsys
 
jouº®_dev
);

1366 
”rcode_t
 
ext2fs_add_jouº®_šode
(
ext2_fsys
 
fs
, 
blk_t
 
num_blocks
,

1367 
æags
);

1368 
ext2fs_deçuÉ_jouº®_size
(
__u64
 
num_blocks
);

1371 
”rcode_t
 
ext2fs_İ’
(cÚ¡ *
Çme
, 
æags
, 
su³rblock
,

1372 
block_size
, 
io_mªag”
 
mªag”
,

1373 
ext2_fsys
 *
»t_fs
);

1374 
”rcode_t
 
ext2fs_İ’2
(cÚ¡ *
Çme
, cÚ¡ *
io_İtiÚs
,

1375 
æags
, 
su³rblock
,

1376 
block_size
, 
io_mªag”
 
mªag”
,

1377 
ext2_fsys
 *
»t_fs
);

1378 
blk64_t
 
ext2fs_desütÜ_block_loc2
(
ext2_fsys
 
fs
,

1379 
blk64_t
 
group_block
, 
dg½_t
 
i
);

1380 
blk_t
 
ext2fs_desütÜ_block_loc
(
ext2_fsys
 
fs
, blk_ˆ
group_block
,

1381 
dg½_t
 
i
);

1382 
”rcode_t
 
ext2fs_g‘_d©a_io
(
ext2_fsys
 
fs
, 
io_chªÃl
 *
Şd_io
);

1383 
”rcode_t
 
ext2fs_£t_d©a_io
(
ext2_fsys
 
fs
, 
io_chªÃl
 
Ãw_io
);

1384 
”rcode_t
 
ext2fs_»wr™e_to_io
(
ext2_fsys
 
fs
, 
io_chªÃl
 
Ãw_io
);

1387 
”rcode_t
 
ext2fs_g‘_·thÇme
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
dœ
,ƒxt2_šo_ˆ
šo
,

1388 **
Çme
);

1391 
”rcode_t
 
ext2fs_lšk
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
dœ
, cÚ¡ *
Çme
,

1392 
ext2_šo_t
 
šo
, 
æags
);

1393 
”rcode_t
 
ext2fs_uÆšk
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
dœ
, cÚ¡ *
Çme
,

1394 
ext2_šo_t
 
šo
, 
æags
);

1397 
”rcode_t
 
ext2fs_symlšk
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
·»Á
,ƒxt2_šo_ˆ
šo
,

1398 cÚ¡ *
Çme
, *
rg‘
);

1401 
”rcode_t
 
ext2fs_mmp_»ad
(
ext2_fsys
 
fs
, 
blk64_t
 
mmp_blk
, *
buf
);

1402 
”rcode_t
 
ext2fs_mmp_wr™e
(
ext2_fsys
 
fs
, 
blk64_t
 
mmp_blk
, *
buf
);

1403 
”rcode_t
 
ext2fs_mmp_ş—r
(
ext2_fsys
 
fs
);

1404 
”rcode_t
 
ext2fs_mmp_š™
(
ext2_fsys
 
fs
);

1405 
”rcode_t
 
ext2fs_mmp_¡¬t
(
ext2_fsys
 
fs
);

1406 
”rcode_t
 
ext2fs_mmp_upd©e
(
ext2_fsys
 
fs
);

1407 
”rcode_t
 
ext2fs_mmp_¡İ
(
ext2_fsys
 
fs
);

1408 
ext2fs_mmp_Ãw_£q
();

1411 
”rcode_t
 
ext2fs_»ad_bb_šode
(
ext2_fsys
 
fs
,

1412 
ext2_badblocks_li¡
 *
bb_li¡
);

1415 
”rcode_t
 
ext2fs_»ad_bb_FILE2
(
ext2_fsys
 
fs
, 
FILE
 *
f
,

1416 
ext2_badblocks_li¡
 *
bb_li¡
,

1417 *
´iv_d©a
,

1418 (*
šv®id
)(
ext2_fsys
 
fs
,

1419 
blk_t
 
blk
,

1420 *
bad¡r
,

1421 *
´iv_d©a
));

1422 
”rcode_t
 
ext2fs_»ad_bb_FILE
(
ext2_fsys
 
fs
, 
FILE
 *
f
,

1423 
ext2_badblocks_li¡
 *
bb_li¡
,

1424 (*
šv®id
)(
ext2_fsys
 
fs
,

1425 
blk_t
 
blk
));

1428 
”rcode_t
 
ext2fs_ü—‹_»size_šode
(
ext2_fsys
 
fs
);

1431 
ext2fs_sw­_ext_©Œ
(*
to
, *
äom
, 
bufsize
,

1432 
has_h—d”
);

1433 
ext2fs_sw­_ext_©Œ_h—d”
(
ext2_ext_©Œ_h—d”
 *
to_h—d”
,

1434 
ext2_ext_©Œ_h—d”
 *
äom_hdr
);

1435 
ext2fs_sw­_ext_©Œ_’Œy
(
ext2_ext_©Œ_’Œy
 *
to_’Œy
,

1436 
ext2_ext_©Œ_’Œy
 *
äom_’Œy
);

1437 
ext2fs_sw­_su³r
(
ext2_su³r_block
 * 
su³r
);

1438 
ext2fs_sw­_group_desc
(
ext2_group_desc
 *
gdp
);

1439 
ext2fs_sw­_group_desc2
(
ext2_fsys
, 
ext2_group_desc
 *
gdp
);

1440 
ext2fs_sw­_šode_fuÎ
(
ext2_fsys
 
fs
, 
ext2_šode_Ïrge
 *
t
,

1441 
ext2_šode_Ïrge
 *
f
, 
ho¡Üd”
,

1442 
bufsize
);

1443 
ext2fs_sw­_šode
(
ext2_fsys
 
fs
,
ext2_šode
 *
t
,

1444 
ext2_šode
 *
f
, 
ho¡Üd”
);

1445 
ext2fs_sw­_mmp
(
mmp_¡ruù
 *
mmp
);

1448 
ext2fs_İ’_fe
(cÚ¡ *
·thÇme
, 
æags
, 
mode_t
 
mode
);

1449 
ext2fs_¡©
(cÚ¡ *
·th
, 
ext2fs_¡ruù_¡©
 *
buf
);

1450 
ext2fs_f¡©
(
fd
, 
ext2fs_¡ruù_¡©
 *
buf
);

1453 
ext2fs_šode_has_v®id_blocks
(
ext2_šode
 *
šode
);

1454 
ext2fs_šode_has_v®id_blocks2
(
ext2_fsys
 
fs
,

1455 
ext2_šode
 *
šode
);

1458 
ext2fs_·r£_v”siÚ_¡ršg
(cÚ¡ *
v”_¡ršg
);

1459 
ext2fs_g‘_lib¿ry_v”siÚ
(cÚ¡ **
v”_¡ršg
,

1460 cÚ¡ **
d©e_¡ršg
);

1463 
”rcode_t
 
ext2fs_wr™e_bb_FILE
(
ext2_badblocks_li¡
 
bb_li¡
,

1464 
æags
,

1465 
FILE
 *
f
);

1469 #ifdeà
NO_INLINE_FUNCS


1470 
”rcode_t
 
ext2fs_g‘_mem
(
size
, *
±r
);

1471 
”rcode_t
 
ext2fs_g‘_memz”o
(
size
, *
±r
);

1472 
”rcode_t
 
ext2fs_g‘_¬¿y
(
couÁ
,

1473 
size
, *
±r
);

1474 
”rcode_t
 
ext2fs_g‘_¬¿yz”o
(
couÁ
,

1475 
size
, *
±r
);

1476 
”rcode_t
 
ext2fs_ä“_mem
(*
±r
);

1477 
”rcode_t
 
ext2fs_»size_mem
(
Şd_size
,

1478 
size
, *
±r
);

1479 
ext2fs_m¬k_su³r_dœty
(
ext2_fsys
 
fs
);

1480 
ext2fs_m¬k_chªged
(
ext2_fsys
 
fs
);

1481 
ext2fs_‹¡_chªged
(
ext2_fsys
 
fs
);

1482 
ext2fs_m¬k_v®id
(
ext2_fsys
 
fs
);

1483 
ext2fs_unm¬k_v®id
(
ext2_fsys
 
fs
);

1484 
ext2fs_‹¡_v®id
(
ext2_fsys
 
fs
);

1485 
ext2fs_m¬k_ib_dœty
(
ext2_fsys
 
fs
);

1486 
ext2fs_m¬k_bb_dœty
(
ext2_fsys
 
fs
);

1487 
ext2fs_‹¡_ib_dœty
(
ext2_fsys
 
fs
);

1488 
ext2fs_‹¡_bb_dœty
(
ext2_fsys
 
fs
);

1489 
dg½_t
 
ext2fs_group_of_blk
(
ext2_fsys
 
fs
, 
blk_t
 
blk
);

1490 
dg½_t
 
ext2fs_group_of_šo
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
šo
);

1491 
blk_t
 
ext2fs_group_fœ¡_block
(
ext2_fsys
 
fs
, 
dg½_t
 
group
);

1492 
blk_t
 
ext2fs_group_Ï¡_block
(
ext2_fsys
 
fs
, 
dg½_t
 
group
);

1493 
blk_t
 
ext2fs_šode_d©a_blocks
(
ext2_fsys
 
fs
,

1494 
ext2_šode
 *
šode
);

1495 
ext2fs_div_û
(
a
, 
b
);

1496 
__u64
 
ext2fs_div64_û
(__u64 
a
, __u64 
b
);

1505 #ià(
defšed
(
INCLUDE_INLINE_FUNCS
è|| !defšed(
NO_INLINE_FUNCS
))

1506 #ifdeà
INCLUDE_INLINE_FUNCS


1507 
	#_INLINE_
 

	)

1509 #ià(
__STDC_VERSION__
 >= 199901L)

1510 
	#_INLINE_
 
šlše


	)

1512 #ifdeà
__GNUC__


1513 
	#_INLINE_
 
__šlše__


	)

1515 
	#_INLINE_
 
šlše


	)

1520 #iâdeà
EXT2_CUSTOM_MEMORY_ROUTINES


1521 
	~<¡ršg.h
>

1525 
_INLINE_
 
”rcode_t
 
ext2fs_g‘_mem
(
size
, *
±r
)

1527 *
µ
;

1529 
µ
 = 
m®loc
(
size
);

1530 ià(!
µ
)

1531  
EXT2_ET_NO_MEMORY
;

1532 
memıy
(
±r
, &
µ
,  (pp));

1536 
_INLINE_
 
”rcode_t
 
ext2fs_g‘_memz”o
(
size
, *
±r
)

1538 *
µ
;

1540 
µ
 = 
m®loc
(
size
);

1541 ià(!
µ
)

1542  
EXT2_ET_NO_MEMORY
;

1543 
mem£t
(
µ
, 0, 
size
);

1544 
memıy
(
±r
, &
µ
, (pp));

1548 
_INLINE_
 
”rcode_t
 
ext2fs_g‘_¬¿y
(
couÁ
, 
size
, *
±r
)

1550 ià(
couÁ
 && (-1UL)/couÁ<
size
)

1551  
EXT2_ET_NO_MEMORY
;

1552  
ext2fs_g‘_mem
(
couÁ
*
size
, 
±r
);

1555 
_INLINE_
 
”rcode_t
 
ext2fs_g‘_¬¿yz”o
(
couÁ
,

1556 
size
, *
±r
)

1558 *
µ
;

1560 ià(
couÁ
 && (-1UL)/couÁ<
size
)

1561  
EXT2_ET_NO_MEMORY
;

1562 
µ
 = 
ÿÎoc
(
couÁ
, 
size
);

1563 ià(!
µ
)

1564  
EXT2_ET_NO_MEMORY
;

1565 
memıy
(
±r
, &
µ
, (pp));

1572 
_INLINE_
 
”rcode_t
 
ext2fs_ä“_mem
(*
±r
)

1574 *
p
;

1576 
memıy
(&
p
, 
±r
, (p));

1577 
ä“
(
p
);

1578 
p
 = 0;

1579 
memıy
(
±r
, &
p
, (p));

1586 
_INLINE_
 
”rcode_t
 
ext2fs_»size_mem
(
EXT2FS_ATTR
((
unu£d
)è
Şd_size
,

1587 
size
, *
±r
)

1589 *
p
;

1593 
memıy
(&
p
, 
±r
, (p));

1594 
p
 = 
»®loc
Õ, 
size
);

1595 ià(!
p
)

1596  
EXT2_ET_NO_MEMORY
;

1597 
memıy
(
±r
, &
p
, (p));

1605 
_INLINE_
 
ext2fs_m¬k_su³r_dœty
(
ext2_fsys
 
fs
)

1607 
fs
->
æags
 |ğ
EXT2_FLAG_DIRTY
 | 
EXT2_FLAG_CHANGED
;

1613 
_INLINE_
 
ext2fs_m¬k_chªged
(
ext2_fsys
 
fs
)

1615 
fs
->
æags
 |ğ
EXT2_FLAG_CHANGED
;

1621 
_INLINE_
 
ext2fs_‹¡_chªged
(
ext2_fsys
 
fs
)

1623  (
fs
->
æags
 & 
EXT2_FLAG_CHANGED
);

1629 
_INLINE_
 
ext2fs_m¬k_v®id
(
ext2_fsys
 
fs
)

1631 
fs
->
æags
 |ğ
EXT2_FLAG_VALID
;

1637 
_INLINE_
 
ext2fs_unm¬k_v®id
(
ext2_fsys
 
fs
)

1639 
fs
->
æags
 &ğ~
EXT2_FLAG_VALID
;

1645 
_INLINE_
 
ext2fs_‹¡_v®id
(
ext2_fsys
 
fs
)

1647  (
fs
->
æags
 & 
EXT2_FLAG_VALID
);

1653 
_INLINE_
 
ext2fs_m¬k_ib_dœty
(
ext2_fsys
 
fs
)

1655 
fs
->
æags
 |ğ
EXT2_FLAG_IB_DIRTY
 | 
EXT2_FLAG_CHANGED
;

1661 
_INLINE_
 
ext2fs_m¬k_bb_dœty
(
ext2_fsys
 
fs
)

1663 
fs
->
æags
 |ğ
EXT2_FLAG_BB_DIRTY
 | 
EXT2_FLAG_CHANGED
;

1669 
_INLINE_
 
ext2fs_‹¡_ib_dœty
(
ext2_fsys
 
fs
)

1671  (
fs
->
æags
 & 
EXT2_FLAG_IB_DIRTY
);

1677 
_INLINE_
 
ext2fs_‹¡_bb_dœty
(
ext2_fsys
 
fs
)

1679  (
fs
->
æags
 & 
EXT2_FLAG_BB_DIRTY
);

1685 
_INLINE_
 
dg½_t
 
ext2fs_group_of_blk
(
ext2_fsys
 
fs
, 
blk_t
 
blk
)

1687  
ext2fs_group_of_blk2
(
fs
, 
blk
);

1692 
_INLINE_
 
dg½_t
 
ext2fs_group_of_šo
(
ext2_fsys
 
fs
, 
ext2_šo_t
 
šo
)

1694  (
šo
 - 1è/ 
fs
->
su³r
->
s_šodes_³r_group
;

1700 
_INLINE_
 
blk_t
 
ext2fs_group_fœ¡_block
(
ext2_fsys
 
fs
, 
dg½_t
 
group
)

1702  (
blk_t
è
ext2fs_group_fœ¡_block2
(
fs
, 
group
);

1708 
_INLINE_
 
blk_t
 
ext2fs_group_Ï¡_block
(
ext2_fsys
 
fs
, 
dg½_t
 
group
)

1710  (
blk_t
è
ext2fs_group_Ï¡_block2
(
fs
, 
group
);

1713 
_INLINE_
 
blk_t
 
ext2fs_šode_d©a_blocks
(
ext2_fsys
 
fs
,

1714 
ext2_šode
 *
šode
)

1716  (
blk_t
è
ext2fs_šode_d©a_blocks2
(
fs
, 
šode
);

1722 
_INLINE_
 
ext2fs_div_û
(
a
, 
b
)

1724 ià(!
a
)

1726  ((
a
 - 1è/ 
b
) + 1;

1729 
_INLINE_
 
__u64
 
ext2fs_div64_û
(__u64 
a
, __u64 
b
)

1731 ià(!
a
)

1733  ((
a
 - 1è/ 
b
) + 1;

1736 #undeà
_INLINE_


1739 #ifdeà
__ılu¥lus


	@libmke2fs/ext2fsP.h

12 
	~"ext2fs.h
"

14 
	#EXT2FS_MAX_NESTED_LINKS
 8

	)

19 
	sext2_¡ruù_u32_li¡
 {

20 
	mmagic
;

21 
	mnum
;

22 
	msize
;

23 
__u32
 *
	mli¡
;

24 
	mbadblocks_æags
;

27 
	sext2_¡ruù_u32_™”©e
 {

28 
	mmagic
;

29 
ext2_u32_li¡
 
	mbb
;

30 
	m±r
;

37 
	sext2_¡ruù_dbli¡
 {

38 
	mmagic
;

39 
ext2_fsys
 
	mfs
;

40 
	msize
;

41 
	mcouÁ
;

42 
	msÜ‹d
;

43 
ext2_db_’Œy2
 * 
	mli¡
;

49 
	sdœ_cÚ‹xt
 {

50 
ext2_šo_t
 
	mdœ
;

51 
	mæags
;

52 *
	mbuf
;

53 (*
	mfunc
)(
ext2_šo_t
 
	mdœ
,

54 
	m’Œy
,

55 
ext2_dœ_’Œy
 *
	mdœ’t
,

56 
	moff£t
,

57 
	mblocksize
,

58 *
	mbuf
,

59 *
	m´iv_d©a
);

60 *
	m´iv_d©a
;

61 
”rcode_t
 
	m”rcode
;

67 
	sext2_šode_ÿche
 {

68 * 
	mbufãr
;

69 
blk64_t
 
	mbufãr_blk
;

70 
	mÿche_Ï¡
;

71 
	mÿche_size
;

72 
	m»fcouÁ
;

73 
ext2_šode_ÿche_’t
 *
	mÿche
;

76 
	sext2_šode_ÿche_’t
 {

77 
ext2_šo_t
 
	mšo
;

78 
ext2_šode
 
	mšode
;

83 
ext2fs_´oûss_dœ_block
(
ext2_fsys
 
fs
,

84 
blk64_t
 *
blockÄ
,

85 
e2_blkút_t
 
blockút
,

86 
blk64_t
 
»f_block
,

87 
»f_off£t
,

88 *
´iv_d©a
);

92 
	sext2fs_num”ic_´og»ss_¡ruù
 {

93 
__u64
 
	mmax
;

94 
	mlog_max
;

95 
	msk_´og»ss
;

98 
ext2fs_num”ic_´og»ss_š™
(
ext2_fsys
 
fs
,

99 
ext2fs_num”ic_´og»ss_¡ruù
 * 
´og»ss
,

100 cÚ¡ *
Ïb–
, 
__u64
 
max
);

101 
ext2fs_num”ic_´og»ss_upd©e
(
ext2_fsys
 
fs
,

102 
ext2fs_num”ic_´og»ss_¡ruù
 * 
´og»ss
,

103 
__u64
 
v®
);

104 
ext2fs_num”ic_´og»ss_şo£
(
ext2_fsys
 
fs
,

105 
ext2fs_num”ic_´og»ss_¡ruù
 * 
´og»ss
,

106 cÚ¡ *
mes§ge
);

112 
”rcode_t
 
ext2fs_®loc_g’”ic_bm­
(
ext2_fsys
 
fs
,ƒ¼code_ˆ
magic
,

113 
ty³
, 
__u64
 
¡¬t
, __u64 
’d
,

114 
__u64
 
»®_’d
,

115 cÚ¡ * 
desütiÚ
,

116 
ext2fs_g’”ic_b™m­
 *
bm­
);

118 
ext2fs_ä“_g’”ic_bm­
(
ext2fs_g’”ic_b™m­
 
bm­
);

120 
”rcode_t
 
ext2fs_cİy_g’”ic_bm­
(
ext2fs_g’”ic_b™m­
 
¤c
,

121 
ext2fs_g’”ic_b™m­
 *
de¡
);

123 
”rcode_t
 
ext2fs_»size_g’”ic_bm­
(
ext2fs_g’”ic_b™m­
 
bm­
,

124 
__u64
 
Ãw_’d
,

125 
__u64
 
Ãw_»®_’d
);

126 
”rcode_t
 
ext2fs_fudge_g’”ic_bm­_’d
(
ext2fs_g’”ic_b™m­
 
b™m­
,

127 
”rcode_t
 
Ãq
,

128 
__u64
 
’d
, __u64 *
Ûnd
);

129 
ext2fs_m¬k_g’”ic_bm­
(
ext2fs_g’”ic_b™m­
 
b™m­
,

130 
__u64
 
¬g
);

131 
ext2fs_unm¬k_g’”ic_bm­
(
ext2fs_g’”ic_b™m­
 
b™m­
,

132 
__u64
 
¬g
);

133 
ext2fs_‹¡_g’”ic_bm­
(
ext2fs_g’”ic_b™m­
 
b™m­
,

134 
__u64
 
¬g
);

135 
”rcode_t
 
ext2fs_£t_g’”ic_bm­_¿nge
(
ext2fs_g’”ic_b™m­
 
b™m­
,

136 
__u64
 
¡¬t
, 
num
,

137 *
š
);

138 
”rcode_t
 
ext2fs_g‘_g’”ic_bm­_¿nge
(
ext2fs_g’”ic_b™m­
 
b™m­
,

139 
__u64
 
¡¬t
, 
num
,

140 *
out
);

141 
ext2fs_w¬n_b™m­32
(
ext2fs_g’”ic_b™m­
 
b™m­
,cÚ¡ *
func
);

143 
ext2fs_mem_is_z”o
(cÚ¡ *
mem
, 
size_t
 
Ën
);

145 
ext2fs_fe_block_off£t_too_big
(
ext2_fsys
 
fs
,

146 
ext2_šode
 *
šode
,

147 
blk64_t
 
off£t
);

	@libmke2fs/mke2fs.h

1 #iâdeà
__MKE2FS_H__


2 
	#__MKE2FS_H__


	)

4 
	~"ext2fs/ext2fs.h
"

5 
	~"mke2fs_”r.h
"

8 
	mWRITE_INODE_TABLES_UNKNOWN
 = 0,

9 
	mWRITE_INODE_TABLES_INIT
,

10 
	mWRITE_INODE_TABLES_WRITING
,

11 
	mWRITE_INODE_TABLES_WRITING_DONE
,

12 
	mWRITE_INODE_TABLES_DONE
,

13 
	mWRITE_INODE_TABLES_ERROR
,

16 
	sex‹nded_İt
 {

17 
__u16
 
	m¡ride
;

18 
__u32
 
	m¡re_width
;

19 
__u16
 
	mdesc_size
;

20 
__u16
 
	mmmp_upd©e_š‹rv®
;

21 
	m‹¡_fs
;

22 
	mdisÿrd
;

25 
	se2fs_cfg
 {

26 
	m»£rved_¿tio
;

27 
	mnum_šodes
;

28 
	mæex_bg_size
;

29 
__u32
 
	mblocks_³r_group
;

30 
__u32
 
	mü—tÜ_os
;

31 
	mblocksize
;

32 
	mşu¡”_size
;

33 
	mdœeù_io
;

34 
	mfÜû
;

35 
	mcæag
;

36 
	mv”bo£
;

37 
	mqu›t
;

38 
	mr_İt
;

39 
	msu³r_Úly
;

40 
	mšode_¿tio
;

41 
	mšode_size
;

42 
	mjouº®_size
;

43 
	mnßùiÚ
;

44 
	mbad_blocks_f’ame
[512];

45 
	mfs_ã©u»s
[256];

46 
	mu§ge_ty³s
[256];

47 
	mmouÁ_dœ
[64];

48 
	mfs_uuid
[64];

49 
	mfs_ty³
[16];

50 
	mvŞume_Ïb–
[16];

52 
ex‹nded_İt
 
	mext_İts
;

55 (*
	tmke2fs_cb_func
)(*
	tpD©a
, 
	t¡©
, 
	tcu¼’t
, 
	ttÙ®
);

57 
	smke2fs_hªdË
 {

59 
e2fs_cfg
 
cfg
;

60 
deviû_Çme
[32];

61 *
buf
;

62 *
pD©a
;

63 
mke2fs_cb_func
 
cb_func
;

66 
	`mke2fs
(
mke2fs_hªdË
 *
hªdË
);

	@libmke2fs/mke2fs_err.h

1 #iâdeà
__MKE2FS_ERR_H__


2 
	#__MKE2FS_ERR_H__


	)

5 
	mMKE2FS_INVALID_HANDLE
 = 1001,

6 
	mMKE2FS_FAIL_TO_ALLOCATE_MEMORY
,

7 
	mMKE2FS_PROFILE_ERROR
,

8 
	mMKE2FS_UNAME_ERROR
,

9 
	mMKE2FS_INVALID_BLOCK_SIZE
,

10 
	mMKE2FS_INVALID_CLUSTER_SIZE
,

11 
	mMKE2FS_ILLEGAL_BLOCKS_PER_GROUP
,

12 
	mMKE2FS_BLOCKS_PER_GROUP_NOT_MULTIPLE_OF_8
,

13 
	mMKE2FS_FLEX_BG_SIZE_NOT_POWER_OF_2
,

14 
	mMKE2FS_INVALID_INODE_RATIO
,

15 
	mMKE2FS_INVALID_INODE_SIZE
,

16 
	mMKE2FS_INVALID_RESERVED_RATIO
,

17 
	mMKE2FS_FAIL_TO_PARSE_FSTYPE
,

18 
	mMKE2FS_FAIL_TO_DETERMINE_HW_SECTOR_SIZE
,

19 
	mMKE2FS_FAIL_TO_DETERMINE_PHY_SECTOR_SIZE
,

20 
	mMKE2FS_FAIL_TO_DETERMINE_FS_SIZE
,

21 
	mMKE2FS_FAIL_TO_DETERMINE_MOUNT_STATUS
,

22 
	mMKE2FS_BLOCKSIZE_TOO_SMALL
,

23 
	mMKE2FS_UNSUITABLE_BLOCKSIZE_FOR_32BIT
,

24 
	mMKE2FS_FS_FEATURE_NOT_SUPPORT
,

25 
	mMKE2FS_NOT_SUPPORT_SPARSE_SB
,

26 
	mMKE2FS_NOT_SUPPORT_JOURNAL
,

27 
	mMKE2FS_EXTENTS_ENABLED_FOR_64BIT_FS_NOLY
,

28 
	mMKE2FS_CLUSTER_SIZE_SMALLER_THAN_BLOCK_SIZE
,

29 
	mMKE2FS_UNSUITABLE_CLUSTER_SIZE
,

30 
	mMKE2FS_NEED_EXTENTS_FEATURE
,

31 
	mMKE2FS_FEATURES_CANNOT_ENABLED_SIMULTANEOUSLY
,

32 
	mMKE2FS_NOT_SUPPORT_RESERVED_ONLINE_RESIZE
,

33 
	mMKE2FS_BLOCK_PER_GROUP_OUT_OF_RANGE
,

34 
	mMKE2FS_FLEX_BG_FEATURE_NOT_ENABLED
,

35 
	mMKE2FS_TOO_MANY_INODES
,

36 
	mMKE2FS_UNSUITABLE_INODE_CONFIG
,

37 
	mMKE2FS_SETUP_TDB_ERROR
,

38 
	mMKE2FS_FAIL_TO_INITIALIZE_SUPERBLOCK
,

39 
	mMKE2FS_COULD_NOT_PARSE_UUID
,

40 
	mMKE2FS_UNKNOWN_OS
,

41 
	mMKE2FS_EXT2FS_CLOSE_ERROR
,

42 
	mMKE2FS_FAIL_TO_ALLOCATE_FS_TABLES
,

43 
	mMKE2FS_FAIL_TO_CONVERT_SUBCLUSTER_BITMAP
,

44 
	mMKE2FS_RESERVING_BLOCKS_FOR_ONLINE_RESIZE_ERROR
,

45 
	mMKE2FS_FAIL_TO_OPEN_JOURNAL_DEV
,

46 
	mMKE2FS_FAIL_TO_ADD_JOURNAL
,

47 
	mMKE2FS_FAIL_TO_CREATE_JOURNAL
,

48 
	mMKE2FS_FAIL_TO_INITIALIZE_JOURNAL_SUPERBLOCK
,

49 
	mMKE2FS_FAIL_TO_ZERO_JOURNAL_DEV
,

50 
	mMKE2FS_FAIL_TO_WRITE_JOURNAL_SB
,

51 
	mMKE2FS_ENABLE_MULTIPLE_MOUNT_PROTECTION_ERROR
,

52 
	mMKE2FS_INVALID_BB_LIST
,

53 
	mMKE2FS_BAD_PRIMARY_SB_GROUP_DESCRIPTOR
,

54 
	mMKE2FS_MARK_BAD_BLOCKS_ERROR
,

55 
	mMKE2FS_COULD_NOT_WRITE_BLOCKS_IN_INODE_TABLES
,

56 
	mMKE2FS_FAIL_TO_CREATE_ROOT_DIR
,

57 
	mMKE2FS_FAIL_TO_READ_ROOT_INODE
,

58 
	mMKE2FS_FAIL_TO_SET_ROOT_INODE_OWNERSHIP
,

59 
	mMKE2FS_OOM_ERASING_SECTORS
,

60 
	mMKE2FS_FAIL_TO_OPEN_BB_FILE
,

61 
	mMKE2FS_FAIL_TO_READ_BB_FILE
,

62 
	mMKE2FS_EMPTY_STRING
,

63 
	mMKE2FS_INVALID_FS_OPTIONS
,

64 
	mMKE2FS_INVALID_MOUNT_OPTIONS
,

65 
	mMKE2FS_ABORT_CHECK_PROFILE
,

66 
	mMKE2FS_JOURNAL_BLOCKSIZE_SMALLER_THAN_MINIMUM_BLOCKSIZE
,

67 
	mMKE2FS_COULD_NOT_DETERMINE_DEV_SIZE
,

68 
	mMKE2FS_DEVICE_SIZE_REPORT_TO_BE_0
,

69 
	mMKE2FS_NOT_BLOCK_DEV
,

70 
	mMKE2FS_FAIL_TO_GET_BLKID_CACHE
,

71 
	mMKE2FS_CHECK_MOUNT_POINT_FAIL
,

72 
	mMKE2FS_MOUNTED
,

	@libmke2fs/prof_err.h

6 
	~<‘/com_”r.h
>

8 
	#PROF_VERSION
 (-1429577728L)

	)

9 
	#PROF_MAGIC_NODE
 (-1429577727L)

	)

10 
	#PROF_NO_SECTION
 (-1429577726L)

	)

11 
	#PROF_NO_RELATION
 (-1429577725L)

	)

12 
	#PROF_ADD_NOT_SECTION
 (-1429577724L)

	)

13 
	#PROF_SECTION_WITH_VALUE
 (-1429577723L)

	)

14 
	#PROF_BAD_LINK_LIST
 (-1429577722L)

	)

15 
	#PROF_BAD_GROUP_LVL
 (-1429577721L)

	)

16 
	#PROF_BAD_PARENT_PTR
 (-1429577720L)

	)

17 
	#PROF_MAGIC_ITERATOR
 (-1429577719L)

	)

18 
	#PROF_SET_SECTION_VALUE
 (-1429577718L)

	)

19 
	#PROF_EINVAL
 (-1429577717L)

	)

20 
	#PROF_READ_ONLY
 (-1429577716L)

	)

21 
	#PROF_SECTION_NOTOP
 (-1429577715L)

	)

22 
	#PROF_SECTION_SYNTAX
 (-1429577714L)

	)

23 
	#PROF_RELATION_SYNTAX
 (-1429577713L)

	)

24 
	#PROF_EXTRA_CBRACE
 (-1429577712L)

	)

25 
	#PROF_MISSING_OBRACE
 (-1429577711L)

	)

26 
	#PROF_MAGIC_PROFILE
 (-1429577710L)

	)

27 
	#PROF_MAGIC_SECTION
 (-1429577709L)

	)

28 
	#PROF_TOPSECTION_ITER_NOSUPP
 (-1429577708L)

	)

29 
	#PROF_INVALID_SECTION
 (-1429577707L)

	)

30 
	#PROF_END_OF_SECTIONS
 (-1429577706L)

	)

31 
	#PROF_BAD_NAMESET
 (-1429577705L)

	)

32 
	#PROF_NO_PROFILE
 (-1429577704L)

	)

33 
	#PROF_MAGIC_FILE
 (-1429577703L)

	)

34 
	#PROF_FAIL_OPEN
 (-1429577702L)

	)

35 
	#PROF_EXISTS
 (-1429577701L)

	)

36 
	#PROF_BAD_BOOLEAN
 (-1429577700L)

	)

37 
	#PROF_BAD_INTEGER
 (-1429577699L)

	)

38 
	#PROF_MAGIC_FILE_DATA
 (-1429577698L)

	)

39 cÚ¡ 
”rÜ_bË
 
‘_´of_”rÜ_bË
;

40 
š™Ÿlize_´of_”rÜ_bË
();

43 
š™Ÿlize_´of_”rÜ_bË_r
(
‘_li¡
 **
li¡
);

45 
	#ERROR_TABLE_BASE_´of
 (-1429577728L)

	)

48 
	#š™_´of_”r_tbl
 
š™Ÿlize_´of_”rÜ_bË


	)

49 
	#´of_”r_ba£
 
ERROR_TABLE_BASE_´of


	)

	@libmke2fs/profile.h

39 #iâdeà
_PROFILE_H


40 
	#_PROFILE_H


	)

42 
_´ofe_t
 *
	t´ofe_t
;

44 (*
	t´ofe_syÁax_”r_cb_t
)(cÚ¡ *
	tfe
, 
	t”r
,

45 
	tlše_num
);

50 
	#PROFILE_ITER_LIST_SECTION
 0x0001

	)

51 
	#PROFILE_ITER_SECTIONS_ONLY
 0x0002

	)

52 
	#PROFILE_ITER_RELATIONS_ONLY
 0x0004

	)

54 #ifdeà
__ılu¥lus


58 
´ofe_š™


59 (cÚ¡ * *
fes
, 
´ofe_t
 *
»t_´ofe
);

61 
´ofe_»Ëa£


62 (
´ofe_t
 
´ofe
);

64 
´ofe_£t_deçuÉ


65 (
´ofe_t
 
´ofe
, cÚ¡ *
def_¡ršg
);

67 
´ofe_g‘_¡ršg


68 (
´ofe_t
 
´ofe
, cÚ¡ *
Çme
, cÚ¡ *
subÇme
,

69 cÚ¡ *
subsubÇme
, cÚ¡ *
def_v®
,

70 **
»t_¡ršg
);

71 
´ofe_g‘_š‹g”


72 (
´ofe_t
 
´ofe
, cÚ¡ *
Çme
, cÚ¡ *
subÇme
,

73 cÚ¡ *
subsubÇme
, 
def_v®
,

74 *
»t_deçuÉ
);

76 
´ofe_g‘_ušt


77 (
´ofe_t
 
´ofe
, cÚ¡ *
Çme
, cÚ¡ *
subÇme
,

78 cÚ¡ *
subsubÇme
, 
def_v®
,

79 *
»t_št
);

81 
´ofe_g‘_doubË


82 (
´ofe_t
 
´ofe
, cÚ¡ *
Çme
, cÚ¡ *
subÇme
,

83 cÚ¡ *
subsubÇme
, 
def_v®
,

84 *
»t_æßt
);

86 
´ofe_g‘_boŞ—n


87 (
´ofe_t
 
´ofe
, cÚ¡ *
Çme
, cÚ¡ *
subÇme
,

88 cÚ¡ *
subsubÇme
, 
def_v®
,

89 *
»t_deçuÉ
);

91 
´ofe_™”©Ü_ü—‹


92 (
´ofe_t
 
´ofe
, cÚ¡ *cÚ¡ *
Çmes
,

93 
æags
, **
»t_™”
);

95 
´ofe_™”©Ü_ä“


96 (**
™”_p
);

98 
´ofe_™”©Ü


99 (**
™”_p
, **
»t_Çme
, **
»t_v®ue
);

101 
´ofe_syÁax_”r_cb_t
 
	`´ofe_£t_syÁax_”r_cb
Õrofe_syÁax_”r_cb_ˆ
hook
);

103 #ifdeà
__ılu¥lus


104 
	}
}

	@libmke2fs/util.h

13 
jouº®_size
;

14 
jouº®_æags
;

15 *
jouº®_deviû
;

17 *
g‘_´ogÇme
(*
¬gv_z”o
);

18 
´oûed_que¡iÚ
();

19 
check_¶ausib™y
(cÚ¡ *
deviû
);

20 
·r£_jouº®_İts
(cÚ¡ *
İts
);

21 
check_mouÁ
(cÚ¡ *
deviû
, 
fÜû
, cÚ¡ *
ty³
);

22 
figu»_jouº®_size
(
size
, 
ext2_fsys
 
fs
);

23 
´št_check_mes§ge
(, );

24 
dump_mmp_msg
(
mmp_¡ruù
 *
mmp
, cÚ¡ *
msg
);

	@test_utils.cpp

1 
	~"‹¡_uts.h
"

3 #iâdeà
NUUO


4 
¡ršg
 
	$¡ršg_fÜm©
(cÚ¡ * 
fmt
, ...)

6 
va_li¡
 
¬gs
;

7 
buf
[64];

8 
	`va_¡¬t
(
¬gs
, 
fmt
);

9 
	`v¢´štf
(
buf
, 63, 
fmt
, 
¬gs
);

10 
	`va_’d
(
¬gs
);

11  
buf
;

12 
	}
}

	@test_utils.h

1 #iâdeà
__TEST_UTILS_H__


2 
	#__TEST_UTILS_H__


	)

4 #iâdeà
NUUO


5 
	~<¡ršg
>

7 
	~<¡dio.h
>

8 
	~<sy¦og.h
>

9 
	~<¡d¬g.h
>

11 
usšg
 
Çme¥aû
 
	g¡d
;

13 
	#Wr™eHWLog
(
çc™y
, 
Ëv–
, 
Ïb–
, 
fmt
, ...) \

15 
	`´štf
("[%d][%s][%s][%s] " 
fmt
, 
__LINE__
, #çc™y, #Ëv–, 
Ïb–
, ##
__VA_ARGS__
); \

16 } 0);

	)

18 
¡ršg
 
¡ršg_fÜm©
(cÚ¡ * 
fmt
, ...);

	@unitest/FilesystemManager_test.cpp

1 
	~"Fesy¡emMªag”.h
"

3 #ifdeà
NUUO


4 
	~"commÚ/sy¡em.h
"

7 
	$maš
(
¬gc
, *
¬gv
[])

9 
Fesy¡emMªag”
 
	`fs_mgr
("/dev/md0");

10 
fs_mgr
.
	`S‘MouÁPošt
("/mnt/VOLUME0");

11 #ifdeà
NUUO


12 
fs_mgr
.
	`C»©eTh»ad
();

15 
	`´štf
("Progress: ");

16 
´og»ss
 = 0, 
¡©
 = 
WRITE_INODE_TABLES_UNKNOWN
;

17 
FILE
 *
pf
 = 
	`fİ’
("fs_test.log", "w+");

18 #ifdeà
NUUO


19 
fs_mgr
.
	`Th»adExi¡s
()) {

21 ià(
fs_mgr
.
	`IsFÜm©šg
(
´og»ss
, 
¡©
)) {

22 
	`årštf
(
pf
, "%3d%%\n", 
´og»ss
);

23 
	`fæush
(
pf
);

25 #ifdeà
NUUO


26 
	`SË•MS
(100);

29 ià(!
fs_mgr
.
	`IsFÜm©šg
(
´og»ss
, 
¡©
è&& sˆ=ğ
WRITE_INODE_TABLES_DONE
) {

30 
	`årštf
(
pf
, "DÚe:%3d%%\n", 
´og»ss
);

32 
	`fşo£
(
pf
);

49 
	}
}

	@unitest/RAIDManager_test.cpp

1 
	~"RAIDMªag”.h
"

3 
	~<uni¡d.h
>

4 
	~<¡dlib.h
>

5 
	~<¡dio.h
>

6 
	~<sigÇl.h
>

8 
boŞ
 
	gg_bLoİ
 = 
Œue
;

10 
Te¡šgLoİ
(cÚ¡ * 
cfg
, 
RAIDMªag”
& 
¿id_mgr
);

12 
	$sig_hªdËr
(
sig
)

14 ià(
sig
 =ğ
SIGINT
) {

15 
g_bLoİ
 = 
çl£
;

16 
	`´štf
("received SIGINT\n");

18 
	}
}

20 
	$maš
(
¬gc
, * 
¬gv
[])

22 
İt
;

23 
RAIDMªag”
 
¿id_mgr
;

24 
Ëv–
 = -1;

25 
¡ršg
 
¡rMDName
;

26 
boŞ
 
bC»©e
 = 
çl£
;

27 
boŞ
 
bAddDisk
 = 
çl£
;

28 
boŞ
 
bRemove
 = 
çl£
;

29 
boŞ
 
bFe
 = 
çl£
;

30 
veùÜ
<
¡ršg
> 
vDevLi¡
;

31 
veùÜ
<
RAIDInfo
> 
li¡
;

32 
‹¡šg_sûÇrio_fe
[256];

34 
	`sigÇl
(
SIGINT
, 
sig_hªdËr
);

35 
	`sigÇl
(
SIGTERM
, 
sig_hªdËr
);

37 (
İt
 = 
	`g‘İt
(
¬gc
, 
¬gv
, "arcl:f:")) != -1) {

38 
İt
) {

40 
bAddDisk
 = 
Œue
;

43 
bRemove
 = 
Œue
;

46 
bC»©e
 = 
Œue
;

49 
Ëv–
 = 
	`©oi
(
İrg
);

52 
bFe
 = 
Œue
;

53 
	`¡ºıy
(
‹¡šg_sûÇrio_fe
, 
İrg
, (testing_scenario_file) - 1);

58 ià(
bFe
) {

59 
	`Te¡šgLoİ
(
‹¡šg_sûÇrio_fe
, 
¿id_mgr
);

63 ià(
¬gc
 > 
İtšd
) {

64 
i
 = 
İtšd
; i < 
¬gc
; i++) {

65 
vDevLi¡
.
	`push_back
(
¬gv
[
i
]);

69 ià(
bAddDisk
) {

70 
i
 = 0; i < 
vDevLi¡
.
	`size
(); i++) {

71 
¿id_mgr
.
	`AddDiskSymLšk
(
vDevLi¡
[
i
], 
DISK_TYPE_SATA
);

72 
¿id_mgr
.
	`AddDisk
(
vDevLi¡
[
i
]);

76 ià(
bRemove
) {

77 
i
 = 0; i < 
vDevLi¡
.
	`size
(); i++)

78 
¿id_mgr
.
	`RemoveDisk
(
vDevLi¡
[
i
]);

81 ià(
bC»©e
) {

82 ià(
Ëv–
 < 0)  1;

83 ià(
vDevLi¡
.
	`em±y
())  1;

84 
¿id_mgr
.
	`C»©eRAID
(
vDevLi¡
, 
Ëv–
, 
¡rMDName
);

87 
g_bLoİ
) {

88 
¿id_mgr
.
	`G‘RAIDInfo
(
li¡
);

90 
size_t
 
i
 = 0; i < 
li¡
.
	`size
(); i ++) {

91 
li¡
[
i
].
	`Dump
();

94 
	`¦“p
(10);

96 
¿id_mgr
.
	`Upd©eRAIDInfo
();

99 
size_t
 
i
 = 0; i < 
li¡
.
	`size
(); i ++)

100 
¿id_mgr
.
	`StİRAID
(
li¡
[
i
].
m_¡rDevNodeName
);

102 
i
 = 0; i < 
vDevLi¡
.
	`size
(); i++) {

103 
¿id_mgr
.
	`RemoveDiskSymLšk
(
vDevLi¡
[
i
]);

104 
¿id_mgr
.
	`RemoveDisk
(
vDevLi¡
[
i
]);

108 
	}
}

	@unitest/TestingLoop.cpp

1 
	~"RAIDMªag”.h
"

3 
	~<¡dio.h
>

4 
	~<¡ršg.h
>

6 
	~<¡ršg
>

7 
	~<veùÜ
>

10 
	mOP_ADDDISK
 = 'a',

11 
	mOP_REMDISK
 = 'r',

12 
	mOP_CREATERAID
 = 'C',

13 
	mOP_STOPRAID
 = 'S',

14 
	mOP_DELETERAID
 = 'D',

15 
	mOP_ASSEMBLERAID
 = 'A',

16 
	mOP_MANAGEMDDISK
 = 'M',

22 
	mOP_DONOTHING
 = 'N',

26 
	mMANAGE_M¬kFauÉy
 = 'f',

27 
	mMANAGE_Remove
 = 'r',

28 
	mMANAGE_Add
 = 'a',

29 
	mMANAGE_R—dd
 = 'A',

30 
	mMANAGE_R•Ïû
 = 'R',

33 
	#OPERATION_CASE
(
İ
) \

34 
OP_
##
İ
: \

35 
	`´štf
("%s\n", #op); \

36 
HªdË
##
	`İ
(
cÚ‹Á
, 
¿id_mgr
); \

37 ;

	)

39 
	#MANAGE_CASE
(
İ
) \

40 
MANAGE_
##
İ
: \

41 
	`´štf
("İ”©iÚ = %c\n", 
İ”©iÚ
); \

42 
¿id_mgr
.
İ
##
	`MDDisks
(
mddev
, 
vdisks
); \

43 ;

	)

46 
boŞ
 
g_bLoİ
;

48 
usšg
 
Çme¥aû
 
	g¡d
;

50 
tok’ize
(* 
rg‘
, 
veùÜ
<
¡ršg
>& 
tok’s
)

52 *
	g§v•Œ
 = 
NULL
;

53 *
	gp
 = 
¡¹ok_r
(
rg‘
, ",", &
§v•Œ
);

55 
	gtok’s
.
ş—r
();

56 
	gp
) {

57 
´štf
 ("Tok’: %s\n", 
p
);

58 
	gtok’s
.
push_back
(
p
);

59 
	gp
 = 
¡¹ok_r
(
NULL
, ",", &
§v•Œ
);

63 
	$HªdËADDDISK
 (* 
cÚ‹Á
, 
RAIDMªag”
& 
¿id_mgr
)

65 
veùÜ
<
¡ršg
> 
disks
;

66 
	`tok’ize
(
cÚ‹Á
, 
disks
);

67 
size_t
 
i
 = 0; i < 
disks
.
	`size
(); i++) {

68 
¿id_mgr
.
	`AddDisk
(
disks
[
i
]);

69 
¿id_mgr
.
	`AddDiskSymLšk
(
disks
[
i
], 
DISK_TYPE_SATA
);

71 
	}
}

73 
	$HªdËREMDISK
 (* 
cÚ‹Á
, 
RAIDMªag”
& 
¿id_mgr
)

75 
veùÜ
<
¡ršg
> 
disks
;

76 
	`tok’ize
(
cÚ‹Á
, 
disks
);

77 
size_t
 
i
 = 0; i < 
disks
.
	`size
(); i++) {

78 
¿id_mgr
.
	`RemoveDisk
(
disks
[
i
]);

80 
	}
}

82 
	$HªdËCREATERAID
 (cÚ¡ * 
cÚ‹Á
, 
RAIDMªag”
& 
¿id_mgr
)

84 
lv
 = 0;

85 
disks
[1024];

86 
veùÜ
<
¡ršg
> 
vdisks
;

87 
¡ršg
 
¡rMDName
;

88 
	`ssÿnf
(
cÚ‹Á
, "%d,%1023s", &
lv
, 
disks
);

89 
	`tok’ize
(
disks
, 
vdisks
);

90 
	`´štf
("lv = %d\n", 
lv
);

91 
¿id_mgr
.
	`C»©eRAID
(
vdisks
, 
lv
, 
¡rMDName
);

92 
¿id_mgr
.
	`FÜm©
(
¡rMDName
);

93 
	}
}

95 
	$HªdËMANAGEMDDISK
 (cÚ¡ * 
cÚ‹Á
, 
RAIDMªag”
& 
¿id_mgr
)

97 
İ”©iÚ
;

98 
disks
[1024];

99 
mddev
[16];

100 
veùÜ
<
¡ršg
> 
vdisks
;

101 
	`ssÿnf
(
cÚ‹Á
, "%c,%15[^,],%1023s", &
İ”©iÚ
, 
mddev
, 
disks
);

102 
	`tok’ize
(
disks
, 
vdisks
);

103 
	`´štf
("mddev = %s\n", 
mddev
);

105 
İ”©iÚ
) {

106 
	`MANAGE_CASE
(
M¬kFauÉy
)

107 
	`MANAGE_CASE
(
Remove
)

108 
	`MANAGE_CASE
(
Add
)

109 
	`MANAGE_CASE
(
R—dd
)

110 
MANAGE_R•Ïû
:

111 
	`´štf
("Replace\n");

112 ià(
vdisks
.
	`size
() == 2) {

113 
¿id_mgr
.
	`R•ÏûMDDisk
(
mddev
, 
vdisks
[0], vdisks[1]);

115 
	`´štf
("Disk‚umber is‚ot‡ccepted\n");

120 
	}
}

122 
	$HªdËSTOPRAID
 (cÚ¡ * 
cÚ‹Á
, 
RAIDMªag”
& 
¿id_mgr
)

124 ià(
	`¡ºcmp
("®l", 
cÚ‹Á
, ("all")) == 0) {

125 
veùÜ
<
RAIDInfo
> 
li¡
;

126 
¿id_mgr
.
	`G‘RAIDInfo
(
li¡
);

127 
size_t
 
i
 = 0; i < 
li¡
.
	`size
(); i ++) {

128 
¡©
 = 0, 
´og»ss
 = 0;

134 
¿id_mgr
.
	`StİRAID
(
li¡
[
i
].
m_¡rDevNodeName
);

137 
¿id_mgr
.
	`StİRAID
(
cÚ‹Á
);

139 
	}
}

141 
	$HªdËDELETERAID
 (cÚ¡ * 
cÚ‹Á
, 
RAIDMªag”
& 
¿id_mgr
)

143 ià(
	`¡ºcmp
("®l", 
cÚ‹Á
, ("all")) == 0) {

144 
veùÜ
<
RAIDInfo
> 
li¡
;

145 
¿id_mgr
.
	`G‘RAIDInfo
(
li¡
);

146 
size_t
 
i
 = 0; i < 
li¡
.
	`size
(); i ++)

147 
¿id_mgr
.
	`D–‘eRAID
(
li¡
[
i
].
m_¡rDevNodeName
);

149 
¿id_mgr
.
	`D–‘eRAID
(
cÚ‹Á
);

151 
	}
}

153 
	$HªdËFAULTYDISK
 (cÚ¡ * 
cÚ‹Á
)

155 
	}
}

157 
	$HªdËREMMDDISK
 (cÚ¡ * 
cÚ‹Á
)

159 
	}
}

161 
	$HªdËADDMDDISK
 (cÚ¡ * 
cÚ‹Á
)

163 
	}
}

165 
	$HªdËREADDMDDISK
 (cÚ¡ * 
cÚ‹Á
)

167 
	}
}

169 
	$HªdËREPLACEMDDISK
 (cÚ¡ * 
cÚ‹Á
)

171 
	}
}

173 
	$HªdËASSEMBLERAID
 (cÚ¡ * 
cÚ‹Á
, 
RAIDMªag”
& 
¿id_mgr
)

175 
ty³
[5];

176 
šfo
[1024];

177 
	`ssÿnf
(
cÚ‹Á
, "%4[^,],%1023s", 
ty³
, 
šfo
);

179 
	`´štf
("ty³ = %s\n", 
ty³
);

180 ià(
	`¡ºcmp
("disk", 
ty³
, 
	`¡¾’
("disk")) == 0) {

181 
veùÜ
<
¡ršg
> 
vdisks
;

182 
¡ršg
 
¡rMDName
;

183 
	`tok’ize
(
šfo
, 
vdisks
);

184 
¿id_mgr
.
	`As£mbËRAID
(
vdisks
, 
¡rMDName
);

185 } ià(
	`¡ºcmp
("uuid", 
ty³
, 
	`¡¾’
("uuid")) == 0) {

188 
	}
}

190 
	$HªdËDONOTHING
 (cÚ¡ * 
cÚ‹Á
, 
RAIDMªag”
& 
¿id_mgr
)

192 
¿id_mgr
.
	`Upd©eRAIDInfo
();

194 
veùÜ
<
RAIDInfo
> 
li¡
;

195 
¿id_mgr
.
	`G‘RAIDInfo
(
li¡
);

196 
size_t
 
i
 = 0; i < 
li¡
.
	`size
(); i++) {

197 
li¡
[
i
].
	`Dump
();

199 
¿id_mgr
.
	`Dump
();

200 
	}
}

202 
	$Te¡šgLoİ
(cÚ¡ * 
cfg
, 
RAIDMªag”
& 
¿id_mgr
)

204 
FILE
 *
pFe
 = 
	`fİ’
(
cfg
, "r");

205 
lše
[1024];

206 
cÚ‹Á
[1024];

207 
o
 = 
OP_DONOTHING
;

209 ià(
pFe
 =ğ
NULL
) {

210 
	`´štf
("Failo open file\n");

215 
	`fg‘s
(
lše
, 1023, 
pFe
è!ğ
NULL
 && 
g_bLoİ
) {

216 ià(
lše
[0] == '#')

218 
	`´štf
("\nRun: %s", 
lše
);

219 
	`ssÿnf
(
lše
, "%c:%1023[^:\n]", &
o
, 
cÚ‹Á
);

221 
o
) {

222 
	`OPERATION_CASE
(
ADDDISK
)

223 
	`OPERATION_CASE
(
REMDISK
)

224 
	`OPERATION_CASE
(
CREATERAID
)

225 
	`OPERATION_CASE
(
STOPRAID
)

226 
	`OPERATION_CASE
(
DELETERAID
)

232 
	`OPERATION_CASE
(
ASSEMBLERAID
)

233 
	`OPERATION_CASE
(
MANAGEMDDISK
)

234 
	`OPERATION_CASE
(
DONOTHING
)

239 
	`¦“p
(10);

243 
	`fşo£
(
pFe
);

244 
	}
}

	@
1
.
0
31
651
FilesystemManager.cpp
FilesystemManager.h
RAIDManager.cpp
RAIDManager.h
build/CMakeFiles/2.8.12.2/CompilerIdCXX/CMakeCXXCompilerId.cpp
libmdadm/bitmap.h
libmdadm/crc32.h
libmdadm/dlink.h
libmdadm/md_p.h
libmdadm/md_u.h
libmdadm/mdadm.h
libmdadm/mdadm_errcode.h
libmdadm/mdadm_other.h
libmdadm/mdmon.h
libmdadm/msg.h
libmdadm/part.h
libmdadm/platform-intel.h
libmdadm/probe_roms.h
libmdadm/sha1.h
libmke2fs/ext2fs.h
libmke2fs/ext2fsP.h
libmke2fs/mke2fs.h
libmke2fs/mke2fs_err.h
libmke2fs/prof_err.h
libmke2fs/profile.h
libmke2fs/util.h
test_utils.cpp
test_utils.h
unitest/FilesystemManager_test.cpp
unitest/RAIDManager_test.cpp
unitest/TestingLoop.cpp
